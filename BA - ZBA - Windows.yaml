zabbix_export:
  version: '7.4'
  template_groups:
    - uuid: 5b179fb589fa49ddae414d5c5bbd3dc6
      name: BA/ZBA
  templates:
    - uuid: ca8a2cf525cf4e3cb8e69790e57b3492
      template: 'BA - ZBA - Windows'
      name: 'BA - ZBA - Windows'
      groups:
        - name: BA/ZBA
      items:
        - uuid: 3614232cb5cf4979bf6095e31dc483c5
          name: 'Windows - Event Log - Application'
          type: ZABBIX_ACTIVE
          key: 'eventlog[Application]'
          delay: 15s
          history: 15d
          value_type: LOG
          description: 'The Application log stores events that come from applications and programs, not the Windows OS itself. These are messages written by software components both Microsoft and third-party.'
          tags:
            - tag: 'Item Type'
              value: Log
        - uuid: 8a7223ac2c23466aadcd44e6819edcf5
          name: 'Windows - Event Log - Security'
          type: ZABBIX_ACTIVE
          key: 'eventlog[Security]'
          delay: 15s
          history: 15d
          value_type: LOG
          description: 'The Security log records events related to security, authentication, access, and audit policy.'
          tags:
            - tag: 'Item Type'
              value: Log
        - uuid: eb2adb51114c4c239c1ba997c563b663
          name: 'Windows - Event Log - System'
          type: ZABBIX_ACTIVE
          key: 'eventlog[System]'
          delay: 15s
          history: 15d
          value_type: LOG
          description: 'The System log records events generated by the Windows operating system itself and by system-level components such as drivers and core services.'
          tags:
            - tag: 'Item Type'
              value: Log
        - uuid: 897d21a747f44b6ebdd6ee0e748eb80f
          name: Threads
          type: ZABBIX_ACTIVE
          key: 'perf_counter[\System\Threads, 15]'
          delay: 15s
          history: 7d
          description: 'Threads is the number of threads in the computer at the time of data collection. This is an instantaneous count, not an average over the time interval.  A thread is the basic executable entity that can execute instructions in a processor.'
          tags:
            - tag: 'Item Type'
              value: Count
        - uuid: 28420d99b86b460f94d61b092d074d74
          name: 'Windows Services Discovery'
          type: ZABBIX_ACTIVE
          key: service.discovery
          history: '0'
          value_type: TEXT
          tags:
            - tag: 'Item Type'
              value: Discovery
      discovery_rules:
        - uuid: 0ea8aff1fea841d3b2763befd6689300
          name: 'Windows Services Discovery'
          type: DEPENDENT
          key: windows.services.discovery
          filter:
            evaltype: AND
            conditions:
              - macro: '{#SERVICE.DISPLAYNAME}'
                value: '{$WIN_SERVICES}'
              - macro: '{#SERVICE.DISPLAYNAME}'
                value: '{$WIN_SERVICES_IGNORE}'
                operator: NOT_MATCHES_REGEX
          item_prototypes:
            - uuid: 4f70bd60d51a41c584b9217805dd196a
              name: 'Windows Service ({#SERVICE.DISPLAYNAME}) Status'
              type: DEPENDENT
              key: 'windows.services.status[{#SERVICE.DISPLAYNAME}]'
              history: 7d
              valuemap:
                name: 'Service State'
              preprocessing:
                - type: REGEX
                  parameters:
                    - '.*'
                    - '{#SERVICE.STATE}'
              master_item:
                key: service.discovery
              tags:
                - tag: 'Item Type'
                  value: Status
                - tag: Service
                  value: '{#SERVICE.DISPLAYNAME}'
          master_item:
            key: service.discovery
      tags:
        - tag: Agent
          value: ZBA
        - tag: 'Template Type'
          value: Active
      valuemaps:
        - uuid: 552c0a99266345da9f74cd9be7bbffe0
          name: 'Service State'
          mappings:
            - value: '0'
              newvalue: '游릭 Running'
            - value: '1'
              newvalue: '游리 Paused'
            - value: '2'
              newvalue: '游리 Start Pending'
            - value: '3'
              newvalue: '游리 Pause Pending'
            - value: '4'
              newvalue: '游리 Continue Pending'
            - value: '5'
              newvalue: '游 Stop Pending'
            - value: '6'
              newvalue: '游댮 Stopped'
            - value: '7'
              newvalue: '丘勇 Unknown'


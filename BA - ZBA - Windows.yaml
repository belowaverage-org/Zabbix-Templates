zabbix_export:
  version: '7.4'
  template_groups:
    - uuid: 5b179fb589fa49ddae414d5c5bbd3dc6
      name: BA/ZBA
  templates:
    - uuid: ca8a2cf525cf4e3cb8e69790e57b3492
      template: 'BA - ZBA - Windows'
      name: 'BA - ZBA - Windows'
      groups:
        - name: BA/ZBA
      items:
        - uuid: 3614232cb5cf4979bf6095e31dc483c5
          name: 'Windows - Event Log - Application'
          type: ZABBIX_ACTIVE
          key: 'eventlog[Application]'
          delay: 15s
          history: 15d
          value_type: LOG
          description: 'The Application log stores events that come from applications and programs, not the Windows OS itself. These are messages written by software components both Microsoft and third-party.'
          tags:
            - tag: 'Item Type'
              value: Log
        - uuid: 8a7223ac2c23466aadcd44e6819edcf5
          name: 'Windows - Event Log - Security'
          type: ZABBIX_ACTIVE
          key: 'eventlog[Security]'
          delay: 15s
          history: 15d
          value_type: LOG
          description: 'The Security log records events related to security, authentication, access, and audit policy.'
          tags:
            - tag: 'Item Type'
              value: Log
          triggers:
            - uuid: 699682402c3541a996db888278da1b6a
              expression: 'find(/BA - ZBA - Windows/eventlog[Security],{$WIN_SEC_EVENT_LOG_DURATION},"like","Network Policy Server denied access to a user.")=1'
              name: 'Network Policy Server denied access to a user within {$WIN_SEC_EVENT_LOG_DURATION}'
              opdata: 'Network Policy Server denied access to a user'
              status: DISABLED
              priority: WARNING
              manual_close: 'YES'
              tags:
                - tag: 'Trigger Type'
                  value: Event
        - uuid: eb2adb51114c4c239c1ba997c563b663
          name: 'Windows - Event Log - System'
          type: ZABBIX_ACTIVE
          key: 'eventlog[System]'
          delay: 15s
          history: 15d
          value_type: LOG
          description: 'The System log records events generated by the Windows operating system itself and by system-level components such as drivers and core services.'
          tags:
            - tag: 'Item Type'
              value: Log
        - uuid: 897d21a747f44b6ebdd6ee0e748eb80f
          name: Threads
          type: ZABBIX_ACTIVE
          key: 'perf_counter[\System\Threads, 15]'
          delay: 15s
          history: 7d
          description: 'Threads is the number of threads in the computer at the time of data collection. This is an instantaneous count, not an average over the time interval.  A thread is the basic executable entity that can execute instructions in a processor.'
          tags:
            - tag: 'Item Type'
              value: Count
        - uuid: 28420d99b86b460f94d61b092d074d74
          name: 'Windows Services Discovery'
          type: ZABBIX_ACTIVE
          key: service.discovery
          history: '0'
          value_type: TEXT
          tags:
            - tag: 'Item Type'
              value: Discovery
      discovery_rules:
        - uuid: 0ea8aff1fea841d3b2763befd6689300
          name: 'Windows Services Discovery'
          type: DEPENDENT
          key: windows.services.discovery
          filter:
            evaltype: AND
            conditions:
              - macro: '{#SERVICE.DISPLAYNAME}'
                value: '{$WIN_SERVICES}'
              - macro: '{#SERVICE.DISPLAYNAME}'
                value: '{$WIN_SERVICES_IGNORE}'
                operator: NOT_MATCHES_REGEX
          item_prototypes:
            - uuid: 4f70bd60d51a41c584b9217805dd196a
              name: 'Windows Service ({#SERVICE.DISPLAYNAME}) Status'
              type: DEPENDENT
              key: 'windows.services.status[{#SERVICE.DISPLAYNAME}]'
              history: 7d
              valuemap:
                name: 'Service State'
              preprocessing:
                - type: REGEX
                  parameters:
                    - '.*'
                    - '{#SERVICE.STATE}'
              master_item:
                key: service.discovery
              tags:
                - tag: 'Item Type'
                  value: Status
                - tag: Service
                  value: '{#SERVICE.DISPLAYNAME}'
              trigger_prototypes:
                - uuid: ac897e1046a648d69880ea71ea0032f2
                  expression: 'last(/BA - ZBA - Windows/windows.services.status[{#SERVICE.DISPLAYNAME}])<>0'
                  name: 'Windows Service ({#SERVICE.DISPLAYNAME}) Status != Running'
                  priority: WARNING
                  description: 'This service is not in a running state.'
                  manual_close: 'YES'
                  tags:
                    - tag: 'Trigger Type'
                      value: Status
          master_item:
            key: service.discovery
      tags:
        - tag: Agent
          value: ZBA
        - tag: 'Template Type'
          value: Active
      dashboards:
        - uuid: 2f16e314fa6b47dbb8cc822b97a0b9c2
          name: 'üì± Windows Services'
          pages:
            - widgets:
                - type: honeycomb
                  name: 'Windows Services'
                  width: '72'
                  height: '17'
                  fields:
                    - type: STRING
                      name: items.0
                      value: '*Service*'
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regrepl("^.*\(|\).*$", "")}'
                    - type: INTEGER
                      name: primary_label_bold
                      value: '1'
                    - type: STRING
                      name: reference
                      value: EOTNU
                    - type: INTEGER
                      name: secondary_label_bold
                      value: '0'
                    - type: INTEGER
                      name: secondary_label_decimal_places
                      value: '0'
                    - type: INTEGER
                      name: secondary_label_size
                      value: '15'
                    - type: INTEGER
                      name: secondary_label_size_type
                      value: '1'
                    - type: STRING
                      name: thresholds.0.color
                      value: '144618'
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: B75F11
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '1'
                    - type: STRING
                      name: thresholds.2.color
                      value: '891515'
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '6'
        - uuid: b199f5c5b45f40c3986d424cafa84d37
          name: 'ü™µ Windows Event Log'
          pages:
            - widgets:
                - type: itemhistory
                  name: 'Windows Event Log'
                  width: '72'
                  height: '17'
                  fields:
                    - type: INTEGER
                      name: columns.0.display
                      value: '5'
                    - type: STRING
                      name: columns.0.highlights.0.color
                      value: 5B0E0E
                    - type: STRING
                      name: columns.0.highlights.0.pattern
                      value: error|Error|fail|Fail
                    - type: STRING
                      name: columns.0.highlights.1.color
                      value: 7A3F0B
                    - type: STRING
                      name: columns.0.highlights.1.pattern
                      value: warning|Warning
                    - type: STRING
                      name: columns.0.highlights.2.color
                      value: 0D2F10
                    - type: STRING
                      name: columns.0.highlights.2.pattern
                      value: success|Success
                    - type: ITEM
                      name: columns.0.itemid
                      value:
                        host: 'BA - ZBA - Windows'
                        key: 'eventlog[Application]'
                    - type: INTEGER
                      name: columns.0.local_time
                      value: '1'
                    - type: INTEGER
                      name: columns.0.max_length
                      value: '300'
                    - type: INTEGER
                      name: columns.0.monospace_font
                      value: '1'
                    - type: STRING
                      name: columns.0.name
                      value: 'üì± Application'
                    - type: INTEGER
                      name: columns.1.display
                      value: '5'
                    - type: STRING
                      name: columns.1.highlights.0.color
                      value: 5B0E0E
                    - type: STRING
                      name: columns.1.highlights.0.pattern
                      value: error|Error|fail|Fail
                    - type: STRING
                      name: columns.1.highlights.1.color
                      value: 7A3F0B
                    - type: STRING
                      name: columns.1.highlights.1.pattern
                      value: warning|Warning
                    - type: STRING
                      name: columns.1.highlights.2.color
                      value: 0D2F10
                    - type: STRING
                      name: columns.1.highlights.2.pattern
                      value: success|Success
                    - type: ITEM
                      name: columns.1.itemid
                      value:
                        host: 'BA - ZBA - Windows'
                        key: 'eventlog[System]'
                    - type: INTEGER
                      name: columns.1.local_time
                      value: '1'
                    - type: INTEGER
                      name: columns.1.max_length
                      value: '300'
                    - type: INTEGER
                      name: columns.1.monospace_font
                      value: '1'
                    - type: STRING
                      name: columns.1.name
                      value: '‚öôÔ∏è System'
                    - type: INTEGER
                      name: columns.2.display
                      value: '5'
                    - type: STRING
                      name: columns.2.highlights.0.color
                      value: 5B0E0E
                    - type: STRING
                      name: columns.2.highlights.0.pattern
                      value: error|Error|fail|Fail
                    - type: STRING
                      name: columns.2.highlights.1.color
                      value: 0D2F10
                    - type: STRING
                      name: columns.2.highlights.1.pattern
                      value: success|Success
                    - type: STRING
                      name: columns.2.highlights.2.color
                      value: 7A3F0B
                    - type: STRING
                      name: columns.2.highlights.2.pattern
                      value: warning|Warning
                    - type: ITEM
                      name: columns.2.itemid
                      value:
                        host: 'BA - ZBA - Windows'
                        key: 'eventlog[Security]'
                    - type: INTEGER
                      name: columns.2.local_time
                      value: '1'
                    - type: INTEGER
                      name: columns.2.max_length
                      value: '300'
                    - type: INTEGER
                      name: columns.2.monospace_font
                      value: '1'
                    - type: STRING
                      name: columns.2.name
                      value: 'üîê Security'
                    - type: STRING
                      name: reference
                      value: MQLGG
                    - type: INTEGER
                      name: show_column_header
                      value: '1'
                    - type: INTEGER
                      name: show_lines
                      value: '500'
                    - type: INTEGER
                      name: show_timestamp
                      value: '1'
                    - type: STRING
                      name: time_period.from
                      value: now-24h
                    - type: STRING
                      name: time_period.to
                      value: now
      valuemaps:
        - uuid: 552c0a99266345da9f74cd9be7bbffe0
          name: 'Service State'
          mappings:
            - value: '0'
              newvalue: 'üü¢ Running'
            - value: '1'
              newvalue: 'üü° Paused'
            - value: '2'
              newvalue: 'üü° Start Pending'
            - value: '3'
              newvalue: 'üü° Pause Pending'
            - value: '4'
              newvalue: 'üü° Continue Pending'
            - value: '5'
              newvalue: 'üü† Stop Pending'
            - value: '6'
              newvalue: 'üî¥ Stopped'
            - value: '7'
              newvalue: '‚ö´Ô∏è Unknown'


zabbix_export:
  version: '6.4'
  template_groups:
    -
      uuid: 2d74333e7c9d46ee9fd27559f11a7d0e
      name: BA/Generic
    -
      uuid: 8fdb1680986b48c781ac1ea2a485a917
      name: BA/HTTP
    -
      uuid: ca9da747aeb34dbcbaacd78655243f3e
      name: BA/Macros
    -
      uuid: 3fdb37c563464c49b24b75703e0038ed
      name: BA/MIBs
    -
      uuid: 709a337c872146989712a383cb393fa8
      name: BA/ONVIF
    -
      uuid: d323af8072864defab6d6e380742fb4d
      name: BA/Procedures
    -
      uuid: b384f4b048b0408a9adfeae61f5574ae
      name: BA/Profiles
    -
      uuid: 83b7b6180c974b1680cca7fa1fbac757
      name: BA/Profiles/Cameras
    -
      uuid: a9ae9cbb57864537879e36c074d112ca
      name: BA/Profiles/Networking
    -
      uuid: 2128cf518279432187a98490d555a270
      name: BA/Profiles/Servers
    -
      uuid: 08afccc1647440e2bdf5025bd5f4b3e0
      name: BA/SSH
  templates:
    -
      uuid: 1096884d9c9340b095f2b3473a20a7f5
      template: 'BA - Generic - ICMP'
      name: 'BA - Generic - ICMP'
      groups:
        -
          name: BA/Generic
      items:
        -
          uuid: 925ec895069249bca0ec0472a970d21a
          name: 'ICMP Loss'
          type: SIMPLE
          key: 'icmppingloss[{HOST.HOST},10,50,1000,500]'
          history: 7d
          value_type: FLOAT
          units: '%'
          tags:
            -
              tag: ICMP
            -
              tag: Type
              value: Loss
          triggers:
            -
              uuid: 7e3ebb73a3e4415a8f69c2ddb2d40edb
              expression: 'avg(/BA - Generic - ICMP/icmppingloss[{HOST.HOST},10,50,1000,500],#3)>={$ICMP_HIGH_LOSS_WARN}'
              name: 'ICMP Loss >= {$ICMP_HIGH_LOSS_WARN}%'
              priority: WARNING
              dependencies:
                -
                  name: 'Device offline'
                  expression: 'last(/BA - Generic - ICMP/icmpping[{HOST.HOST}])=0'
              tags:
                -
                  tag: ICMP
        -
          uuid: 8b397b5e4de74806b3d4814da8ca7497
          name: 'ICMP Latency'
          type: SIMPLE
          key: 'icmppingsec[{HOST.HOST}]'
          history: 7d
          value_type: FLOAT
          units: ms
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '1000'
          tags:
            -
              tag: ICMP
            -
              tag: Type
              value: Latency
          triggers:
            -
              uuid: 0b6fa791e1cc4993bd779488cc08fe64
              expression: 'avg(/BA - Generic - ICMP/icmppingsec[{HOST.HOST}],#3)>={$ICMP_HIGH_LATENCY_WARN}'
              name: 'ICMP Latency >= {$ICMP_HIGH_LATENCY_WARN}'
              priority: INFO
              dependencies:
                -
                  name: 'Device offline'
                  expression: 'last(/BA - Generic - ICMP/icmpping[{HOST.HOST}])=0'
              tags:
                -
                  tag: ICMP
        -
          uuid: 157c0a57578f4b6fa626c497c413b7ff
          name: 'ICMP Ping'
          type: SIMPLE
          key: 'icmpping[{HOST.HOST}]'
          delay: 10s
          history: 7d
          valuemap:
            name: 'Ping Status'
          tags:
            -
              tag: ICMP
            -
              tag: Type
              value: Status
          triggers:
            -
              uuid: 77f9ed9ba5d44b938fd34d222cd5c502
              expression: 'last(/BA - Generic - ICMP/icmpping[{HOST.HOST}])=0'
              name: 'Device offline'
              priority: HIGH
              tags:
                -
                  tag: ICMP
      tags:
        -
          tag: Type
          value: Generic
      dashboards:
        -
          uuid: fd7f3696289d4db0a96b6e8a9b22bd76
          name: 'ICMP Statistics'
          pages:
            -
              widgets:
                -
                  type: item
                  width: '4'
                  fields:
                    -
                      type: INTEGER
                      name: adv_conf
                      value: '1'
                    -
                      type: INTEGER
                      name: show
                      value: '2'
                    -
                      type: INTEGER
                      name: show
                      value: '3'
                    -
                      type: INTEGER
                      name: value_v_pos
                      value: '0'
                    -
                      type: INTEGER
                      name: units_show
                      value: '0'
                    -
                      type: INTEGER
                      name: units_bold
                      value: '0'
                    -
                      type: INTEGER
                      name: time_v_pos
                      value: '2'
                    -
                      type: ITEM
                      name: itemid
                      value:
                        host: 'BA - Generic - ICMP'
                        key: 'icmpping[{HOST.HOST}]'
                -
                  type: graph
                  x: '4'
                  width: '20'
                  height: '7'
                  fields:
                    -
                      type: GRAPH
                      name: graphid
                      value:
                        host: 'BA - Generic - ICMP'
                        name: 'ICMP Statistics'
                -
                  type: clock
                  'y': '2'
                  width: '4'
                  height: '5'
      valuemaps:
        -
          uuid: 4e0b1b29cccb413ea3dbe1730a188450
          name: 'Ping Status'
          mappings:
            -
              value: '0'
              newvalue: Down
            -
              value: '1'
              newvalue: Up
    -
      uuid: f4d0ecadd0e647d3bf034ea2af2cf2b9
      template: 'BA - HTTP - Axis'
      name: 'BA - HTTP - Axis'
      groups:
        -
          name: BA/HTTP
      items:
        -
          uuid: d2a61ecc1d0f40c2b51e92acc2321e0d
          name: 'Device Firmware Version'
          type: DEPENDENT
          key: camera.firmware.version
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: OS
          preprocessing:
            -
              type: REGEX
              parameters:
                - 'root.Properties.Firmware.Version="(.*)"'
                - \1
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.parameters
          tags:
            -
              tag: Type
              value: Firmware
        -
          uuid: b55cd1f3182b449c95525eaf00cac1c8
          name: 'Device Model'
          type: DEPENDENT
          key: camera.model
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: MODEL
          preprocessing:
            -
              type: REGEX
              parameters:
                - 'root.Brand.ProdNbr="(.*)"'
                - \1
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.parameters
          tags:
            -
              tag: Type
              value: Model
        -
          uuid: d9a3aac2a16745529f93a65b78f0c274
          name: 'Device Name'
          type: DEPENDENT
          key: camera.name
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: NAME
          preprocessing:
            -
              type: REGEX
              parameters:
                - 'root.ImageSource.I0.Name="(.*)"'
                - \1
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.parameters
          tags:
            -
              tag: Type
              value: Name
        -
          uuid: 95ddd29e014c4505b55c8fb1cd604c0b
          name: 'Device MAC'
          type: DEPENDENT
          key: camera.net.mac
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: MACADDRESS_A
          preprocessing:
            -
              type: REGEX
              parameters:
                - 'root.Network.eth0.MACAddress="(.*)"'
                - \1
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.parameters
          tags:
            -
              tag: Type
              value: MAC
        -
          uuid: ec385938d1354e08876f86565f5d7ccf
          name: 'Device Parameters'
          type: HTTP_AGENT
          key: camera.parameters
          delay: 15m
          history: 1h
          trends: '0'
          value_type: TEXT
          authtype: DIGEST
          username: '{$AXIS_CAM_USERNAME}'
          password: '{$AXIS_CAM_PASSWORD}'
          timeout: 30s
          url: 'http://{HOST.IP}/axis-cgi/admin/paramlist.cgi'
          tags:
            -
              tag: Type
              value: HTTP
          triggers:
            -
              uuid: d3e13913f3cc4d7381e6be130c70ca79
              expression: 'nodata(/BA - HTTP - Axis/camera.parameters,60m)=1'
              name: 'Could not retrieve device parameters via HTTP'
              priority: WARNING
              description: 'Please check the password on the device.'
              dependencies:
                -
                  name: 'Device offline'
                  expression: 'last(/BA - Generic - ICMP/icmpping[{HOST.HOST}])=0'
                -
                  name: 'ICMP Loss >= {$ICMP_HIGH_LOSS_WARN}%'
                  expression: 'avg(/BA - Generic - ICMP/icmppingloss[{HOST.HOST},10,50,1000,500],#3)>={$ICMP_HIGH_LOSS_WARN}'
              tags:
                -
                  tag: Type
                  value: HTTP
        -
          uuid: ab21bc5de5734e6e8aa6f20a243fa019
          name: 'Device Sensor'
          type: DEPENDENT
          key: camera.sensor
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: TYPE
          preprocessing:
            -
              type: REGEX
              parameters:
                - 'root.Image.I0.Appearance.Resolution="(.*)"'
                - \1
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.parameters
          tags:
            -
              tag: Type
              value: Sensor
        -
          uuid: 1e7e44b7fcb34b32abd25100f9748166
          name: 'Device Serial'
          type: DEPENDENT
          key: camera.serial
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: SERIALNO_A
          preprocessing:
            -
              type: REGEX
              parameters:
                - 'root.Properties.System.SerialNumber="(.*)"'
                - \1
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.parameters
          tags:
            -
              tag: Type
              value: Serial
      tags:
        -
          tag: Type
          value: HTTP
    -
      uuid: 02f18dcc823241fe9c718128522f1188
      template: 'BA - Macro - Generic'
      name: 'BA - Macro - Generic'
      groups:
        -
          name: BA/Macros
      tags:
        -
          tag: Type
          value: Macro
      macros:
        -
          macro: '{$CPU_HIGH_AVG_TIME_WARN}'
          value: 15m
          description: 'Amount of time the percentage must be over to alert.'
        -
          macro: '{$CPU_USAGE_WARN}'
          value: '90'
          description: 'Percentage to trigger a CPU usage alert.'
        -
          macro: '{$DISK_HIGH_AVG_PERC_WARN}'
          value: '95'
          description: 'Disk space usage warn threshold.'
        -
          macro: '{$ICMP_HIGH_LATENCY_WARN}'
          value: '500'
          description: 'Ping time in MS'
        -
          macro: '{$ICMP_HIGH_LOSS_WARN}'
          value: '20'
          description: 'Percentage of ICMP loss to warn.'
        -
          macro: '{$LOOP_PROTECT_TIMER}'
          value: '300'
          description: 'What the loop protect timer should be set too in seconds.'
        -
          macro: '{$LOOP_PROTECT_TIMER_WARN}'
          value: '1800'
          description: 'Loop protect detect interval. How many seconds since the last loop should trigger an alert?'
        -
          macro: '{$MEM_USAGE_WARN}'
          value: '90'
          description: 'Percentage to trigger a memory usage alert.'
        -
          macro: '{$SOFTWARE_VERSION_STRINGS}'
          value: (16\.11\.0010|KA\.16\.04\.0026|WB\.16\.10\.0023)
          description: 'A REGEX list of software strings. Trigger an alert if the software versions do not match this value.'
        -
          macro: '{$TEMP_C_WARN}'
          value: '70'
          description: 'Temp in Celsius to trigger an alert.'
    -
      uuid: 2e06dea1d714489c8d284e35778039ce
      template: 'BA - Macro - Interfaces'
      name: 'BA - Macro - Interfaces'
      groups:
        -
          name: BA/Macros
      tags:
        -
          tag: Type
          value: Macro
      macros:
        -
          macro: '{$INTER_ERROR_WARN}'
          value: '1'
          description: 'The count of errors allowed on an interface.'
        -
          macro: '{$INTER_ERROR_WARN_TIME}'
          value: 1h
          description: 'The timeframe for counting errors.'
        -
          macro: '{$INTER_FILTER_REGEX}'
          value: '(tunnel|ppp|loopback|LightWeight|Scheduler|Local Area Connection|Hyper-V|enc0|lo0|pflog0|pfsync0|Logical-int|Nu0|Vl1|veth|lo|docker0$|br|tif|lo|wifi|wlan|eth\d\d?!|dhcp|VLAN|Po)'
          description: 'Filters via Name & Alias'
        -
          macro: '{$INTER_FLAP_WARN_COUNT}'
          value: '3'
          description: 'The count of flaps allowed on an interface.'
        -
          macro: '{$INTER_FLAP_WARN_TIME}'
          value: 60m
          description: 'The timeframe for counting interface flaps.'
        -
          macro: '{$INTER_UPLINK_IMPOSTER_WARN}'
          value: '^Uplink.*$'
          description: 'An interface description must contain this regex expression to be considered a legitiment uplink.'
        -
          macro: '{$INTER_UPLINK_LIMIT}'
          value: '3'
          description: 'Limit on MACs that can be discovered before an interface is considered an uplink.'
        -
          macro: '{$INTER_USAGE_WARN}'
          value: '90'
          description: 'The usage threshold on an interface in percent.'
    -
      uuid: 49d106e4ab994d41b8533cccb7a04abf
      template: 'BA - MIB - Aruba'
      name: 'BA - MIB - Aruba (STATISTICS POWERSUPPLY FAN HP-ICF-CONFIG HP-ICF-BRIDGE)'
      groups:
        -
          name: BA/MIBs
      items:
        -
          uuid: d21b1ba6ab874dedad8afac0dabf7328
          name: 'CPU Usage'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.11.2.14.11.5.1.9.6.1.0
          key: cpu.usage
          history: 7d
          units: '%'
          tags:
            -
              tag: CPU
            -
              tag: Type
              value: Usage
          triggers:
            -
              uuid: 6b1079669c50408998310050e7d208b4
              expression: 'avg(/BA - MIB - Aruba/cpu.usage,{$CPU_HIGH_AVG_TIME_WARN})>={$CPU_USAGE_WARN}'
              name: 'CPU Usage >= {$CPU_USAGE_WARN}% for {$CPU_HIGH_AVG_TIME_WARN}'
              priority: AVERAGE
              tags:
                -
                  tag: CPU
                -
                  tag: Type
                  value: Usage
        -
          uuid: 2fa7b638fe4d4da8bef7ff8c58974a88
          name: 'Memory Size'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SIZE}, .1.3.6.1.4.1.11.2.14.11.5.1.1.2.2.1.1.5]'
          key: memory.size
          delay: 1h
          history: 7d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.*.[''{#SIZE}''].sum()'
          tags:
            -
              tag: Memory
            -
              tag: Type
              value: Size
        -
          uuid: 525480a2f9a542f29cbc5a626c8e65bd
          name: 'Memory Usage'
          type: CALCULATED
          key: memory.usage
          history: 7d
          value_type: FLOAT
          units: '%'
          params: last(//memory.used)/last(//memory.size)
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '100'
          tags:
            -
              tag: Memory
            -
              tag: Type
              value: Usage
          triggers:
            -
              uuid: af7039dacfbc4facbe0677c9b402d06e
              expression: 'last(/BA - MIB - Aruba/memory.usage)>={$CPU_USAGE_WARN}'
              name: 'Memory Usage >= {$MEM_USAGE_WARN}%'
              priority: AVERAGE
              tags:
                -
                  tag: Memory
                -
                  tag: Type
                  value: Usage
        -
          uuid: eb706ca0daea468595ef2a0b6ca09275
          name: 'Memory Used'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#FREE}, .1.3.6.1.4.1.11.2.14.11.5.1.1.2.2.1.1.6]'
          key: memory.used
          history: 7d
          units: B
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.*.[''{#FREE}''].sum()'
          tags:
            -
              tag: Memory
            -
              tag: Type
              value: Used
        -
          uuid: 5e4b2dafd1994d47b8604d26a2d75af9
          name: 'Running Config SHA'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.11.2.14.11.5.1.136.4.1.2.0
          key: snmp.aruba.config.sha.running
          delay: 15m
          history: 7d
          trends: '0'
          value_type: CHAR
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: Type
              value: SHA
        -
          uuid: 9c9386c0f5c04abd99c9b6ebc5cc2508
          name: 'Startup Config SHA'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.11.2.14.11.5.1.136.4.1.3.0
          key: snmp.aruba.config.sha.startup
          delay: 15m
          history: 7d
          trends: '0'
          value_type: CHAR
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: Type
              value: SHA
        -
          uuid: 3c14903dbe254135bd2c2d29f5c7a650
          name: 'Flash Version'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.11.2.14.11.5.1.59.1.3.1.4.1
          key: snmp.aruba.flash.version
          delay: 1d
          trends: '0'
          value_type: CHAR
          inventory_link: OS_SHORT
          tags:
            -
              tag: Software
              value: Flash
            -
              tag: Type
              value: Version
          triggers:
            -
              uuid: c3fe47015dbf41609e4f6b5fec1af2d1
              expression: 'find(/BA - MIB - Aruba/snmp.aruba.flash.version,,"regexp","{$SOFTWARE_VERSION_STRINGS}")=0'
              name: 'Flash version out of date'
              priority: INFO
              description: 'Please update the software on this device.'
              tags:
                -
                  tag: Software
                  value: Flash
                -
                  tag: Type
                  value: Version
        -
          uuid: 393faa601d5d4bc8bb6c0b3e5f41b39b
          name: 'Loop Protect Status'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#ENABLED}, .1.3.6.1.4.1.11.2.14.11.5.1.12.1.5.2.1.1.1]'
          key: snmp.aruba.loopprotect.status
          delay: 1h
          history: 7d
          description: 'Is loop protect enabled on all ports?'
          valuemap:
            name: Status
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$.*.[''{#ENABLED}''].max()'
          tags:
            -
              tag: Config
              value: 'Loop Protect'
            -
              tag: Type
              value: Status
          triggers:
            -
              uuid: ace8b81ed191423eb5c11ef7dcb577c4
              expression: 'last(/BA - MIB - Aruba/snmp.aruba.loopprotect.status)=2'
              name: 'Loop Protect disabled'
              priority: INFO
              tags:
                -
                  tag: Config
                  value: 'Loop Protect'
                -
                  tag: Type
                  value: Status
        -
          uuid: 7d4f92aaf4d24a6d9897fe7a55b4e91b
          name: 'Loop Protect Timer'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.11.2.14.11.5.1.12.1.5.1.3.0
          key: snmp.aruba.loopprotect.timer
          delay: 1h
          history: 7d
          units: seconds
          tags:
            -
              tag: Config
              value: 'Loop Protect'
            -
              tag: Type
              value: Seconds
          triggers:
            -
              uuid: b4e904ee82e5466bbf04d14ae07954ef
              expression: 'last(/BA - MIB - Aruba/snmp.aruba.loopprotect.timer)<>{$LOOP_PROTECT_TIMER}'
              name: 'Loop Protect Timer not set to {$LOOP_PROTECT_TIMER}s'
              priority: INFO
              description: 'Loop Protect Timer is not set to {$LOOP_PROTECT_TIMER} seconds.'
              tags:
                -
                  tag: Config
                  value: 'Loop Protect'
                -
                  tag: Type
                  value: Seconds
        -
          uuid: 98e32926ace9445b9694a8b13559a1a1
          name: 'Spanning Tree Status'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.11.2.14.11.5.1.12.1.4.4.0
          key: snmp.aruba.rstp.status
          delay: 1h
          history: 7d
          description: 'Is rapid spanning tree enabled on the switch?'
          valuemap:
            name: Status
          tags:
            -
              tag: Config
              value: 'Spanning Tree'
            -
              tag: Type
              value: Status
          triggers:
            -
              uuid: c138a27225a84c9a9e7115c542fa80d6
              expression: 'last(/BA - MIB - Aruba/snmp.aruba.rstp.status)=1'
              name: 'Spanning Tree enabled'
              priority: INFO
              tags:
                -
                  tag: Config
                  value: 'Spanning Tree'
                -
                  tag: Type
                  value: Status
      discovery_rules:
        -
          uuid: 02c13eb8b1d14ff4bbf1687ac279c71b
          name: 'Aruba Fan Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#STATE}, .1.3.6.1.4.1.11.2.14.11.5.1.54.2.1.1.4]'
          key: aruba.fan.discovery
          delay: 12h
          item_prototypes:
            -
              uuid: c1fd1186bed24c198b26b8d2cb0266b9
              name: 'Aruba Fan ({#SNMPINDEX}) Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.11.2.14.11.5.1.54.2.1.1.4.{#SNMPINDEX}'
              key: 'aruba.fan.status[{#SNMPINDEX}]'
              delay: 1h
              history: 7d
              valuemap:
                name: 'Fan Status'
              tags:
                -
                  tag: Fan
                  value: '{#SNMPINDEX}'
                -
                  tag: Type
                  value: Status
              trigger_prototypes:
                -
                  uuid: 2623bf6494cd42fa8bc84c04e93b1291
                  expression: 'last(/BA - MIB - Aruba/aruba.fan.status[{#SNMPINDEX}])=0 or last(/BA - MIB - Aruba/aruba.fan.status[{#SNMPINDEX}])=1 or last(/BA - MIB - Aruba/aruba.fan.status[{#SNMPINDEX}])=3 or last(/BA - MIB - Aruba/aruba.fan.status[{#SNMPINDEX}])=4 or last(/BA - MIB - Aruba/aruba.fan.status[{#SNMPINDEX}])=6'
                  name: 'Aruba Fan ({#SNMPINDEX}) Status Fault'
                  priority: AVERAGE
                  tags:
                    -
                      tag: Fan
                      value: '{#SNMPINDEX}'
                    -
                      tag: Type
                      value: Status
        -
          uuid: ebf3d7bbf6bc407493285c95101d29fb
          name: 'Aruba PSU Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#STATUS}, .1.3.6.1.4.1.11.2.14.11.5.1.55.1.1.1.2, {#TEMP}, .1.3.6.1.4.1.11.2.14.11.5.1.55.1.1.1.4]'
          key: aruba.psu.discovery
          delay: 12h
          item_prototypes:
            -
              uuid: e5c62e89d091416d8f513ad15b5a4458
              name: 'Aruba PSU ({#SNMPINDEX}) Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.11.2.14.11.5.1.55.1.1.1.2.{#SNMPINDEX}'
              key: 'aruba.psu.status[{#SNMPINDEX}]'
              delay: 1h
              history: 7d
              valuemap:
                name: 'PSU Status'
              tags:
                -
                  tag: PSU
                  value: '{#SNMPINDEX}'
                -
                  tag: Type
                  value: Status
              trigger_prototypes:
                -
                  uuid: e061727ff41e4d1da6d54acc47a88027
                  expression: |
                    last(/BA - MIB - Aruba/aruba.psu.status[{#SNMPINDEX}])=2 or
                    last(/BA - MIB - Aruba/aruba.psu.status[{#SNMPINDEX}])=4 or
                    last(/BA - MIB - Aruba/aruba.psu.status[{#SNMPINDEX}])=5 or
                    last(/BA - MIB - Aruba/aruba.psu.status[{#SNMPINDEX}])=6
                  name: 'Aruba PSU ({#SNMPINDEX}) Status Fault'
                  priority: AVERAGE
                  tags:
                    -
                      tag: PSU
                      value: '{#SNMPINDEX}'
                    -
                      tag: Type
                      value: Status
            -
              uuid: 7eb98047105a4bc1a84e4d9230ed9a54
              name: 'Aruba PSU ({#SNMPINDEX}) Temperature'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.11.2.14.11.5.1.55.1.1.1.4.{#SNMPINDEX}'
              key: 'aruba.psu.temp[{#SNMPINDEX}]'
              delay: 30m
              history: 7d
              units: Celsius
              tags:
                -
                  tag: PSU
                  value: '{#SNMPINDEX}'
                -
                  tag: Type
                  value: Celsius
              trigger_prototypes:
                -
                  uuid: a8d0b6bb5c5343a2a130dd8bc39a0f33
                  expression: 'last(/BA - MIB - Aruba/aruba.psu.temp[{#SNMPINDEX}])>={$TEMP_C_WARN}'
                  name: 'Aruba PSU ({#SNMPINDEX}) Temperature >= {$TEMP_C_WARN}C'
                  priority: AVERAGE
                  tags:
                    -
                      tag: PSU
                      value: '{#SNMPINDEX}'
                    -
                      tag: Type
                      value: Celsius
          overrides:
            -
              name: 'No Temp'
              step: '1'
              filter:
                conditions:
                  -
                    macro: '{#TEMP}'
                    value: '0'
                    formulaid: A
                  -
                    macro: '{#TEMP}'
                    value: '254'
                    formulaid: B
              operations:
                -
                  operationobject: ITEM_PROTOTYPE
                  operator: LIKE
                  value: Temperature
                  discover: NO_DISCOVER
                -
                  operationobject: TRIGGER_PROTOTYPE
                  operator: LIKE
                  value: Temperature
                  discover: NO_DISCOVER
      tags:
        -
          tag: Type
          value: MIB
      dashboards:
        -
          uuid: 5a74a2692f494cf1ae093a9fc4141824
          name: Aruba
          pages:
            -
              widgets:
                -
                  type: graph
                  width: '11'
                  height: '5'
                  fields:
                    -
                      type: GRAPH
                      name: graphid
                      value:
                        host: 'BA - MIB - Aruba'
                        name: 'CPU Usage'
                -
                  type: graph
                  'y': '5'
                  width: '11'
                  height: '5'
                  fields:
                    -
                      type: GRAPH
                      name: graphid
                      value:
                        host: 'BA - MIB - Aruba'
                        name: 'Memory Usage'
                -
                  type: item
                  x: '11'
                  width: '4'
                  fields:
                    -
                      type: INTEGER
                      name: show
                      value: '2'
                    -
                      type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - Aruba'
                        key: snmp.aruba.flash.version
                -
                  type: item
                  x: '11'
                  'y': '2'
                  width: '4'
                  fields:
                    -
                      type: INTEGER
                      name: show
                      value: '2'
                    -
                      type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - Aruba'
                        key: snmp.aruba.rstp.status
                -
                  type: item
                  x: '11'
                  'y': '4'
                  width: '4'
                  fields:
                    -
                      type: INTEGER
                      name: show
                      value: '2'
                    -
                      type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - Aruba'
                        key: snmp.aruba.loopprotect.status
                -
                  type: item
                  x: '11'
                  'y': '6'
                  width: '4'
                  fields:
                    -
                      type: INTEGER
                      name: show
                      value: '2'
                    -
                      type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - Aruba'
                        key: snmp.aruba.loopprotect.timer
                -
                  type: item
                  x: '15'
                  width: '9'
                  fields:
                    -
                      type: INTEGER
                      name: show
                      value: '2'
                    -
                      type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - Aruba'
                        key: snmp.aruba.config.sha.running
                -
                  type: item
                  x: '15'
                  'y': '2'
                  width: '9'
                  fields:
                    -
                      type: INTEGER
                      name: show
                      value: '2'
                    -
                      type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - Aruba'
                        key: snmp.aruba.config.sha.startup
      valuemaps:
        -
          uuid: 9b1fc8e853c74f7088adf58aba8ab698
          name: 'Fan Status'
          mappings:
            -
              value: '0'
              newvalue: Failed
            -
              value: '1'
              newvalue: Removed
            -
              value: '2'
              newvalue: 'Off'
            -
              value: '3'
              newvalue: 'Under Speed'
            -
              value: '4'
              newvalue: 'Over Speed'
            -
              value: '5'
              newvalue: OK
            -
              value: '6'
              newvalue: Maxed
        -
          uuid: 83f6c58a912942d3b2b28f315efe79f0
          name: 'PSU Status'
          mappings:
            -
              value: '1'
              newvalue: 'Not Present'
            -
              value: '2'
              newvalue: 'Not Plugged'
            -
              value: '3'
              newvalue: Powered
            -
              value: '4'
              newvalue: Failed
            -
              value: '5'
              newvalue: 'Permanent Failure'
            -
              value: '6'
              newvalue: Maxed
        -
          uuid: 8eb209439d724701966573df46e17da0
          name: Status
          mappings:
            -
              value: '1'
              newvalue: Enabled
            -
              value: '2'
              newvalue: Disabled
    -
      uuid: 996e61cf1dd84efe93ea42c66397176d
      template: 'BA - MIB - Entity'
      name: 'BA - MIB - Entity (ENTITY & ENTITY-STATE & ENTITY-SENSOR)'
      groups:
        -
          name: BA/MIBs
      discovery_rules:
        -
          uuid: c6d1b1f21d1b4c77a0e97a9db4d210de
          name: 'Entity Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#NAME}, .1.3.6.1.2.1.47.1.1.1.1.7, {#MODEL}, .1.3.6.1.2.1.47.1.1.1.1.13, {#SERIAL}, .1.3.6.1.2.1.47.1.1.1.1.11, {#CLASS}, .1.3.6.1.2.1.47.1.1.1.1.5, {#SENSORTYPE}, .1.3.6.1.2.1.99.1.1.1.1, {#SENSORVALUE}, .1.3.6.1.2.1.99.1.1.1.4, {#ALARM}, .1.3.6.1.2.1.131.1.1.1.5]'
          key: entity.discovery
          delay: 12h
          filter:
            evaltype: OR
            conditions:
              -
                macro: '{#CLASS}'
                value: ^2|5|10$
                operator: NOT_MATCHES_REGEX
                formulaid: A
              -
                macro: '{#CLASS}'
                operator: NOT_EXISTS
                formulaid: B
          item_prototypes:
            -
              uuid: bdd96b4040ef4985abc5c82e9738a33a
              name: 'Entity ({#NAME}) Alarm'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.131.1.1.1.5.{#SNMPINDEX}'
              key: 'entity.alarm[{#SNMPINDEX}]'
              history: 7d
              valuemap:
                name: Alarm
              tags:
                -
                  tag: Entity
                  value: '{#NAME}'
                -
                  tag: Type
                  value: Alarm
              trigger_prototypes:
                -
                  uuid: 28d8f5392b4f4a6099d0ee260d504be2
                  expression: 'last(/BA - MIB - Entity/entity.alarm[{#SNMPINDEX}])<>0'
                  name: 'Entity ({#NAME}) Alarm Fault'
                  priority: HIGH
                  description: 'An alarm has been triggered!'
                  tags:
                    -
                      tag: Entity
                      value: '{#NAME}'
                    -
                      tag: Type
                      value: Alarm
            -
              uuid: 2dcd7f640d80439b97e9b0c367465d77
              name: 'Entity ({#NAME}) Class'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.47.1.1.1.1.5.{#SNMPINDEX}'
              key: 'entity.class[{#SNMPINDEX}]'
              delay: 12h
              history: 7d
              valuemap:
                name: Class
              tags:
                -
                  tag: Entity
                  value: '{#NAME}'
                -
                  tag: Type
                  value: Class
            -
              uuid: 48fbdf1f81504698b8a40c6ae64aa453
              name: 'Entity ({#NAME}) Description'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.47.1.1.1.1.2.{#SNMPINDEX}'
              key: 'entity.desc[{#SNMPINDEX}]'
              delay: 12h
              history: 365d
              trends: '0'
              value_type: CHAR
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                -
                  tag: Entity
                  value: '{#NAME}'
                -
                  tag: Type
                  value: Description
            -
              uuid: 8ce3cfa23d134747945c774e0ad6e8f8
              name: 'Entity ({#NAME}) Model'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.47.1.1.1.1.13.{#SNMPINDEX}'
              key: 'entity.model[{#SNMPINDEX}]'
              delay: 12h
              history: 365d
              trends: '0'
              value_type: CHAR
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                -
                  tag: Entity
                  value: '{#NAME}'
                -
                  tag: Type
                  value: Model
            -
              uuid: f8806d92cf224591bff4b3ed9027e35d
              name: 'Entity ({#NAME}) Sensor Type'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.99.1.1.1.1.{#SNMPINDEX}'
              key: 'entity.sensor.type[{#SNMPINDEX}]'
              delay: 12h
              history: 7d
              valuemap:
                name: 'Sensor Type'
              tags:
                -
                  tag: Entity
                  value: '{#NAME}'
                -
                  tag: Type
                  value: Type
            -
              uuid: af38085e9c464cbb94a5fbf7629aa576
              name: 'Entity ({#NAME}) Sensor Value'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.99.1.1.1.4.{#SNMPINDEX}'
              key: 'entity.sensor.value[{#SNMPINDEX}]'
              history: 7d
              tags:
                -
                  tag: Entity
                  value: '{#NAME}'
                -
                  tag: Type
                  value: Value
            -
              uuid: b362e9cc210a448f839040e71db6dd96
              name: 'Entity ({#NAME}) Serial'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.47.1.1.1.1.11.{#SNMPINDEX}'
              key: 'entity.serial[{#SNMPINDEX}]'
              delay: 12h
              history: 365d
              trends: '0'
              value_type: CHAR
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                -
                  tag: Entity
                  value: '{#NAME}'
                -
                  tag: Type
                  value: Serial
          graph_prototypes:
            -
              uuid: 54db887b37754d2ab01476b2e2acdb48
              name: 'Entity ({#NAME}) Sensor Value'
              graph_items:
                -
                  color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - Entity'
                    key: 'entity.sensor.value[{#SNMPINDEX}]'
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value);
                  data.forEach(function(v, k) {
                      if (data[k]['{#NAME}'] == undefined) {
                          data[k]['{#NAME}'] = 'Unknown ' + k;
                      }
                  });
                  return JSON.stringify(data);
          overrides:
            -
              name: 'No Alarm'
              step: '5'
              filter:
                conditions:
                  -
                    macro: '{#ALARM}'
                    operator: NOT_EXISTS
                    formulaid: A
                  -
                    macro: '{#ALARM}'
                    value: ^$
                    formulaid: B
              operations:
                -
                  operationobject: ITEM_PROTOTYPE
                  operator: LIKE
                  value: Alarm
                  discover: NO_DISCOVER
                -
                  operationobject: TRIGGER_PROTOTYPE
                  operator: LIKE
                  value: Alarm
                  discover: NO_DISCOVER
            -
              name: 'No Class'
              step: '1'
              filter:
                conditions:
                  -
                    macro: '{#CLASS}'
                    operator: NOT_EXISTS
                    formulaid: A
              operations:
                -
                  operationobject: ITEM_PROTOTYPE
                  operator: LIKE
                  value: Class
                  discover: NO_DISCOVER
            -
              name: 'No Description'
              step: '2'
              filter:
                evaltype: OR
                conditions:
                  -
                    macro: '{#DESCRIPTION}'
                    operator: NOT_EXISTS
                    formulaid: A
                  -
                    macro: '{#DESCRIPTION}'
                    value: .+
                    operator: NOT_MATCHES_REGEX
                    formulaid: B
              operations:
                -
                  operationobject: ITEM_PROTOTYPE
                  operator: LIKE
                  value: Description
                  discover: NO_DISCOVER
            -
              name: 'No Model'
              step: '6'
              filter:
                evaltype: OR
                conditions:
                  -
                    macro: '{#MODEL}'
                    operator: NOT_EXISTS
                    formulaid: A
                  -
                    macro: '{#MODEL}'
                    value: .+
                    operator: NOT_MATCHES_REGEX
                    formulaid: B
              operations:
                -
                  operationobject: ITEM_PROTOTYPE
                  operator: REGEXP
                  value: Model
                  discover: NO_DISCOVER
            -
              name: 'No Sensor Type'
              step: '3'
              filter:
                conditions:
                  -
                    macro: '{#SENSORTYPE}'
                    operator: NOT_EXISTS
                    formulaid: A
              operations:
                -
                  operationobject: ITEM_PROTOTYPE
                  operator: LIKE
                  value: 'Sensor Type'
                  discover: NO_DISCOVER
            -
              name: 'No Sensor Value'
              step: '4'
              filter:
                conditions:
                  -
                    macro: '{#SENSORVALUE}'
                    operator: NOT_EXISTS
                    formulaid: A
              operations:
                -
                  operationobject: ITEM_PROTOTYPE
                  operator: LIKE
                  value: 'Sensor Value'
                  discover: NO_DISCOVER
                -
                  operationobject: GRAPH_PROTOTYPE
                  operator: LIKE
                  value: 'Sensor Value'
                  discover: NO_DISCOVER
            -
              name: 'No Serial'
              step: '7'
              filter:
                evaltype: OR
                conditions:
                  -
                    macro: '{#SERIAL}'
                    operator: NOT_EXISTS
                    formulaid: A
                  -
                    macro: '{#SERIAL}'
                    value: .+
                    operator: NOT_MATCHES_REGEX
                    formulaid: B
              operations:
                -
                  operationobject: ITEM_PROTOTYPE
                  operator: LIKE
                  value: Serial
                  discover: NO_DISCOVER
      tags:
        -
          tag: Type
          value: MIB
      valuemaps:
        -
          uuid: 7caa4aac7c634155b5562ff764894989
          name: Alarm
          mappings:
            -
              value: '0'
              newvalue: OK
            -
              value: '1'
              newvalue: 'Under Repair'
            -
              value: '2'
              newvalue: Critical
            -
              value: '3'
              newvalue: Major
            -
              value: '4'
              newvalue: Minor
            -
              value: '5'
              newvalue: Warning
            -
              value: '6'
              newvalue: Indeterminate
        -
          uuid: 2d1137ea13da40699b7a2fbdf087254e
          name: Class
          mappings:
            -
              value: '1'
              newvalue: Other
            -
              value: '2'
              newvalue: Unknown
            -
              value: '3'
              newvalue: Chassis
            -
              value: '4'
              newvalue: Backplane
            -
              value: '5'
              newvalue: Container
            -
              value: '6'
              newvalue: 'Power Supply'
            -
              value: '7'
              newvalue: Fan
            -
              value: '8'
              newvalue: Sensor
            -
              value: '9'
              newvalue: Module
            -
              value: '10'
              newvalue: Port
            -
              value: '11'
              newvalue: Stack
            -
              value: '12'
              newvalue: CPU
        -
          uuid: 3d5438f67c324a56b0e567e68a90a14a
          name: 'Sensor Status'
          mappings:
            -
              value: '1'
              newvalue: OK
            -
              value: '2'
              newvalue: Unavailable
            -
              value: '3'
              newvalue: 'Non Operational'
        -
          uuid: abc18022ee8a440cb3d5b58ef645fd1c
          name: 'Sensor Type'
          mappings:
            -
              value: '1'
              newvalue: Other
            -
              value: '2'
              newvalue: Unknown
            -
              value: '3'
              newvalue: 'Volts AC'
            -
              value: '4'
              newvalue: 'Volts DC'
            -
              value: '5'
              newvalue: Amps
            -
              value: '6'
              newvalue: Watts
            -
              value: '7'
              newvalue: Hertz
            -
              value: '8'
              newvalue: Celsius
            -
              value: '9'
              newvalue: 'Percent Relative Humidity'
            -
              value: '10'
              newvalue: RPM
            -
              value: '11'
              newvalue: 'Cubic Meters per Minute'
            -
              value: '12'
              newvalue: Boolean
    -
      uuid: 0ed25cacfaad433dbf26caee5e9849a0
      template: 'BA - MIB - Generic'
      name: 'BA - MIB - Generic (RFC1213)'
      groups:
        -
          name: BA/MIBs
      items:
        -
          uuid: e56547fd128b4f38a3fba5cd167bb047
          name: 'SNMP Description'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.1.0
          key: snmp.description
          delay: 12h
          history: 365d
          trends: '0'
          value_type: CHAR
          inventory_link: NOTES
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: SNMP
            -
              tag: Type
              value: Description
        -
          uuid: 0aac83f830854eedbb489a7623b73dd4
          name: 'SNMP Location'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.6.0
          key: snmp.location
          delay: 12h
          history: 365d
          trends: '0'
          value_type: CHAR
          inventory_link: LOCATION
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: SNMP
            -
              tag: Type
              value: Location
        -
          uuid: 892eced5e100486b8e5353fa6ba6fe31
          name: 'SNMP Name'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.5.0
          key: snmp.name
          delay: 12h
          history: 365d
          trends: '0'
          value_type: CHAR
          inventory_link: NAME
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: SNMP
            -
              tag: Type
              value: Name
          triggers:
            -
              uuid: b02a2f213a7b4df28c734ddd3e4415da
              expression: 'change(/BA - MIB - Generic/snmp.name)=1'
              recovery_mode: NONE
              name: 'Device name changed'
              priority: INFO
              manual_close: 'YES'
              tags:
                -
                  tag: SNMP
        -
          uuid: 72a2a3118d0d4bdc8196f91d45d06094
          name: 'SNMP Object ID'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.2.0
          key: snmp.objectid
          delay: 12h
          history: 365d
          trends: '0'
          value_type: CHAR
          inventory_link: TYPE
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: SNMP
            -
              tag: Type
              value: 'Object ID'
        -
          uuid: 8d6e1a0ceb5f4d52b884d4be397652a8
          name: 'SNMP Uptime'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.3.0
          key: snmp.uptime
          history: 7d
          units: s
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            -
              tag: SNMP
            -
              tag: Type
              value: Uptime
          triggers:
            -
              uuid: ed77aa0f513b454d90a231185baef9be
              expression: 'last(/BA - MIB - Generic/snmp.uptime,#1)<last(/BA - MIB - Generic/snmp.uptime,#2)'
              recovery_mode: NONE
              name: 'Device rebooted'
              priority: AVERAGE
              manual_close: 'YES'
              tags:
                -
                  tag: SNMP
      tags:
        -
          tag: Type
          value: MIB
    -
      uuid: b1abf69b89d145d0bb16bf3296e42c7d
      template: 'BA - MIB - Host Resources'
      name: 'BA - MIB - Host Resources (HOST-RESOURCES)'
      groups:
        -
          name: BA/MIBs
      items:
        -
          uuid: 06f324c51e5f4598907c5cb273b658b8
          name: 'CPU Count'
          type: CALCULATED
          key: cpu.count
          delay: 6h
          history: 7d
          params: 'sum(exists_foreach(//snmp.hr.cpu.usage[*]))'
          tags:
            -
              tag: CPU
            -
              tag: Type
              value: Count
        -
          uuid: 5025fa88f9a7452289629d2d127374e8
          name: 'CPU Usage'
          type: CALCULATED
          key: cpu.usage
          history: 7d
          value_type: FLOAT
          units: '%'
          params: 'avg(last_foreach(//snmp.hr.cpu.usage[*]))'
          tags:
            -
              tag: CPU
            -
              tag: Type
              value: Usage
          triggers:
            -
              uuid: 54befd1674e64270b7bc9876c05d5204
              expression: 'avg(/BA - MIB - Host Resources/cpu.usage,{$CPU_USAGE_WARN})>={$CPU_USAGE_WARN}'
              name: 'CPU Usage >= {$CPU_USAGE_WARN}% for {$CPU_HIGH_AVG_TIME_WARN}'
              priority: AVERAGE
              tags:
                -
                  tag: CPU
                -
                  tag: Type
                  value: Usage
        -
          uuid: 9848e28bab61439aa0e341e228cc25e2
          name: 'Memory Usage'
          type: CALCULATED
          key: memory.usage
          history: 7d
          value_type: FLOAT
          units: '%'
          params: 'sum(last_foreach(//snmp.hr.memory.used[*]))/sum(last_foreach(//snmp.hr.memory.size[*]))*100'
          tags:
            -
              tag: Memory
            -
              tag: Type
              value: Usage
          triggers:
            -
              uuid: a677c03f901c4659a6cf8145379883c0
              expression: 'last(/BA - MIB - Host Resources/memory.usage)>={$MEM_USAGE_WARN}'
              name: 'Memory Usage >= {$MEM_USAGE_WARN}%'
              priority: AVERAGE
              tags:
                -
                  tag: Memory
                -
                  tag: Type
                  value: Usage
      discovery_rules:
        -
          uuid: 0c403e28a6c4499a9ca25969557b655a
          name: 'Processor Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#USAGE}, .1.3.6.1.2.1.25.3.3.1.2]'
          key: snmp.hr.cpu.discovery
          delay: 6h
          item_prototypes:
            -
              uuid: d7b4dc1bc39e46548aa5dcbcc9e42d9a
              name: 'CPU ({#SNMPINDEX}) Usage'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.25.3.3.1.2.{#SNMPINDEX}'
              key: 'snmp.hr.cpu.usage[{#SNMPINDEX}]'
              history: 7d
              units: '%'
              tags:
                -
                  tag: CPU
                  value: '{#SNMPINDEX}'
                -
                  tag: Type
                  value: Usage
        -
          uuid: b06ed58b63fe4b74b7028ec8eb23facc
          name: 'Fixed Disk Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#TYPE}, .1.3.6.1.2.1.25.2.3.1.2, {#DESC}, .1.3.6.1.2.1.25.2.3.1.3, {#AUNITS}, .1.3.6.1.2.1.25.2.3.1.4]'
          key: snmp.hr.fdisk.discovery
          delay: 6h
          filter:
            conditions:
              -
                macro: '{#TYPE}'
                value: iso.3.6.1.2.1.25.2.1.4
                formulaid: A
              -
                macro: '{#TYPE}'
                value: 'HOST-RESOURCES-TYPES::hrStorageFixedDisk'
                formulaid: B
          lifetime: 1d
          item_prototypes:
            -
              uuid: 974a620b61674937a5561e9227ab54c3
              name: 'Disk ({#DESC}) Size'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.25.2.3.1.5.{#SNMPINDEX}'
              key: 'snmp.hr.fdisk.size[{#SNMPINDEX}]'
              delay: 6h
              history: 7d
              units: B
              preprocessing:
                -
                  type: JAVASCRIPT
                  parameters:
                    - |
                      value = parseInt(value)
                      if (value < 0) {
                          value = value + (2147483648 * 2);
                      }
                      return value * {#AUNITS};
              tags:
                -
                  tag: Disk
                  value: '{#DESC}'
                -
                  tag: Type
                  value: Size
            -
              uuid: d9309c8752944c33ad352b0b23118259
              name: 'Disk ({#DESC}) Usage'
              type: CALCULATED
              key: 'snmp.hr.fdisk.usage[{#SNMPINDEX}]'
              delay: 1h
              history: 7d
              value_type: FLOAT
              units: '%'
              params: 'last(//snmp.hr.fdisk.used[{#SNMPINDEX}])/last(//snmp.hr.fdisk.size[{#SNMPINDEX}])'
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '100'
              tags:
                -
                  tag: Disk
                  value: '{#DESC}'
                -
                  tag: Type
                  value: Usage
              trigger_prototypes:
                -
                  uuid: 4e5aa0b34f4745ada32f998ac09fe99e
                  expression: 'last(/BA - MIB - Host Resources/snmp.hr.fdisk.usage[{#SNMPINDEX}])>={$DISK_HIGH_AVG_PERC_WARN}'
                  name: 'Disk ({#DESC}) Usage >= {$DISK_HIGH_AVG_PERC_WARN}%'
                  priority: HIGH
            -
              uuid: d12b45c4665144ab99bcc2b12ee4073d
              name: 'Disk ({#DESC}) Used'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.25.2.3.1.6.{#SNMPINDEX}'
              key: 'snmp.hr.fdisk.used[{#SNMPINDEX}]'
              delay: 1h
              history: 7d
              units: B
              preprocessing:
                -
                  type: JAVASCRIPT
                  parameters:
                    - |
                      value = parseInt(value)
                      if (value < 0) {
                          value = value + (2147483648 * 2);
                      }
                      return value * {#AUNITS};
              tags:
                -
                  tag: Disk
                  value: '{#DESC}'
                -
                  tag: Type
                  value: Used
          graph_prototypes:
            -
              uuid: c257fe03d5424e8485a040c39e920cc0
              name: 'Disk ({#DESC}) Statistics'
              graph_items:
                -
                  color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - Host Resources'
                    key: 'snmp.hr.fdisk.size[{#SNMPINDEX}]'
                -
                  sortorder: '1'
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - Host Resources'
                    key: 'snmp.hr.fdisk.used[{#SNMPINDEX}]'
                -
                  sortorder: '2'
                  color: 2774A4
                  yaxisside: RIGHT
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - Host Resources'
                    key: 'snmp.hr.fdisk.usage[{#SNMPINDEX}]'
            -
              uuid: 80c9eb5bde2e4873af69913d1cc94a51
              name: 'Disk ({#DESC}) Usage'
              yaxismax: '0'
              show_work_period: 'NO'
              show_triggers: 'NO'
              type: PIE
              show_3d: 'YES'
              graph_items:
                -
                  color: F0F0F0
                  calc_fnc: LAST
                  type: GRAPH_SUM
                  item:
                    host: 'BA - MIB - Host Resources'
                    key: 'snmp.hr.fdisk.size[{#SNMPINDEX}]'
                -
                  sortorder: '1'
                  color: E57373
                  calc_fnc: LAST
                  item:
                    host: 'BA - MIB - Host Resources'
                    key: 'snmp.hr.fdisk.used[{#SNMPINDEX}]'
        -
          uuid: 97d4e3dfa7e24575a508a1a02efefefe
          name: 'Memory Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#TYPE}, .1.3.6.1.2.1.25.2.3.1.2, {#AUNITS}, .1.3.6.1.2.1.25.2.3.1.4]'
          key: snmp.hr.memory.discovery
          delay: 6h
          filter:
            conditions:
              -
                macro: '{#TYPE}'
                value: iso.3.6.1.2.1.25.2.1.2
                formulaid: A
              -
                macro: '{#TYPE}'
                value: 'HOST-RESOURCES-TYPES::hrStorageRam'
                formulaid: B
          lifetime: 1d
          item_prototypes:
            -
              uuid: d98fce5f76554b27b4bec73937cd52c1
              name: 'Memory ({#SNMPINDEX}) Size'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.25.2.3.1.5.{#SNMPINDEX}'
              key: 'snmp.hr.memory.size[{#SNMPINDEX}]'
              delay: 6h
              history: 7d
              units: B
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '{#AUNITS}'
              tags:
                -
                  tag: Memory
                  value: '{#SNMPINDEX}'
                -
                  tag: Type
                  value: Size
            -
              uuid: ff86e673f16f4254bd7e31b89f2b463d
              name: 'Memory ({#SNMPINDEX}) Used'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.25.2.3.1.6.{#SNMPINDEX}'
              key: 'snmp.hr.memory.used[{#SNMPINDEX}]'
              history: 7d
              units: B
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '{#AUNITS}'
              tags:
                -
                  tag: Memory
                  value: '{#SNMPINDEX}'
                -
                  tag: Type
                  value: Used
          graph_prototypes:
            -
              uuid: 627d5c0a60964b6da483b3b06f12e37b
              name: 'Memory ({#SNMPINDEX})'
              graph_items:
                -
                  color: BF00FF
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - Host Resources'
                    key: 'snmp.hr.memory.size[{#SNMPINDEX}]'
                -
                  sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: 0080FF
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - Host Resources'
                    key: 'snmp.hr.memory.used[{#SNMPINDEX}]'
      tags:
        -
          tag: Type
          value: MIB
      dashboards:
        -
          uuid: 230ad7e9ab814c76a271c4d937cb0e4f
          name: 'Host Resources'
          pages:
            -
              widgets:
                -
                  type: graphprototype
                  'y': '6'
                  width: '9'
                  height: '6'
                  fields:
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        host: 'BA - MIB - Host Resources'
                        name: 'Memory ({#SNMPINDEX})'
                -
                  type: graph
                  width: '9'
                  height: '6'
                  fields:
                    -
                      type: GRAPH
                      name: graphid
                      value:
                        host: 'BA - MIB - Host Resources'
                        name: CPU
                -
                  type: graphprototype
                  x: '9'
                  width: '4'
                  height: '12'
                  fields:
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: INTEGER
                      name: rows
                      value: '3'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        host: 'BA - MIB - Host Resources'
                        name: 'Disk ({#DESC}) Usage'
                -
                  type: graphprototype
                  x: '13'
                  width: '11'
                  height: '12'
                  fields:
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: INTEGER
                      name: rows
                      value: '3'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        host: 'BA - MIB - Host Resources'
                        name: 'Disk ({#DESC}) Statistics'
    -
      uuid: c132e4d556724cb4aab6f04f031d698c
      template: 'BA - MIB - iLO'
      name: 'BA - MIB - iLO (CPQHLTH)'
      groups:
        -
          name: BA/MIBs
      items:
        -
          uuid: b82373e1ca9e42958d5134cbd2ee00ac
          name: 'BIOS Status'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.232.6.2.16.1.0
          key: ilo.bios.status
          delay: 30m
          history: 7d
          trends: 90d
          valuemap:
            name: Condition
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: BIOS
            -
              tag: Type
              value: Status
          triggers:
            -
              uuid: 8a90f354f7d8437ebcc6b624f6116407
              expression: 'last(/BA - MIB - iLO/ilo.bios.status)>=3'
              name: 'BIOS Status fault'
              priority: HIGH
              tags:
                -
                  tag: iLO
                -
                  tag: Type
                  value: Status
      discovery_rules:
        -
          uuid: 259907ba7ffb434db9ab561e915ef699
          name: 'Fan Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#INDEX}, .1.3.6.1.4.1.232.6.2.6.7.1.2, {#PRESENT}, .1.3.6.1.4.1.232.6.2.6.7.1.4]'
          key: ilo.fan.discovery
          delay: 1h
          filter:
            conditions:
              -
                macro: '{#PRESENT}'
                value: '3'
                formulaid: A
          item_prototypes:
            -
              uuid: cb685095094047d09132ff16f3cdc909
              name: 'Fan ({#INDEX}) Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.6.2.6.7.1.9.{#SNMPINDEX}'
              key: 'ilo.fan.status[{#SNMPINDEX}]'
              delay: 15m
              history: 7d
              trends: 90d
              valuemap:
                name: Condition
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                -
                  tag: Fan
                  value: '{#INDEX}'
                -
                  tag: Type
                  value: Status
              trigger_prototypes:
                -
                  uuid: c0ea2d1cbf594b8e9386b99bb74cef7c
                  expression: 'last(/BA - MIB - iLO/ilo.fan.status[{#SNMPINDEX}])>=3'
                  name: 'Fan ({#INDEX}) Status Fault'
                  priority: AVERAGE
                  tags:
                    -
                      tag: Fan
                      value: '{#INDEX}'
                    -
                      tag: Type
                      value: Status
        -
          uuid: 0e2ce50fc37a42339ecce8ff57b64aff
          name: 'Memory Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#LOCATION}, .1.3.6.1.4.1.232.6.2.14.13.1.13, {#STATUS}, .1.3.6.1.4.1.232.6.2.14.13.1.19]'
          key: ilo.memory.discovery
          delay: 1h
          filter:
            conditions:
              -
                macro: '{#STATUS}'
                value: '2'
                operator: NOT_MATCHES_REGEX
                formulaid: A
          item_prototypes:
            -
              uuid: dbd6d96ebc9c41c38327508e10ad42b2
              name: 'Memory Module ({#LOCATION}) Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.6.2.14.13.1.19.{#SNMPINDEX}'
              key: 'ilo.memory.status[{#SNMPINDEX}]'
              delay: 5m
              history: 7d
              trends: 90d
              valuemap:
                name: 'Memory Status'
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                -
                  tag: Memory
                  value: '{#LOCATION}'
                -
                  tag: Type
                  value: Status
              trigger_prototypes:
                -
                  uuid: 9756f0986d89482289d228966f731dbf
                  expression: |
                    last(/BA - MIB - iLO/ilo.memory.status[{#SNMPINDEX}])=8 or last(/BA - MIB - iLO/ilo.memory.status[{#SNMPINDEX}])=9 or
                    last(/BA - MIB - iLO/ilo.memory.status[{#SNMPINDEX}])=10 or
                    last(/BA - MIB - iLO/ilo.memory.status[{#SNMPINDEX}])=11 or
                    last(/BA - MIB - iLO/ilo.memory.status[{#SNMPINDEX}])=13 or
                    last(/BA - MIB - iLO/ilo.memory.status[{#SNMPINDEX}])=14 or
                    last(/BA - MIB - iLO/ilo.memory.status[{#SNMPINDEX}])=15
                  name: 'Memory Module ({#LOCATION}) Status Fault'
                  priority: HIGH
                  tags:
                    -
                      tag: Memory
                      value: '{#LOCATION}'
                    -
                      tag: Type
                      value: Status
        -
          uuid: 1ef1a17f77aa4016b9d4141fd9ac27e4
          name: 'Power Supply Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#BAY}, .1.3.6.1.4.1.232.6.2.9.3.1.2]'
          key: ilo.psu.discovery
          delay: 1h
          item_prototypes:
            -
              uuid: 55c324a536154fa8ada8ad8b17029a04
              name: 'Power Supply ({#BAY}) Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.6.2.9.3.1.4.{#SNMPINDEX}'
              key: 'ilo.psu.status[{#SNMPINDEX}]'
              delay: 15m
              history: 7d
              trends: 90d
              valuemap:
                name: Condition
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                -
                  tag: 'Power Supply'
                  value: '{#BAY}'
                -
                  tag: Type
                  value: Status
              trigger_prototypes:
                -
                  uuid: 67085e3c3e4a430d939dfefbb43a9a1a
                  expression: 'last(/BA - MIB - iLO/ilo.psu.status[{#SNMPINDEX}])>=3'
                  name: 'Power Supply ({#BAY}) Status Fault'
                  priority: HIGH
                  tags:
                    -
                      tag: 'Power Supply'
                      value: '{#BAY}'
                    -
                      tag: Type
                      value: Status
            -
              uuid: 86b7a6491c684353b2a1b868bc25ea3d
              name: 'Power Supply ({#BAY}) Input Volts'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.6.2.9.3.1.6.{#SNMPINDEX}'
              key: 'ilo.psu.volts[{#SNMPINDEX}]'
              delay: 15m
              history: 7d
              units: V
              tags:
                -
                  tag: 'Power Supply'
                  value: '{#BAY}'
                -
                  tag: Type
                  value: Volts
            -
              uuid: 0e71a00b711145c4b12e1d5a8d380ff1
              name: 'Power Supply ({#BAY}) Output Watts'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.6.2.9.3.1.7.{#SNMPINDEX}'
              key: 'ilo.psu.watts[{#SNMPINDEX}]'
              delay: 15m
              history: 7d
              units: W
              tags:
                -
                  tag: 'Power Supply'
                  value: '{#BAY}'
                -
                  tag: Type
                  value: Watts
        -
          uuid: a397d83fcc6d4190b8f9bb3d2eb9d414
          name: 'Temperature Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#LOCALE}, .1.3.6.1.4.1.232.6.2.6.8.1.3]'
          key: ilo.temp.discovery
          delay: 1h
          item_prototypes:
            -
              uuid: d8f0505960564bf191f0518f4b9602e6
              name: 'Temperature ({#LOCALE}) Celsius'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.6.2.6.8.1.4.{#SNMPINDEX}'
              key: 'ilo.temp.celsius[{#SNMPINDEX}]'
              delay: 5m
              history: 7d
              units: C
              tags:
                -
                  tag: Temperature
                  value: '{#LOCALE}'
                -
                  tag: Type
                  value: Celsius
            -
              uuid: 892880b41bc7497e889d3a9901f36947
              name: 'Temperature ({#LOCALE}) Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.6.2.6.8.1.6.{#SNMPINDEX}'
              key: 'ilo.temp.status[{#SNMPINDEX}]'
              delay: 15m
              history: 7d
              trends: 90d
              valuemap:
                name: Condition
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                -
                  tag: Temperature
                  value: '{#LOCALE}'
                -
                  tag: Type
                  value: Status
              trigger_prototypes:
                -
                  uuid: 74e231598873468e8b3657365506fa40
                  expression: 'last(/BA - MIB - iLO/ilo.temp.status[{#SNMPINDEX}])>=3'
                  name: 'Temperature ({#LOCALE}) Status Fault'
                  priority: HIGH
                  tags:
                    -
                      tag: Temperature
                      value: '{#LOCALE}'
                    -
                      tag: Type
                      value: Status
          preprocessing:
            -
              type: STR_REPLACE
              parameters:
                - '"1"'
                - '"Other"'
            -
              type: STR_REPLACE
              parameters:
                - '"2"'
                - '"Unknown"'
            -
              type: STR_REPLACE
              parameters:
                - '"3"'
                - '"System"'
            -
              type: STR_REPLACE
              parameters:
                - '"4"'
                - '"System Board"'
            -
              type: STR_REPLACE
              parameters:
                - '"5"'
                - '"IO Board"'
            -
              type: STR_REPLACE
              parameters:
                - '"6"'
                - '"CPU"'
            -
              type: STR_REPLACE
              parameters:
                - '"7"'
                - '"Memory"'
            -
              type: STR_REPLACE
              parameters:
                - '"8"'
                - '"Storage"'
            -
              type: STR_REPLACE
              parameters:
                - '"9"'
                - '"Removeable Media"'
            -
              type: STR_REPLACE
              parameters:
                - '"10"'
                - '"Power Supply"'
            -
              type: STR_REPLACE
              parameters:
                - '"11"'
                - '"Ambient"'
            -
              type: STR_REPLACE
              parameters:
                - '"12"'
                - '"Chassis"'
            -
              type: STR_REPLACE
              parameters:
                - '"13"'
                - '"Bridge Card"'
      tags:
        -
          tag: Type
          value: MIB
      valuemaps:
        -
          uuid: 5d0a36b6fc934ec8960c3f2f22ad2338
          name: Condition
          mappings:
            -
              value: '1'
              newvalue: Other
            -
              value: '2'
              newvalue: OK
            -
              value: '3'
              newvalue: Degraded
            -
              value: '4'
              newvalue: Failed
        -
          uuid: 8663d7853f594e4a927b2d0d49ec902d
          name: 'Memory Status'
          mappings:
            -
              value: '1'
              newvalue: Other
            -
              value: '2'
              newvalue: 'Not Present'
            -
              value: '3'
              newvalue: Present
            -
              value: '4'
              newvalue: Good
            -
              value: '5'
              newvalue: Add
            -
              value: '6'
              newvalue: Upgrade
            -
              value: '7'
              newvalue: Missing
            -
              value: '8'
              newvalue: 'Does Not Match'
            -
              value: '9'
              newvalue: 'Not Supported'
            -
              value: '10'
              newvalue: 'Bad Config'
            -
              value: '11'
              newvalue: Degraded
            -
              value: '12'
              newvalue: Spare
            -
              value: '13'
              newvalue: Partial
            -
              value: '14'
              newvalue: 'Config Error'
            -
              value: '15'
              newvalue: 'Training Failure'
    -
      uuid: 71e181bbccaf4ac6ad6dbc31f4ef7ffa
      template: 'BA - MIB - Interfaces'
      name: 'BA - MIB - Interfaces (RFC1213 & IF)'
      groups:
        -
          name: BA/MIBs
      discovery_rules:
        -
          uuid: e4cdcd9f67b24b3c93b312a52bf78a11
          name: 'Interfaces Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#NAME}, .1.3.6.1.2.1.31.1.1.1.1, {#ALIAS}, .1.3.6.1.2.1.31.1.1.1.18, {#OSTATUS}, .1.3.6.1.2.1.2.2.1.8, {#ASTATUS}, .1.3.6.1.2.1.2.2.1.7]'
          key: snmp.interfaces.discovery
          delay: 6h
          filter:
            conditions:
              -
                macro: '{#NAME}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: C
              -
                macro: '{#ALIAS}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: A
              -
                macro: '{#OSTATUS}'
                value: '6'
                operator: NOT_MATCHES_REGEX
                formulaid: D
              -
                macro: '{#ASTATUS}'
                value: '2'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          lifetime: 1d
          item_prototypes:
            -
              uuid: 5760b2886c8640fd9bab2f200c57ce0d
              name: 'Interface ({#NAME}: {#ALIAS}) In Errors'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}'
              key: 'snmp.interfaces.in.errors[{#SNMPINDEX}]'
              delay: 5m
              history: 7d
              units: bps
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Interface
                  value: '{#NAME}'
                -
                  tag: Type
                  value: Errors
            -
              uuid: 6b9bd480242345febbcfc08b18bece36
              name: 'Interface ({#NAME}: {#ALIAS}) In Usage'
              type: CALCULATED
              key: 'snmp.interfaces.in.usage[{#SNMPINDEX}]'
              history: 7d
              value_type: FLOAT
              units: '%'
              params: 'last(//snmp.interfaces.in[{#SNMPINDEX}])/last(//snmp.interfaces.speed[{#SNMPINDEX}])'
              preprocessing:
                -
                  type: CHECK_NOT_SUPPORTED
                  parameters:
                    - ''
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                -
                  type: MULTIPLIER
                  parameters:
                    - '100'
              tags:
                -
                  tag: Interface
                  value: '{#NAME}'
                -
                  tag: Type
                  value: Usage
            -
              uuid: d41db500945643b6afc4b82015f5f5e6
              name: 'Interface ({#NAME}: {#ALIAS}) In Rate'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.2.2.1.10.{#SNMPINDEX}'
              key: 'snmp.interfaces.in[{#SNMPINDEX}]'
              history: 7d
              units: bps
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Interface
                  value: '{#NAME}'
                -
                  tag: Type
                  value: Rate
            -
              uuid: b39447b3446c4432a3c66ef3e46fb5a6
              name: 'Interface ({#NAME}: {#ALIAS}) Operational Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}'
              key: 'snmp.interfaces.operstatus[{#SNMPINDEX}]'
              delay: 2m
              history: 7d
              valuemap:
                name: 'Operational Status'
              tags:
                -
                  tag: Interface
                  value: '{#NAME}'
                -
                  tag: Type
                  value: Status
              trigger_prototypes:
                -
                  uuid: 5436374b9ed946e79cb2bf75e02f30e4
                  expression: 'changecount(/BA - MIB - Interfaces/snmp.interfaces.operstatus[{#SNMPINDEX}],{$INTER_FLAP_WARN_TIME},"dec")>={$INTER_FLAP_WARN_COUNT}'
                  name: 'Interface ({#NAME}: {#ALIAS}) Flapped >= {$INTER_FLAP_WARN_COUNT}x Within {$INTER_FLAP_WARN_TIME}'
                  priority: WARNING
                  tags:
                    -
                      tag: Interface
                      value: '{#NAME}'
                    -
                      tag: Type
                      value: Status
            -
              uuid: 8767d44b389a4d39bfa7cdd9bef3e19d
              name: 'Interface ({#NAME}: {#ALIAS}) Out Errors'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}'
              key: 'snmp.interfaces.out.errors[{#SNMPINDEX}]'
              delay: 5m
              history: 7d
              units: bps
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Interface
                  value: '{#NAME}'
                -
                  tag: Type
                  value: Errors
            -
              uuid: 27685ca79f79438f9dcd391306f44291
              name: 'Interface ({#NAME}: {#ALIAS}) Out Usage'
              type: CALCULATED
              key: 'snmp.interfaces.out.usage[{#SNMPINDEX}]'
              history: 7d
              value_type: FLOAT
              units: '%'
              params: 'last(//snmp.interfaces.out[{#SNMPINDEX}])/last(//snmp.interfaces.speed[{#SNMPINDEX}])'
              preprocessing:
                -
                  type: CHECK_NOT_SUPPORTED
                  parameters:
                    - ''
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                -
                  type: MULTIPLIER
                  parameters:
                    - '100'
              tags:
                -
                  tag: Interface
                  value: '{#NAME}'
                -
                  tag: Type
                  value: Usage
            -
              uuid: 560a80f3986f4daaa67307817be05cda
              name: 'Interface ({#NAME}: {#ALIAS}) Out Rate'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.2.2.1.16.{#SNMPINDEX}'
              key: 'snmp.interfaces.out[{#SNMPINDEX}]'
              history: 7d
              units: bps
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Interface
                  value: '{#NAME}'
                -
                  tag: Type
                  value: Rate
            -
              uuid: d025c6fb73e04829822ba94aa58f4a45
              name: 'Interface ({#NAME}: {#ALIAS}) Speed'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.31.1.1.1.15.{#SNMPINDEX}'
              key: 'snmp.interfaces.speed[{#SNMPINDEX}]'
              delay: 1h
              history: 7d
              units: bps
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '1000000'
              tags:
                -
                  tag: Interface
                  value: '{#NAME}'
                -
                  tag: Type
                  value: Speed
          trigger_prototypes:
            -
              uuid: 62ed56a4a893446fa8515de4852ca5fa
              expression: 'sum(/BA - MIB - Interfaces/snmp.interfaces.in.errors[{#SNMPINDEX}],{$INTER_ERROR_WARN_TIME})>={$INTER_ERROR_WARN} or sum(/BA - MIB - Interfaces/snmp.interfaces.out.errors[{#SNMPINDEX}],{$INTER_ERROR_WARN_TIME})>={$INTER_ERROR_WARN}'
              name: 'Interface ({#NAME}: {#ALIAS}) Errors >= {$INTER_ERROR_WARN} Within {$INTER_ERROR_WARN_TIME}'
              priority: WARNING
              tags:
                -
                  tag: Interface
                  value: '{#NAME}'
                -
                  tag: Type
                  value: Errors
            -
              uuid: b429247383cd421db1f0e4471e286c98
              expression: 'last(/BA - MIB - Interfaces/snmp.interfaces.in.usage[{#SNMPINDEX}])>={$INTER_USAGE_WARN} or last(/BA - MIB - Interfaces/snmp.interfaces.out.usage[{#SNMPINDEX}])>={$INTER_USAGE_WARN}'
              name: 'Interface ({#NAME}: {#ALIAS}) Usage >= {$INTER_USAGE_WARN}%'
              priority: WARNING
              tags:
                -
                  tag: Interface
                  value: '{#NAME}'
                -
                  tag: Type
                  value: Usage
          graph_prototypes:
            -
              uuid: 777a7a1a8c8d49aea746670c7dacd759
              name: 'Interface ({#NAME}: {#ALIAS}) Statistics'
              graph_items:
                -
                  color: 1E88E5
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - Interfaces'
                    key: 'snmp.interfaces.in[{#SNMPINDEX}]'
                -
                  sortorder: '1'
                  color: 2E7D32
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - Interfaces'
                    key: 'snmp.interfaces.out[{#SNMPINDEX}]'
                -
                  sortorder: '2'
                  color: FF5722
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - Interfaces'
                    key: 'snmp.interfaces.in.errors[{#SNMPINDEX}]'
                -
                  sortorder: '3'
                  color: FFA726
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - Interfaces'
                    key: 'snmp.interfaces.out.errors[{#SNMPINDEX}]'
      tags:
        -
          tag: Type
          value: MIB
      dashboards:
        -
          uuid: 9f66f49a16914a42b4731103a16d816f
          name: Interfaces
          pages:
            -
              widgets:
                -
                  type: graphprototype
                  width: '24'
                  height: '11'
                  fields:
                    -
                      type: INTEGER
                      name: rows
                      value: '2'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        host: 'BA - MIB - Interfaces'
                        name: 'Interface ({#NAME}: {#ALIAS}) Statistics'
      valuemaps:
        -
          uuid: 042dd6004ca744328459b83d571efd02
          name: 'Operational Status'
          mappings:
            -
              value: '1'
              newvalue: Up
            -
              value: '2'
              newvalue: Down
            -
              value: '3'
              newvalue: Testing
    -
      uuid: c978731e458f4899bad556a58a4f7722
      template: 'BA - MIB - Interfaces - Aruba'
      name: 'BA - MIB - Interfaces - Aruba (IF & HP-ICF-BRIDGE)'
      groups:
        -
          name: BA/MIBs
      discovery_rules:
        -
          uuid: 42af4ec9d263413a81306b4b6c2bfcef
          name: 'Interfaces Discovery Loop Protect'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#ENABLED}, .1.3.6.1.4.1.11.2.14.11.5.1.12.1.5.2.1.1.1, {#NAME}, .1.3.6.1.2.1.31.1.1.1.1, {#ALIAS}, .1.3.6.1.2.1.31.1.1.1.18]'
          key: snmp.interfaces.loopprotect.discovery
          delay: 6h
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#ALIAS}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: A
              -
                macro: '{#NAME}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: D
              -
                macro: '{#NAME}'
                value: '^(Vl|Bl|Nu).*$'
                operator: NOT_MATCHES_REGEX
                formulaid: E
              -
                macro: '{#ENABLED}'
                operator: EXISTS
                formulaid: B
              -
                macro: '{#ENABLED}'
                value: '1'
                formulaid: C
          lifetime: 1d
          item_prototypes:
            -
              uuid: 6f074bb7eaf6440b9f60faae0eba55cb
              name: 'Interface ({#NAME}: {#ALIAS}) Loop Detection Count'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.11.2.14.11.5.1.12.1.5.2.1.1.4.{#SNMPINDEX}'
              key: 'snmp.interfaces.aruba.loopdetected.status[{#SNMPINDEX}]'
              history: 7d
              valuemap:
                name: 'Loop Detected'
              tags:
                -
                  tag: Interface
                  value: '{#NAME}'
                -
                  tag: 'Loop Detection'
                -
                  tag: Type
                  value: Count
              trigger_prototypes:
                -
                  uuid: 3add992e000848a29c0808061e524b72
                  expression: 'changecount(/BA - MIB - Interfaces - Aruba/snmp.interfaces.aruba.loopdetected.status[{#SNMPINDEX}],{$LOOP_PROTECT_TIMER_WARN},"inc")>0'
                  name: 'Interface ({#NAME}: {#ALIAS}) Loop Detected'
                  priority: HIGH
                  description: 'A loop has been detected on this port!'
                  tags:
                    -
                      tag: Interface
                      value: '{#NAME}'
                    -
                      tag: 'Loop Detected'
                    -
                      tag: Type
                      value: Status
      tags:
        -
          tag: Type
          value: MIB
      valuemaps:
        -
          uuid: e2de721ce9284480becb8755327cfbe0
          name: 'Loop Detected'
          mappings:
            -
              value: '1'
              newvalue: 'Yes'
            -
              value: '2'
              newvalue: 'No'
    -
      uuid: e610e67b64ae4a89b9838318c002d244
      template: 'BA - MIB - Interfaces LLDP'
      name: 'BA - MIB - Interfaces LLDP (IF & LLDP)'
      groups:
        -
          name: BA/MIBs
      discovery_rules:
        -
          uuid: 792c76d171b54eb2b4308a4f0b4747c7
          name: 'Interfaces Discovery LLDP'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#LLDP}, .1.0.8802.1.1.2.1.4.1.1.4, {#NAME}, .1.3.6.1.2.1.31.1.1.1.1, {#ALIAS}, .1.3.6.1.2.1.31.1.1.1.18]'
          key: snmp.interfaces.lldp.discovery
          delay: 6h
          filter:
            conditions:
              -
                macro: '{#ALIAS}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: A
              -
                macro: '{#NAME}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              -
                macro: '{#NAME}'
                value: '^(Vl|Bl|Nu).*$'
                operator: NOT_MATCHES_REGEX
                formulaid: C
          lifetime: 1d
          item_prototypes:
            -
              uuid: 67a3110993f44f008ba62945fe121530
              name: 'Interface ({#NAME}: {#ALIAS}) LLDP Remote Description'
              type: SNMP_AGENT
              snmp_oid: '.1.0.8802.1.1.2.1.4.1.1.10.{#SNMPINDEX}'
              key: 'snmp.interfaces.lldp.desc[{#SNMPINDEX}]'
              delay: 30m
              history: 365d
              trends: '0'
              value_type: CHAR
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                -
                  tag: Interface
                  value: '{#NAME}'
                -
                  tag: LLDP
                -
                  tag: Type
                  value: Description
            -
              uuid: ac8d2f33e8444fba9e6275d1a531ebb2
              name: 'Interface ({#NAME}: {#ALIAS}) LLDP Remote Host'
              type: SNMP_AGENT
              snmp_oid: '.1.0.8802.1.1.2.1.4.1.1.9.{#SNMPINDEX}'
              key: 'snmp.interfaces.lldp.host[{#SNMPINDEX}]'
              delay: 30m
              history: 365d
              trends: '0'
              value_type: CHAR
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                -
                  tag: Interface
                  value: '{#NAME}'
                -
                  tag: LLDP
                -
                  tag: Type
                  value: Host
            -
              uuid: 0559d8d6479a4eac8e12a88170d63e89
              name: 'Interface ({#NAME}: {#ALIAS}) LLDP Remote Port'
              type: SNMP_AGENT
              snmp_oid: '.1.0.8802.1.1.2.1.4.1.1.8.{#SNMPINDEX}'
              key: 'snmp.interfaces.lldp.port[{#SNMPINDEX}]'
              delay: 30m
              history: 365d
              trends: '0'
              value_type: CHAR
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                -
                  tag: Interface
                  value: '{#NAME}'
                -
                  tag: LLDP
                -
                  tag: Type
                  value: 'Remote Port'
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var newData = [];
                  var data = JSON.parse(value);
                  data.forEach(function(item1) {
                      if(item1['{#SNMPINDEX}'].includes('.')) {
                          data.forEach(function(item2) {
                              if(item1['{#SNMPINDEX}'].split('.')[1] == item2['{#SNMPINDEX}']) {
                                  item2['{#SNMPINDEX}'] = item1['{#SNMPINDEX}'];
                                  newData.push(item2);
                              }
                          });
                      }
                  });
                  return JSON.stringify(newData);
      tags:
        -
          tag: Type
          value: MIB
    -
      uuid: 6ca02ebb5e5b4ba7a83e37c81d53c44b
      template: 'BA - MIB - Interfaces MAC'
      name: 'BA - MIB - Interfaces MAC (IF & BRIDGE)'
      groups:
        -
          name: BA/MIBs
      items:
        -
          uuid: fc899d89f8354984b896bbad38c158ac
          name: 'Interfaces Discovery MAC Count'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#PORT}, .1.3.6.1.2.1.17.4.3.1.2, {#NAME}, .1.3.6.1.2.1.31.1.1.1.1, {#ALIAS}, .1.3.6.1.2.1.31.1.1.1.18]'
          key: snmp.interfaces.mac.count.discovery.json
          delay: 15m
          history: 1h
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value);
                  var ports = {};
                  var results = [];
                  data.forEach(function(macs) {
                      if (macs['{#PORT}'] == undefined) return;
                      if (ports[macs['{#PORT}']] == undefined) {
                          ports[macs['{#PORT}']] = 1;
                      } else {
                          ports[macs['{#PORT}']] += 1;
                      }
                  });
                  data.forEach(function(interfaces) {
                          if (interfaces['{#NAME}'] == undefined) return;
                          interfaces['{#MACS}'] = ports[interfaces['{#SNMPINDEX}']];
                          if (interfaces['{#MACS}'] == undefined) interfaces['{#MACS}'] = 0;
                          results.push(interfaces);
                      });
                  return JSON.stringify(results);
          tags:
            -
              tag: 'MAC Count'
            -
              tag: Type
              value: Discovery
        -
          uuid: 9ebe2ba0750e44d6aba6d54dba1504b4
          name: 'Interfaces Discovery MAC'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#ADDR}, .1.3.6.1.2.1.17.4.3.1.1, {#PORT}, .1.3.6.1.2.1.17.4.3.1.2, {#NAME}, .1.3.6.1.2.1.31.1.1.1.1, {#ALIAS}, .1.3.6.1.2.1.31.1.1.1.18]'
          key: snmp.interfaces.mac.discovery.json
          delay: 15m
          history: 1h
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var result = [];
                  var addressReg = /("{#ADDR}":"..)( )(..)( )(..)( )(..)( )(..)( )(..)( )/g;
                  value = value.replace(addressReg, '$1:$3:$5:$7:$9:$11');
                  var jvalue = JSON.parse(value);
                  jvalue.forEach(function(port) {
                      if (port['{#ALIAS}'] == undefined) return;
                      var portResult = [];
                      jvalue.forEach(function(address) {
                          if (portResult.length > {$INTER_UPLINK_LIMIT}) return;
                          if (address['{#ADDR}'] == undefined) return;
                          if (address['{#PORT}'] == port['{#SNMPINDEX}']) {
                              var newAddrParts = [];
                              var addr = address['{#ADDR}'].toLowerCase();
                              var addrParts = addr.split(':');
                              addrParts.forEach(function(v) {
                                  if (v.length == 1) v = '0' + v;
                                  newAddrParts.push(v);
                              });
                              var newAddr = newAddrParts.join(':');
                              var obj = {
                                  '{#SNMPINDEX}': newAddr,
                                  '{#PORT}': port['{#SNMPINDEX}'],
                                  '{#NAME}': port['{#NAME}'],
                                  '{#ALIAS}': port['{#ALIAS}']
                              };
                              portResult.push(obj);
                          }
                      });
                      if (portResult.length > 0 && portResult.length <= {$INTER_UPLINK_LIMIT}) {
                          portResult.forEach(function(item) {
                              result.push(item);
                          });
                      }
                  });
                  return JSON.stringify(result);
          tags:
            -
              tag: MAC
            -
              tag: Type
              value: Discovery
      discovery_rules:
        -
          uuid: b2841a94cb24434798eb25f1bae1be56
          name: 'Interfaces Discovery MAC Count'
          type: DEPENDENT
          key: snmp.interfaces.mac.count.discovery
          delay: '0'
          filter:
            conditions:
              -
                macro: '{#ALIAS}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: A
              -
                macro: '{#NAME}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          lifetime: 1h
          item_prototypes:
            -
              uuid: ea1e8ad01fa44b9c9432becb0580604c
              name: 'Interface ({#NAME}: {#ALIAS}) MAC Count'
              type: DEPENDENT
              key: 'snmp.interfaces.mac.count[{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              preprocessing:
                -
                  type: JAVASCRIPT
                  parameters:
                    - 'return {#MACS};'
              master_item:
                key: snmp.interfaces.mac.count.discovery.json
              tags:
                -
                  tag: Interface
                  value: '{#NAME}'
                -
                  tag: Type
                  value: Count
              trigger_prototypes:
                -
                  uuid: be035349a1014591bba25f5f703b1d5e
                  expression: 'last(/BA - MIB - Interfaces MAC/snmp.interfaces.mac.count[{#SNMPINDEX}])>={$INTER_UPLINK_LIMIT}'
                  name: 'Interface ({#NAME}: {#ALIAS}) MAC Count >= {$INTER_UPLINK_LIMIT}'
                  priority: WARNING
                  description: 'An un-managed device has been detected on this port.'
                  tags:
                    -
                      tag: Interface
                      value: '{#NAME}'
                    -
                      tag: Type
                      value: Count
            -
              uuid: 62187cc596264fe4938e8dd2cdc358ba
              name: 'Interface ({#NAME}: {#ALIAS}) Uplink Status'
              type: DEPENDENT
              key: 'snmp.interfaces.mac.uplinkstatus[{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              valuemap:
                name: 'Uplink Status'
              preprocessing:
                -
                  type: JAVASCRIPT
                  parameters:
                    - |
                      if ({#MACS} >= {$INTER_UPLINK_LIMIT}) {
                          return 1;
                      }
                      return 0;
              master_item:
                key: snmp.interfaces.mac.count.discovery.json
              tags:
                -
                  tag: Interface
                  value: '{#NAME}'
                -
                  tag: Type
                  value: Status
          master_item:
            key: snmp.interfaces.mac.count.discovery.json
          overrides:
            -
              name: 'No MAC Count Alarm'
              step: '1'
              filter:
                conditions:
                  -
                    macro: '{#ALIAS}'
                    value: '{$INTER_UPLINK_IMPOSTER_WARN}'
                    formulaid: A
              operations:
                -
                  operationobject: TRIGGER_PROTOTYPE
                  operator: LIKE
                  value: 'MAC Count >='
                  discover: NO_DISCOVER
        -
          uuid: 5bcb64d2d3f54e908235d4610981cddd
          name: 'Interfaces Discovery MAC'
          type: DEPENDENT
          key: snmp.interfaces.mac.discovery
          delay: '0'
          item_prototypes:
            -
              uuid: 44672117f4544766855c1c106404e8c7
              name: 'Interface ({#NAME}: {#ALIAS}), MAC: {#SNMPINDEX}'
              type: DEPENDENT
              key: 'snmp.interfaces.mac.status[{#PORT}:{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: 30d
              valuemap:
                name: 'MAC Status'
              preprocessing:
                -
                  type: MATCHES_REGEX
                  parameters:
                    - '{.SNMPINDEX}":"{#SNMPINDEX}","{.PORT}":"{#PORT}"'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                -
                  type: JAVASCRIPT
                  parameters:
                    - |
                      if (value == 0) return value;
                      return 1;
              master_item:
                key: snmp.interfaces.mac.discovery.json
              tags:
                -
                  tag: Interface
                  value: '{#NAME}'
                -
                  tag: MAC
                  value: '{#SNMPINDEX}'
                -
                  tag: Type
                  value: Status
          master_item:
            key: snmp.interfaces.mac.discovery.json
      tags:
        -
          tag: Type
          value: MIB
      valuemaps:
        -
          uuid: 4832488ec33a470b8f7ee84221ceb82b
          name: 'MAC Status'
          mappings:
            -
              value: '0'
              newvalue: Stale
            -
              value: '1'
              newvalue: Active
        -
          uuid: f7f237d11e6648cbad93b136ccf62d2a
          name: 'Uplink Status'
          mappings:
            -
              value: '0'
              newvalue: 'False'
            -
              value: '1'
              newvalue: 'True'
    -
      uuid: c96e74b51406426fa9678cb3e36e305f
      template: 'BA - MIB - Interfaces POE'
      name: 'BA - MIB - Interfaces POE (RFC1213 & IF & POWER-ETHERNET)'
      groups:
        -
          name: BA/MIBs
      discovery_rules:
        -
          uuid: fc9a676e681547f7976992861096cbee
          name: 'Interfaces Discovery POE'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#POEENAB}, .1.3.6.1.2.1.105.1.1.1.3, {#IFINDEX}, .1.3.6.1.2.1.17.1.4.1.2, {#NAME}, .1.3.6.1.2.1.31.1.1.1.1, {#ALIAS}, .1.3.6.1.2.1.31.1.1.1.18, {#ASTATUS}, .1.3.6.1.2.1.2.2.1.7]'
          key: snmp.interfaces.poe.discovery
          delay: 6h
          filter:
            conditions:
              -
                macro: '{#ASTATUS}'
                value: '2'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              -
                macro: '{#ALIAS}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: A
              -
                macro: '{#NAME}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: C
          lifetime: 1d
          item_prototypes:
            -
              uuid: 608070fdd95b40d5b1d12d99608cfe02
              name: 'Interface ({#NAME}: {#ALIAS}) POE Admin Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.105.1.1.1.3.{#SNMPINDEX}'
              key: 'snmp.interfaces.poe.astatus[{#SNMPINDEX}]'
              delay: 30m
              history: 7d
              valuemap:
                name: 'POE Admin'
              tags:
                -
                  tag: Interface
                  value: '{#NAME}'
                -
                  tag: POE
                -
                  tag: Type
                  value: Status
            -
              uuid: 617cdf1c471444099069446bb97565b5
              name: 'Interface ({#NAME}: {#ALIAS}) POE Detection'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.105.1.1.1.6.{#SNMPINDEX}'
              key: 'snmp.interfaces.poe.dstatus[{#SNMPINDEX}]'
              history: 7d
              valuemap:
                name: 'POE Status'
              tags:
                -
                  tag: Interface
                  value: '{#NAME}'
                -
                  tag: POE
                -
                  tag: Type
                  value: Status
              trigger_prototypes:
                -
                  uuid: c0a0fe136b29476a883a005dddc2a666
                  expression: 'last(/BA - MIB - Interfaces POE/snmp.interfaces.poe.dstatus[{#SNMPINDEX}])=4 or last(/BA - MIB - Interfaces POE/snmp.interfaces.poe.dstatus[{#SNMPINDEX}])=6'
                  name: 'Interface ({#NAME}: {#ALIAS}) POE Detection Fault'
                  priority: WARNING
                  tags:
                    -
                      tag: Interface
                      value: '{#NAME}'
                    -
                      tag: POE
                    -
                      tag: Type
                      value: Status
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var newData = [];
                  var data = JSON.parse(value);
                  data.forEach(function(item1) {
                      if(item1['{#SNMPINDEX}'].includes('.')) {
                          data.forEach(function(item2) {
                              if(item1['{#SNMPINDEX}'].split('.')[1] == item2['{#SNMPINDEX}']) {
                                  item2['{#SNMPINDEX}'] = item1['{#SNMPINDEX}'];
                                  newData.push(item2);
                              }
                          });
                      }
                  });
                  return JSON.stringify(newData);
      tags:
        -
          tag: Type
          value: MIB
      valuemaps:
        -
          uuid: 850c51d7192742ab927fcdf43d7ae8a4
          name: 'POE Admin'
          mappings:
            -
              value: '1'
              newvalue: Enabled
            -
              value: '2'
              newvalue: Disabled
        -
          uuid: ef4f68d4621c45b29c33579af98ad7d3
          name: 'POE Status'
          mappings:
            -
              value: '1'
              newvalue: Disabled
            -
              value: '2'
              newvalue: Searching
            -
              value: 3`
              newvalue: 'Delivering Power'
            -
              value: '4'
              newvalue: Fault
            -
              value: '5'
              newvalue: Test
            -
              value: '6'
              newvalue: 'Other Fault'
    -
      uuid: a882acc6990047b492315f6d10e851ee
      template: 'BA - MIB - Interfaces VLAN'
      name: 'BA - MIB - Interfaces VLAN (RFC1213 & IF & Q-BRIDGE)'
      groups:
        -
          name: BA/MIBs
      discovery_rules:
        -
          uuid: 9b3f3fcece214eea9a16084fa0039e13
          name: 'Interfaces Discovery VLAN'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#VLAN}, .1.3.6.1.2.1.17.7.1.4.5.1.1, {#NAME}, .1.3.6.1.2.1.31.1.1.1.1, {#ALIAS}, .1.3.6.1.2.1.31.1.1.1.18, {#ASTATUS}, .1.3.6.1.2.1.2.2.1.7]'
          key: snmp.interfaces.vlan.discovery
          delay: 6h
          filter:
            conditions:
              -
                macro: '{#VLAN}'
                operator: EXISTS
                formulaid: D
              -
                macro: '{#ASTATUS}'
                value: '2'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              -
                macro: '{#ALIAS}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: A
              -
                macro: '{#NAME}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: C
          lifetime: 1d
          item_prototypes:
            -
              uuid: dec676c9f63b4fe4804f11bc396bf9d5
              name: 'Interface ({#NAME}: {#ALIAS}) VLAN PVID'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.17.7.1.4.5.1.1.{#SNMPINDEX}'
              key: 'snmp.interfaces.vlan.pvid[{#SNMPINDEX}]'
              delay: 1h
              history: 7d
              tags:
                -
                  tag: Interface
                  value: '{#NAME}'
                -
                  tag: Type
                  value: PVID
                -
                  tag: VLAN
      tags:
        -
          tag: Type
          value: MIB
    -
      uuid: e062d321550c42d9bdce4b4c23a365e3
      template: 'BA - MIB - MAC to IP - IP'
      name: 'BA - MIB - MAC to IP (IP)'
      groups:
        -
          name: BA/MIBs
      items:
        -
          uuid: 6f39fc0fe41f4d91ac1f0eb612fc88c4
          name: 'MAC to IP Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#MAC}, .1.3.6.1.2.1.4.35.1.4]'
          key: m2i.discovery.json
          delay: 15m
          history: 1h
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value);
                  data.forEach(function(record, r_index) {
                      var snmp_index = record['{#SNMPINDEX}'];
                      var raw_mac = record['{#MAC}'];
                      var index_parts = snmp_index.split('.');
                      raw_mac = raw_mac.substr(0, 17);
                      raw_mac = raw_mac.replace(/ /g, ':');
                      var newAddrParts = [];
                      var addr = raw_mac.toLowerCase();
                      var addrParts = addr.split(':');
                      addrParts.forEach(function(v) {
                          if (v.length == 1) v = '0' + v;
                          newAddrParts.push(v);
                      });
                      var mac = newAddrParts.join(':');
                      var ip = '';
                      if (index_parts[1] == 1) { //IPV4
                          ip = index_parts.slice(3, 7).join('.');
                      }
                      if (index_parts[1] == 2) { //IPV6
                          var ip_part = '';
                          var ip_parts = index_parts.slice(3);
                          var compressed = false;
                          var compressing = false;
                          ip_parts.forEach(function(part, p_index) {
                              var ip_byte = Number.parseInt(part).toString(16);
                              if (ip_byte.length == 1) ip_byte = '0' + ip_byte;
                              ip_part += ip_byte;
                              if (ip_part.length == 4) {
                                  ip_part = ip_part.replace(/^0000|^000|^00|^0/, '');
                                  if (!compressed && ip_part == '') {
                                      compressing = true;
                                  }
                                  if (!compressing && ip_part == '') ip_part = '0';
                                  if (compressed || ip_part !== '') {
                                      if (!compressed && compressing) {
                                          ip += ':';
                                          compressed = true;
                                          compressing = false;
                                      }
                                      if (p_index !== 1) ip_part = ':' + ip_part;
                                      ip += ip_part;
                                  }
                                  ip_part = '';
                              } 
                          });
                      }
                      data[r_index]['{#IP}'] = ip;
                      data[r_index]['{#MAC}'] = mac;
                  });
                  return JSON.stringify(data);
          tags:
            -
              tag: 'MAC to IP'
            -
              tag: Type
              value: Discovery
      discovery_rules:
        -
          uuid: 517f02751b524658a4c505ad3996b7a6
          name: 'MAC to IP Discovery'
          type: DEPENDENT
          key: m2i.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#MAC}'
                value: ^$
                operator: NOT_MATCHES_REGEX
                formulaid: A
              -
                macro: '{#MAC}'
                value: '^ff:ff:ff:ff:ff:ff$'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              -
                macro: '{#MAC}'
                value: '^00:00:00:00:00:00$'
                operator: NOT_MATCHES_REGEX
                formulaid: C
          item_prototypes:
            -
              uuid: 8f42984ce1a84b209699e231ba07a9de
              name: 'MAC: {#MAC}, IP: {#IP}'
              type: DEPENDENT
              key: 'm2i.status[{#MAC}:{#IP}]'
              delay: '0'
              history: 7d
              trends: 30d
              valuemap:
                name: 'MAC to IP State'
              preprocessing:
                -
                  type: MATCHES_REGEX
                  parameters:
                    - '{.SNMPINDEX}":"{#SNMPINDEX}","{.MAC}":"{#MAC}"'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                -
                  type: JAVASCRIPT
                  parameters:
                    - |
                      if (value == 0) return value;
                      return 1;
              master_item:
                key: m2i.discovery.json
              tags:
                -
                  tag: IP
                  value: '{#IP}'
                -
                  tag: MAC
                  value: '{#MAC}'
                -
                  tag: 'MAC to IP'
                -
                  tag: Type
                  value: Status
          master_item:
            key: m2i.discovery.json
      tags:
        -
          tag: Type
          value: MIB
      valuemaps:
        -
          uuid: 1364b8e394e74294a3c6107eef28d797
          name: 'MAC to IP State'
          mappings:
            -
              value: '0'
              newvalue: Stale
            -
              value: '1'
              newvalue: Active
    -
      uuid: 81e18df8f00146508669b18575a0d3f6
      template: 'BA - MIB - MAC to IP - RFC1213'
      name: 'BA - MIB - MAC to IP (RFC1213)'
      groups:
        -
          name: BA/MIBs
      items:
        -
          uuid: 06a95ceb13e54dbfa69a010d0f34ac37
          name: 'MAC to IP Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#MAC}, .1.3.6.1.2.1.4.22.1.2, {#IP}, .1.3.6.1.2.1.4.22.1.3]'
          key: m2i.discovery.json
          delay: 15m
          history: 1h
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value);
                  data.forEach(function(v, k) {
                      var newAddrParts = [];
                      var addr = v['{#MAC}'].substring(0, 17).replace(/\s/g, ':').toLowerCase();
                      var addrParts = addr.split(':');
                      addrParts.forEach(function(v) {
                          if (v.length == 1) v = '0' + v;
                          newAddrParts.push(v);
                      });
                      data[k]['{#MAC}'] = newAddrParts.join(':');
                  });
                  return JSON.stringify(data);
          tags:
            -
              tag: 'MAC to IP'
            -
              tag: Type
              value: Discovery
      discovery_rules:
        -
          uuid: e61723274ec84ee2b405252948f3ded2
          name: 'MAC to IP Discovery'
          type: DEPENDENT
          key: m2i.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#MAC}'
                value: ^$
                operator: NOT_MATCHES_REGEX
                formulaid: A
              -
                macro: '{#MAC}'
                value: '^ff:ff:ff:ff:ff:ff$'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              -
                macro: '{#MAC}'
                value: '^00:00:00:00:00:00$'
                operator: NOT_MATCHES_REGEX
                formulaid: C
          item_prototypes:
            -
              uuid: e1412500b2fe46dcaf99788b070e295d
              name: 'MAC: {#MAC}, IP: {#IP}'
              type: DEPENDENT
              key: 'm2i.status[{#MAC}:{#IP}]'
              delay: '0'
              history: 7d
              trends: 30d
              valuemap:
                name: 'MAC to IP Status'
              preprocessing:
                -
                  type: MATCHES_REGEX
                  parameters:
                    - '"{.MAC}":"{#MAC}","{.IP}":"{#IP}"'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                -
                  type: JAVASCRIPT
                  parameters:
                    - |
                      if (value == 0) return value;
                      return 1;
              master_item:
                key: m2i.discovery.json
              tags:
                -
                  tag: IP
                  value: '{#IP}'
                -
                  tag: MAC
                  value: '{#MAC}'
                -
                  tag: 'MAC to IP'
                -
                  tag: Type
                  value: Status
          master_item:
            key: m2i.discovery.json
      tags:
        -
          tag: Type
          value: MIB
      valuemaps:
        -
          uuid: 2d9af5c47ed84c44aa09dc5133cb1002
          name: 'MAC to IP Status'
          mappings:
            -
              value: '0'
              newvalue: Stale
            -
              value: '1'
              newvalue: Active
    -
      uuid: ad0d2cf3f7e84ff09f74ec148818c46d
      template: 'BA - MIB - MikroTik'
      name: 'BA - MIB - MikroTik (MIKROTIK)'
      groups:
        -
          name: BA/MIBs
      items:
        -
          uuid: dcdf53f894a043bf83bef95f341c33c8
          name: 'RouterOS Board Name'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.14988.1.1.7.8.0
          key: ros.boardname
          delay: 12h
          history: 30d
          trends: '0'
          value_type: CHAR
          inventory_link: MODEL
          tags:
            -
              tag: RouterOS
            -
              tag: Type
              value: Model
        -
          uuid: 2422b180ee304cadb7b3848987545857
          name: 'CPU Frequency'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.14988.1.1.3.14.0
          key: ros.cpufreq
          history: 7d
          units: Hz
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '1000000'
          tags:
            -
              tag: CPU
            -
              tag: Type
              value: Frequency
        -
          uuid: 7d2ce0e43616493cbf1106fbe2a5063f
          name: 'RouterOS Serial'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.14988.1.1.7.3.0
          key: ros.serial
          delay: 12h
          trends: '0'
          value_type: CHAR
          inventory_link: SERIALNO_A
          tags:
            -
              tag: RouterOS
            -
              tag: Type
              value: Serial
        -
          uuid: d98aae57d9454c6a8836fab035873f83
          name: 'RouterOS Version'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.14988.1.1.7.4.0
          key: ros.version
          delay: 6h
          history: 30d
          trends: '0'
          value_type: CHAR
          inventory_link: OS
          tags:
            -
              tag: RouterOS
            -
              tag: Type
              value: Version
      discovery_rules:
        -
          uuid: a218d20f379642fd83b0472df43663e8
          name: 'ROS Gauge'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#NAME}, .1.3.6.1.4.1.14988.1.1.3.100.1.2, {#UNIT}, .1.3.6.1.4.1.14988.1.1.3.100.1.4]'
          key: ros.gauge.discovery
          delay: 12h
          item_prototypes:
            -
              uuid: efd1a5d94ceb4b098f839bb24c403889
              name: 'Gauge ({#NAME}) {#UNIT}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.14988.1.1.3.100.1.3.{#SNMPINDEX}'
              key: 'ros.gauge.value[{#SNMPINDEX}]'
              delay: 5m
              history: 7d
              value_type: FLOAT
              units: '{#UNIT}'
              preprocessing:
                -
                  type: JAVASCRIPT
                  parameters:
                    - |
                      if ('{#UNIT}' == 'Volts') return value / 10;
                      return value;
              tags:
                -
                  tag: Gauge
                  value: '{#NAME}'
                -
                  tag: Type
                  value: '{#UNIT}'
              trigger_prototypes:
                -
                  uuid: 8bbeacb4fa7b429aa0cc8c0e917c0991
                  expression: 'last(/BA - MIB - MikroTik/ros.gauge.value[{#SNMPINDEX}])>={$TEMP_C_WARN}'
                  name: 'Gauge ({#NAME}) {#UNIT} Temperature >= {$TEMP_C_WARN}C'
                  priority: AVERAGE
                  tags:
                    -
                      tag: Guage
                      value: '{#NAME}'
                    -
                      tag: Type
                      value: '{#UNIT}'
          graph_prototypes:
            -
              uuid: b15abde9dac841bca795548194e9345e
              name: 'Gauge ({#NAME}) {#UNIT}'
              graph_items:
                -
                  drawtype: GRADIENT_LINE
                  color: EF6C00
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - MikroTik'
                    key: 'ros.gauge.value[{#SNMPINDEX}]'
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value);
                  data.forEach(function(v, k) {
                      if (data[k]['{#UNIT}'] == 1) { data[k]['{#UNIT}'] = 'Celsius'; }
                      if (data[k]['{#UNIT}'] == 2) { data[k]['{#UNIT}'] = 'RPM'; }
                      if (data[k]['{#UNIT}'] == 3) { data[k]['{#UNIT}'] = 'Volts'; }
                      if (data[k]['{#UNIT}'] == 4) { data[k]['{#UNIT}'] = 'Amps'; }
                      if (data[k]['{#UNIT}'] == 5) { data[k]['{#UNIT}'] = 'Watts'; }
                      if (data[k]['{#UNIT}'] == 6) { data[k]['{#UNIT}'] = 'Status'; }
                  });
                  return JSON.stringify(data);
          overrides:
            -
              name: CPU
              step: '1'
              operations:
                -
                  operationobject: ITEM_PROTOTYPE
                  operator: LIKE
                  value: cpu
                  tags:
                    -
                      tag: CPU
            -
              name: 'Not Celsius'
              step: '2'
              filter:
                conditions:
                  -
                    macro: '{#UNIT}'
                    value: Celsius
                    operator: NOT_MATCHES_REGEX
                    formulaid: A
              operations:
                -
                  operationobject: TRIGGER_PROTOTYPE
                  operator: LIKE
                  value: Temperature
                  discover: NO_DISCOVER
      tags:
        -
          tag: Type
          value: MIB
      dashboards:
        -
          uuid: 64178c330b0846e59eebe2be6abb18be
          name: RouterOS
          pages:
            -
              widgets:
                -
                  type: item
                  width: '4'
                  fields:
                    -
                      type: INTEGER
                      name: show
                      value: '2'
                    -
                      type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - MikroTik'
                        key: ros.boardname
                -
                  type: item
                  'y': '4'
                  width: '4'
                  fields:
                    -
                      type: INTEGER
                      name: show
                      value: '2'
                    -
                      type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - MikroTik'
                        key: ros.serial
                -
                  type: item
                  'y': '2'
                  width: '4'
                  fields:
                    -
                      type: INTEGER
                      name: show
                      value: '2'
                    -
                      type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - MikroTik'
                        key: ros.version
                -
                  type: graphprototype
                  'y': '6'
                  width: '24'
                  height: '7'
                  fields:
                    -
                      type: INTEGER
                      name: columns
                      value: '3'
                    -
                      type: INTEGER
                      name: rows
                      value: '2'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        host: 'BA - MIB - MikroTik'
                        name: 'Gauge ({#NAME}) {#UNIT}'
                -
                  type: graph
                  x: '4'
                  width: '20'
                  height: '6'
                  fields:
                    -
                      type: GRAPH
                      name: graphid
                      value:
                        host: 'BA - MIB - MikroTik'
                        name: 'CPU Frequency'
    -
      uuid: dbe9320a85944279b7d9a7a9e887c146
      template: 'BA - MIB - vSphere VMs'
      name: 'BA - MIB - vSphere VMs (VMWARE-VMINFO)'
      groups:
        -
          name: BA/MIBs
      items:
        -
          uuid: 059f8c28dd144f05b792288a14ee9951
          name: 'CPUs Allocated'
          type: CALCULATED
          key: vsphere.cpus.allocated
          delay: 1h
          history: 7d
          params: 'sum(last_foreach(//vsphere.vm.cpus[*]))'
          tags:
            -
              tag: CPU
            -
              tag: Type
              value: Count
        -
          uuid: befdbfd5a25d4e038bc2f53eedab5c98
          name: 'CPU Subscription'
          type: CALCULATED
          key: vsphere.cpus.subscription
          delay: 1h
          history: 7d
          value_type: FLOAT
          units: '%'
          params: last(//vsphere.cpus.allocated)/last(//cpu.count)
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '100'
          tags:
            -
              tag: CPU
            -
              tag: Type
              value: Subscription
          triggers:
            -
              uuid: f9883375c125492abab9ce4181caf353
              expression: 'last(/BA - MIB - vSphere VMs/vsphere.cpus.subscription)>=300'
              name: 'CPU Subscription >= 300%'
              priority: INFO
              dependencies:
                -
                  name: 'CPU Subscription >= 400%'
                  expression: 'last(/BA - MIB - vSphere VMs/vsphere.cpus.subscription)>=400'
                -
                  name: 'CPU Subscription >= 500%'
                  expression: 'last(/BA - MIB - vSphere VMs/vsphere.cpus.subscription)>=500'
              tags:
                -
                  tag: CPU
                -
                  tag: Type
                  value: Usage
            -
              uuid: 885272fd23404a5b9fe53aef2b7de707
              expression: 'last(/BA - MIB - vSphere VMs/vsphere.cpus.subscription)>=400'
              name: 'CPU Subscription >= 400%'
              priority: WARNING
              dependencies:
                -
                  name: 'CPU Subscription >= 500%'
                  expression: 'last(/BA - MIB - vSphere VMs/vsphere.cpus.subscription)>=500'
              tags:
                -
                  tag: CPU
                -
                  tag: Type
                  value: Usage
            -
              uuid: 881639b9a7284eac98a5c31b649b4e6c
              expression: 'last(/BA - MIB - vSphere VMs/vsphere.cpus.subscription)>=500'
              name: 'CPU Subscription >= 500%'
              priority: AVERAGE
              tags:
                -
                  tag: CPU
                -
                  tag: Type
                  value: Usage
        -
          uuid: 55e4078646824cb18348e0194b551123
          name: 'VM Count'
          type: CALCULATED
          key: vsphere.vm.count
          delay: 1h
          history: 7d
          params: 'sum(exists_foreach(//vsphere.vm.state[*]))'
          tags:
            -
              tag: Type
              value: Count
            -
              tag: VM
      discovery_rules:
        -
          uuid: a6fd7567cc30408d9711e1bab1030c56
          name: 'VM Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#NAME}, .1.3.6.1.4.1.6876.2.1.1.2]'
          key: vsphere.vm.discovery
          delay: 1h
          item_prototypes:
            -
              uuid: 07a6e276f6cf485b8febeca4d71c9eaa
              name: 'VM ({#NAME}) CPUs'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.6876.2.1.1.9.{#SNMPINDEX}'
              key: 'vsphere.vm.cpus[{#SNMPINDEX}]'
              delay: 1h
              history: 7d
              tags:
                -
                  tag: CPU
                -
                  tag: Type
                  value: Count
                -
                  tag: VM
                  value: '{#NAME}'
            -
              uuid: 3f58ca558b094184ad0c7022480c2287
              name: 'VM ({#NAME}) Guest OS'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.6876.2.1.1.4.{#SNMPINDEX}'
              key: 'vsphere.vm.guestos[{#SNMPINDEX}]'
              delay: 1h
              history: 365d
              trends: '0'
              value_type: CHAR
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                -
                  tag: Type
                  value: 'Guest OS'
                -
                  tag: VM
                  value: '{#NAME}'
            -
              uuid: bfbddf7840304b6183eda41be9e29098
              name: 'VM ({#NAME}) Guest State'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.6876.2.1.1.8.{#SNMPINDEX}'
              key: 'vsphere.vm.gueststate[{#SNMPINDEX}]'
              delay: 5m
              history: 365d
              trends: '0'
              value_type: CHAR
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                -
                  tag: Type
                  value: State
                -
                  tag: VM
                  value: '{#NAME}'
            -
              uuid: fb84d9e71e484a9f8951ee113847eac0
              name: 'VM ({#NAME}) Memory Size'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.6876.2.1.1.5.{#SNMPINDEX}'
              key: 'vsphere.vm.memsize[{#SNMPINDEX}]'
              delay: 6h
              history: 7d
              units: B
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '1048576'
              tags:
                -
                  tag: Type
                  value: Size
                -
                  tag: VM
                  value: '{#NAME}'
            -
              uuid: bd3e8bd3fd2e4123a7659b62bc4951ed
              name: 'VM ({#NAME}) Power State'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.6876.2.1.1.6.{#SNMPINDEX}'
              key: 'vsphere.vm.state[{#SNMPINDEX}]'
              delay: 5m
              history: 365d
              trends: '0'
              value_type: CHAR
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                -
                  tag: Type
                  value: State
                -
                  tag: VM
                  value: '{#NAME}'
      tags:
        -
          tag: Type
          value: MIB
    -
      uuid: c6bf4572df0a4cc28ced8aed23cec940
      template: 'BA - ONVIF - Avigilon'
      name: 'BA - ONVIF - Avigilon'
      groups:
        -
          name: BA/ONVIF
      items:
        -
          uuid: 9c5b4a272bb44a8983ff14bda4c749aa
          name: 'Device Firmware Version'
          type: DEPENDENT
          key: camera.firmware.version
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: OS
          preprocessing:
            -
              type: REGEX
              parameters:
                - 'onvif://www.onvif.org/avigilon/firmware/version/(.*?)"'
                - \1
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.scopes
          tags:
            -
              tag: Type
              value: Firmware
        -
          uuid: 62c9ab8714064b7f91eddae1ca247b10
          name: 'Device Info'
          type: HTTP_AGENT
          key: camera.info
          delay: 1h
          history: 3h
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: XML_TO_JSON
              parameters:
                - ''
          timeout: 30s
          url: '{$ONVIF_SHIM_URL}/{HOST.CONN}'
          query_fields:
            -
              name: user
              value: '{$AVIG_CAM_USERNAME}'
            -
              name: pass
              value: '{$AVIG_CAM_PASSWORD}'
          posts: '<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema"><soap:Body><tds:GetDeviceInformation /></soap:Body></soap:Envelope>'
          request_method: POST
          tags:
            -
              tag: Type
              value: ONVIF
        -
          uuid: a901ebe015ec41578b6f7265970a7efd
          name: 'Device Media'
          type: HTTP_AGENT
          key: camera.media
          delay: 1h
          history: 3h
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: XML_TO_JSON
              parameters:
                - ''
          timeout: 30s
          url: '{$ONVIF_SHIM_URL}/{HOST.CONN}'
          query_fields:
            -
              name: user
              value: '{$AVIG_CAM_USERNAME}'
            -
              name: pass
              value: '{$AVIG_CAM_PASSWORD}'
            -
              name: path
              value: /onvif/media_service
          posts: '<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:trt="http://www.onvif.org/ver10/media/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema"><soap:Body><trt:GetVideoSources /></soap:Body></soap:Envelope>'
          request_method: POST
          tags:
            -
              tag: Type
              value: ONVIF
        -
          uuid: cd309dfaf45646d681098c866f2ac499
          name: 'Device Model'
          type: DEPENDENT
          key: camera.model
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: MODEL
          preprocessing:
            -
              type: REGEX
              parameters:
                - 'onvif://www.onvif.org/hardware/(.*?)"'
                - \1
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.scopes
          tags:
            -
              tag: Type
              value: Model
        -
          uuid: cbb50b55e58e43799b3619025ea4a604
          name: 'Device Name'
          type: DEPENDENT
          key: camera.name
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: NAME
          preprocessing:
            -
              type: REGEX
              parameters:
                - 'onvif://www.onvif.org/name/(.*?)"'
                - \1
            -
              type: STR_REPLACE
              parameters:
                - acc/
                - ''
            -
              type: STR_REPLACE
              parameters:
                - '%20'
                - ' '
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.scopes
          tags:
            -
              tag: Type
              value: Name
        -
          uuid: c569bead71ff46c9990ec6ca6ee6238b
          name: 'Device MAC'
          type: DEPENDENT
          key: camera.net.mac
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: MACADDRESS_A
          preprocessing:
            -
              type: REGEX
              parameters:
                - 'onvif://www.onvif.org/avigilon/mac/(.{17})'
                - \1
            -
              type: STR_REPLACE
              parameters:
                - '-'
                - ':'
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.scopes
          tags:
            -
              tag: Type
              value: MAC
        -
          uuid: 87a53d70753c474bbb21303663af837f
          name: 'Device Scopes'
          type: HTTP_AGENT
          key: camera.scopes
          delay: 15m
          history: 1h
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: XML_TO_JSON
              parameters:
                - ''
          timeout: 30s
          url: '{$ONVIF_SHIM_URL}/{HOST.CONN}'
          query_fields:
            -
              name: user
              value: '{$AVIG_CAM_USERNAME}'
            -
              name: pass
              value: '{$AVIG_CAM_PASSWORD}'
          posts: '<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema"><soap:Body><tds:GetScopes /><tds:GetDeviceInformation /></soap:Body></soap:Envelope>'
          request_method: POST
          tags:
            -
              tag: Type
              value: ONVIF
          triggers:
            -
              uuid: 894908c06a4f42738dd16f954756d551
              expression: 'nodata(/BA - ONVIF - Avigilon/camera.scopes,60m)=1'
              name: 'Could not retrieve device parameters via ONVIF'
              priority: WARNING
              description: 'Please check the password on the device.'
              dependencies:
                -
                  name: 'Device offline'
                  expression: 'last(/BA - Generic - ICMP/icmpping[{HOST.HOST}])=0'
                -
                  name: 'ICMP Loss >= {$ICMP_HIGH_LOSS_WARN}%'
                  expression: 'avg(/BA - Generic - ICMP/icmppingloss[{HOST.HOST},10,50,1000,500],#3)>={$ICMP_HIGH_LOSS_WARN}'
              tags:
                -
                  tag: Type
                  value: ONVIF
        -
          uuid: 3eb186a618c14079a2f8d7bc6f5a3f3f
          name: 'Device Sensor'
          type: DEPENDENT
          key: camera.sensor
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: TYPE
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var result = '';
                  var data = JSON.parse(value);
                  var source = data.Envelope.Body.GetVideoSourcesResponse.VideoSources;
                  if (data.Envelope.Body.GetVideoSourcesResponse.VideoSources[0] != undefined) { 
                      source = data.Envelope.Body.GetVideoSourcesResponse.VideoSources[0]; 
                  }
                  result += source.Resolution.Width;
                  result += 'x';
                  result += source.Resolution.Height;
                  return result;
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.media
          tags:
            -
              tag: Type
              value: Sensor
        -
          uuid: c469663ea4ea4ad69f8b05bfc4b6e2bb
          name: 'Device Serial'
          type: DEPENDENT
          key: camera.serial
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: SERIALNO_A
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $.Envelope.Body.GetDeviceInformationResponse.SerialNumber
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.info
          tags:
            -
              tag: Type
              value: Serial
      tags:
        -
          tag: Type
          value: ONVIF
      dashboards:
        -
          uuid: 520e80c0f687421cb23e6c0f3df2ed13
          name: Avigilon
          pages:
            -
              widgets:
                -
                  type: item
                  x: '4'
                  'y': '2'
                  width: '4'
                  fields:
                    -
                      type: INTEGER
                      name: show
                      value: '2'
                    -
                      type: INTEGER
                      name: adv_conf
                      value: '1'
                    -
                      type: INTEGER
                      name: decimal_size
                      value: '10'
                    -
                      type: INTEGER
                      name: value_bold
                      value: '0'
                    -
                      type: INTEGER
                      name: units_bold
                      value: '0'
                    -
                      type: INTEGER
                      name: value_size
                      value: '30'
                    -
                      type: INTEGER
                      name: units_size
                      value: '10'
                    -
                      type: ITEM
                      name: itemid
                      value:
                        host: 'BA - ONVIF - Avigilon'
                        key: camera.firmware.version
                -
                  type: item
                  'y': '2'
                  width: '4'
                  fields:
                    -
                      type: INTEGER
                      name: show
                      value: '2'
                    -
                      type: INTEGER
                      name: adv_conf
                      value: '1'
                    -
                      type: INTEGER
                      name: decimal_size
                      value: '10'
                    -
                      type: INTEGER
                      name: value_size
                      value: '30'
                    -
                      type: INTEGER
                      name: value_bold
                      value: '0'
                    -
                      type: INTEGER
                      name: units_size
                      value: '10'
                    -
                      type: INTEGER
                      name: units_bold
                      value: '0'
                    -
                      type: ITEM
                      name: itemid
                      value:
                        host: 'BA - ONVIF - Avigilon'
                        key: camera.net.mac
                -
                  type: item
                  width: '12'
                  fields:
                    -
                      type: INTEGER
                      name: show
                      value: '1'
                    -
                      type: INTEGER
                      name: adv_conf
                      value: '1'
                    -
                      type: INTEGER
                      name: decimal_size
                      value: '10'
                    -
                      type: INTEGER
                      name: value_size
                      value: '35'
                    -
                      type: INTEGER
                      name: units_size
                      value: '10'
                    -
                      type: INTEGER
                      name: units_bold
                      value: '0'
                    -
                      type: INTEGER
                      name: show
                      value: '2'
                    -
                      type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    -
                      type: INTEGER
                      name: desc_size
                      value: '30'
                    -
                      type: STRING
                      name: description
                      value: 'Avigilon Camera'
                    -
                      type: ITEM
                      name: itemid
                      value:
                        host: 'BA - ONVIF - Avigilon'
                        key: camera.name
                -
                  type: item
                  x: '8'
                  'y': '2'
                  width: '4'
                  fields:
                    -
                      type: INTEGER
                      name: show
                      value: '2'
                    -
                      type: INTEGER
                      name: adv_conf
                      value: '1'
                    -
                      type: INTEGER
                      name: decimal_size
                      value: '10'
                    -
                      type: INTEGER
                      name: value_size
                      value: '30'
                    -
                      type: INTEGER
                      name: value_bold
                      value: '0'
                    -
                      type: INTEGER
                      name: units_size
                      value: '10'
                    -
                      type: INTEGER
                      name: units_bold
                      value: '0'
                    -
                      type: ITEM
                      name: itemid
                      value:
                        host: 'BA - ONVIF - Avigilon'
                        key: camera.model
                -
                  type: item
                  'y': '4'
                  width: '4'
                  fields:
                    -
                      type: INTEGER
                      name: show
                      value: '2'
                    -
                      type: INTEGER
                      name: adv_conf
                      value: '1'
                    -
                      type: INTEGER
                      name: decimal_size
                      value: '10'
                    -
                      type: INTEGER
                      name: value_size
                      value: '30'
                    -
                      type: INTEGER
                      name: value_bold
                      value: '0'
                    -
                      type: INTEGER
                      name: units_size
                      value: '10'
                    -
                      type: INTEGER
                      name: units_bold
                      value: '0'
                    -
                      type: ITEM
                      name: itemid
                      value:
                        host: 'BA - ONVIF - Avigilon'
                        key: camera.sensor
                -
                  type: item
                  x: '4'
                  'y': '4'
                  width: '4'
                  fields:
                    -
                      type: INTEGER
                      name: show
                      value: '2'
                    -
                      type: INTEGER
                      name: adv_conf
                      value: '1'
                    -
                      type: INTEGER
                      name: decimal_size
                      value: '10'
                    -
                      type: INTEGER
                      name: value_size
                      value: '30'
                    -
                      type: INTEGER
                      name: value_bold
                      value: '0'
                    -
                      type: INTEGER
                      name: units_size
                      value: '10'
                    -
                      type: INTEGER
                      name: units_bold
                      value: '0'
                    -
                      type: ITEM
                      name: itemid
                      value:
                        host: 'BA - ONVIF - Avigilon'
                        key: camera.serial
    -
      uuid: a63b4d7270ab4e44a4618cc7b23e7049
      template: 'BA - Procedure - Update Name'
      name: 'BA - Procedure - Update Name'
      groups:
        -
          name: BA/Procedures
      items:
        -
          uuid: 9bb21d98410441d2b53177ca5f1a34a9
          name: 'Update Visible Name via Inventory'
          type: SCRIPT
          key: update.via.inventory
          delay: 12h
          history: 7d
          trends: '0'
          value_type: TEXT
          params: |
            var params = JSON.parse(value);
            var wr = new HttpRequest();
            wr.addHeader('Content-Type: application/json-rpc');
            var raw_resp = wr.post(params.api, JSON.stringify({
                "jsonrpc": "2.0",
                "method": "host.get",
                "params": {
                    "selectInventory": [ "name" ],
                    "filter": {
                        "host": [ params.host ]
                    }
                },
                "id": 1,
                "auth": params.key
            }));
            var response = JSON.parse(raw_resp);
            var result = wr.post(params.api, JSON.stringify({
                "jsonrpc": "2.0",
                "method": "host.update",
                "params": {
                    "hostid": response.result[0].hostid,
                    "name": response.result[0].inventory.name + ' (' + params.host + ')'
                },
                "id": 1,
                "auth": params.key
            }));
            return result;
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          timeout: 30s
          parameters:
            -
              name: key
              value: '{$ZABSELFKEY}'
            -
              name: api
              value: '{$ZABSELFAPI}'
            -
              name: host
              value: '{HOST.HOST}'
          tags:
            -
              tag: Type
              value: Procedure
          triggers:
            -
              uuid: cf94790245f74d69803a9680c0032f02
              expression: 'find(/BA - Procedure - Update Name/update.via.inventory,,"regexp","^.*Host with the same visible name.*$")=1'
              name: 'Device name not unique'
              priority: INFO
              description: |
                This device name matches another device with a different IP.
                
                Please ensure that the device names are unique.
              tags:
                -
                  tag: Type
                  value: Procedure
      tags:
        -
          tag: Type
          value: Procedure
    -
      uuid: 901df0e8cba24e74890e3e629e965b9a
      template: 'BA - Profile - Aruba CX Switch'
      name: 'BA - Profile - Aruba CX Switch'
      templates:
        -
          name: 'BA - Generic - ICMP'
        -
          name: 'BA - Macro - Generic'
        -
          name: 'BA - Macro - Interfaces'
        -
          name: 'BA - MIB - Entity'
        -
          name: 'BA - MIB - Generic'
        -
          name: 'BA - MIB - Interfaces'
        -
          name: 'BA - MIB - Interfaces MAC'
        -
          name: 'BA - MIB - Interfaces POE'
        -
          name: 'BA - MIB - MAC to IP - IP'
        -
          name: 'BA - Procedure - Update Name'
      groups:
        -
          name: BA/Profiles/Networking
      tags:
        -
          tag: Type
          value: Profile
    -
      uuid: f0572d351d6547c7a33ae487fab360e7
      template: 'BA - Profile - Aruba Switch'
      name: 'BA - Profile - Aruba Switch'
      templates:
        -
          name: 'BA - Generic - ICMP'
        -
          name: 'BA - Macro - Generic'
        -
          name: 'BA - Macro - Interfaces'
        -
          name: 'BA - MIB - Aruba'
        -
          name: 'BA - MIB - Entity'
        -
          name: 'BA - MIB - Generic'
        -
          name: 'BA - MIB - Interfaces'
        -
          name: 'BA - MIB - Interfaces - Aruba'
        -
          name: 'BA - MIB - Interfaces LLDP'
        -
          name: 'BA - MIB - Interfaces MAC'
        -
          name: 'BA - MIB - Interfaces POE'
        -
          name: 'BA - MIB - Interfaces VLAN'
        -
          name: 'BA - MIB - MAC to IP - IP'
        -
          name: 'BA - Procedure - Update Name'
        -
          name: 'BA - SSH - Aruba Config'
      groups:
        -
          name: BA/Profiles/Networking
      tags:
        -
          tag: Type
          value: Profile
    -
      uuid: 32d4adb424bf414683487c8d6414bc72
      template: 'BA - Profile - Avigilon'
      name: 'BA - Profile - Avigilon'
      templates:
        -
          name: 'BA - Generic - ICMP'
        -
          name: 'BA - Macro - Generic'
        -
          name: 'BA - ONVIF - Avigilon'
        -
          name: 'BA - Procedure - Update Name'
      groups:
        -
          name: BA/Profiles/Cameras
      tags:
        -
          tag: Type
          value: Profile
        -
          tag: Type
          value: Surveillance
    -
      uuid: dd62fc36b98043b98668524c168b3787
      template: 'BA - Profile - Axis'
      name: 'BA - Profile - Axis'
      templates:
        -
          name: 'BA - Generic - ICMP'
        -
          name: 'BA - HTTP - Axis'
        -
          name: 'BA - Macro - Generic'
        -
          name: 'BA - Procedure - Update Name'
      groups:
        -
          name: BA/Profiles/Cameras
      tags:
        -
          tag: Type
          value: Profile
        -
          tag: Type
          value: Surveillance
    -
      uuid: c14d11008b524874a40ab65d935d01cf
      template: 'BA - Profile - Cisco IOS Switch'
      name: 'BA - Profile - Cisco IOS Switch'
      templates:
        -
          name: 'BA - Generic - ICMP'
        -
          name: 'BA - Macro - Generic'
        -
          name: 'BA - Macro - Interfaces'
        -
          name: 'BA - MIB - Entity'
        -
          name: 'BA - MIB - Generic'
        -
          name: 'BA - MIB - Interfaces'
        -
          name: 'BA - MIB - MAC to IP - RFC1213'
        -
          name: 'BA - Procedure - Update Name'
      groups:
        -
          name: BA/Profiles/Networking
      tags:
        -
          tag: Type
          value: Profile
    -
      uuid: edfde163545d4f058f26a5ace12614f0
      template: 'BA - Profile - Cisco Small Business Switch'
      name: 'BA - Profile - Cisco Small Business Switch'
      templates:
        -
          name: 'BA - Generic - ICMP'
        -
          name: 'BA - Macro - Generic'
        -
          name: 'BA - Macro - Interfaces'
        -
          name: 'BA - MIB - Entity'
        -
          name: 'BA - MIB - Generic'
        -
          name: 'BA - MIB - Interfaces'
        -
          name: 'BA - MIB - Interfaces LLDP'
        -
          name: 'BA - MIB - Interfaces MAC'
        -
          name: 'BA - MIB - Interfaces POE'
        -
          name: 'BA - MIB - Interfaces VLAN'
        -
          name: 'BA - MIB - MAC to IP - IP'
        -
          name: 'BA - Procedure - Update Name'
      groups:
        -
          name: BA/Profiles/Networking
      tags:
        -
          tag: Type
          value: Profile
    -
      uuid: 6e39e8aa1a0848f3b2454a082094ecde
      template: 'BA - Profile - iLO'
      name: 'BA - Profile - iLO'
      templates:
        -
          name: 'BA - Generic - ICMP'
        -
          name: 'BA - Macro - Generic'
        -
          name: 'BA - MIB - Generic'
        -
          name: 'BA - MIB - iLO'
        -
          name: 'BA - Procedure - Update Name'
      groups:
        -
          name: BA/Profiles/Servers
      tags:
        -
          tag: Type
          value: Profile
        -
          tag: Type
          value: Servers
    -
      uuid: cfc4c512c2c4421599b4703ddae48352
      template: 'BA - Profile - Linux'
      name: 'BA - Profile - Linux'
      templates:
        -
          name: 'BA - Generic - ICMP'
        -
          name: 'BA - Macro - Generic'
        -
          name: 'BA - Macro - Interfaces'
        -
          name: 'BA - MIB - Generic'
        -
          name: 'BA - MIB - Host Resources'
        -
          name: 'BA - MIB - Interfaces'
        -
          name: 'BA - Procedure - Update Name'
      groups:
        -
          name: BA/Profiles/Servers
      tags:
        -
          tag: Type
          value: Profile
        -
          tag: Type
          value: Servers
    -
      uuid: 2d6c963fca534c2eb56112e107ab2e9c
      template: 'BA - Profile - MikroTik'
      name: 'BA - Profile - MikroTik'
      templates:
        -
          name: 'BA - Generic - ICMP'
        -
          name: 'BA - Macro - Generic'
        -
          name: 'BA - Macro - Interfaces'
        -
          name: 'BA - MIB - Entity'
        -
          name: 'BA - MIB - Generic'
        -
          name: 'BA - MIB - Host Resources'
        -
          name: 'BA - MIB - Interfaces'
        -
          name: 'BA - MIB - Interfaces LLDP'
        -
          name: 'BA - MIB - MAC to IP - RFC1213'
        -
          name: 'BA - MIB - MikroTik'
        -
          name: 'BA - Procedure - Update Name'
        -
          name: 'BA - SSH - MikroTik Config'
      groups:
        -
          name: BA/Profiles/Networking
      tags:
        -
          tag: Type
          value: Profile
    -
      uuid: c3286d6562bd4c1bad679f800b371f9f
      template: 'BA - Profile - pfSense'
      name: 'BA - Profile - pfSense'
      templates:
        -
          name: 'BA - Generic - ICMP'
        -
          name: 'BA - Macro - Generic'
        -
          name: 'BA - Macro - Interfaces'
        -
          name: 'BA - MIB - Generic'
        -
          name: 'BA - MIB - Interfaces'
        -
          name: 'BA - MIB - MAC to IP - RFC1213'
        -
          name: 'BA - Procedure - Update Name'
      groups:
        -
          name: BA/Profiles/Networking
      tags:
        -
          tag: Type
          value: Profile
    -
      uuid: 59825d81f28447858af5e9f1425cb800
      template: 'BA - Profile - Ruckus'
      name: 'BA - Profile - Ruckus'
      templates:
        -
          name: 'BA - Generic - ICMP'
        -
          name: 'BA - Macro - Generic'
        -
          name: 'BA - Macro - Interfaces'
        -
          name: 'BA - MIB - Generic'
        -
          name: 'BA - MIB - Interfaces'
        -
          name: 'BA - Procedure - Update Name'
      groups:
        -
          name: BA/Profiles
      tags:
        -
          tag: Type
          value: Profile
    -
      uuid: 00258b13162c4a3d9283a479b1a10f80
      template: 'BA - Profile - vSphere'
      name: 'BA - Profile - vSphere'
      templates:
        -
          name: 'BA - Generic - ICMP'
        -
          name: 'BA - Macro - Generic'
        -
          name: 'BA - Macro - Interfaces'
        -
          name: 'BA - MIB - Entity'
        -
          name: 'BA - MIB - Generic'
        -
          name: 'BA - MIB - Host Resources'
        -
          name: 'BA - MIB - Interfaces'
        -
          name: 'BA - MIB - vSphere VMs'
        -
          name: 'BA - Procedure - Update Name'
      groups:
        -
          name: BA/Profiles/Servers
      tags:
        -
          tag: Type
          value: Profile
        -
          tag: Type
          value: Servers
    -
      uuid: 22526bb9690840debbaa02fd6f35d5b0
      template: 'BA - Profile - Windows'
      name: 'BA - Profile - Windows'
      templates:
        -
          name: 'BA - Generic - ICMP'
        -
          name: 'BA - Macro - Generic'
        -
          name: 'BA - Macro - Interfaces'
        -
          name: 'BA - MIB - Generic'
        -
          name: 'BA - MIB - Host Resources'
        -
          name: 'BA - MIB - Interfaces'
        -
          name: 'BA - MIB - MAC to IP - RFC1213'
        -
          name: 'BA - Procedure - Update Name'
      groups:
        -
          name: BA/Profiles/Servers
      tags:
        -
          tag: Type
          value: Profile
        -
          tag: Type
          value: Servers
    -
      uuid: ed7b2d0bb3bc487f85dd64fe636c783e
      template: 'BA - SSH - Aruba Config'
      name: 'BA - SSH - Aruba Config'
      groups:
        -
          name: BA/SSH
      items:
        -
          uuid: 4cdfa361733045b8820676671cb01643
          name: 'Aruba Config'
          type: HTTP_AGENT
          key: ssh.config
          delay: 6h
          trends: '0'
          value_type: TEXT
          inventory_link: SOFTWARE_FULL
          preprocessing:
            -
              type: REGEX
              parameters:
                - '[\s\S]*Running configuration:\R\R([\s\S]*)\R\R'
                - \1
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          timeout: 10s
          url: '{$SSH_SHIM_URL}'
          posts: |
            hostname={HOST.HOST}&username={$ARUBA_SSH_USER}&password={$ARUBA_SSH_PASS}&commands=
            no page
            show run
            @@@
            {"Expect":"@@@"}
          request_method: POST
          tags:
            -
              tag: Config
          triggers:
            -
              uuid: 2fe56d78b3254bbb9535028f50f83ca9
              expression: 'nodata(/BA - SSH - Aruba Config/ssh.config,3d)=1'
              name: 'Could not retrieve configuration via SSH'
              priority: WARNING
              description: 'Check that the SSH user can login to back the configuration up.'
              dependencies:
                -
                  name: 'Device offline'
                  expression: 'last(/BA - Generic - ICMP/icmpping[{HOST.HOST}])=0'
              tags:
                -
                  tag: Config
      tags:
        -
          tag: Type
          value: SSH
    -
      uuid: ccb9478d71394cbf9ca818e33e887c22
      template: 'BA - SSH - MikroTik Config'
      name: 'BA - SSH - MikroTik Config'
      groups:
        -
          name: BA/SSH
      items:
        -
          uuid: 017e9deb230d40bd81450232f827b526
          name: 'RouterOS Config'
          type: SSH
          key: 'ssh.run[export]'
          delay: 1d
          trends: '0'
          value_type: TEXT
          params: 'export show-sensitive'
          username: '{$ROS_SSH_USER}'
          password: '{$ROS_SSH_PASS}'
          inventory_link: SOFTWARE_FULL
          tags:
            -
              tag: Config
      tags:
        -
          tag: Type
          value: SSH
  triggers:
    -
      uuid: 0cb2f24a7f724fad988e17ed41f374ee
      expression: 'last(/BA - MIB - Aruba/snmp.aruba.config.sha.startup)<>last(/BA - MIB - Aruba/snmp.aruba.config.sha.running)'
      name: 'Configuration not saved'
      priority: WARNING
      description: 'The startup config does not match the running config. Please save the running config to flash.'
      tags:
        -
          tag: Type
          value: SHA
  graphs:
    -
      uuid: 12e77545f5a8427892619e4f55fc37e0
      name: CPU
      graph_items:
        -
          color: BF00FF
          calc_fnc: ALL
          item:
            host: 'BA - MIB - Host Resources'
            key: cpu.count
        -
          sortorder: '1'
          drawtype: GRADIENT_LINE
          color: 0288D1
          yaxisside: RIGHT
          calc_fnc: ALL
          item:
            host: 'BA - MIB - Host Resources'
            key: cpu.usage
    -
      uuid: 621c306af3f44412a3e0a9d1988d6a3c
      name: 'CPU Frequency'
      graph_items:
        -
          drawtype: GRADIENT_LINE
          color: 1976D2
          calc_fnc: ALL
          item:
            host: 'BA - MIB - MikroTik'
            key: ros.cpufreq
    -
      uuid: 9cdb0e17c038481daca833f565fc1536
      name: 'CPU Usage'
      graph_items:
        -
          drawtype: GRADIENT_LINE
          color: 199C0D
          calc_fnc: ALL
          item:
            host: 'BA - MIB - Aruba'
            key: cpu.usage
    -
      uuid: 4c4d6eca42594740977ac9df1727d1bd
      name: 'ICMP Statistics'
      graph_items:
        -
          color: 1A7C11
          calc_fnc: ALL
          item:
            host: 'BA - Generic - ICMP'
            key: 'icmppingsec[{HOST.HOST}]'
        -
          sortorder: '1'
          color: F63100
          yaxisside: RIGHT
          calc_fnc: ALL
          item:
            host: 'BA - Generic - ICMP'
            key: 'icmppingloss[{HOST.HOST},10,50,1000,500]'
    -
      uuid: 20263e09ac454893b1c06d8167076df2
      name: 'Memory Usage'
      graph_items:
        -
          drawtype: GRADIENT_LINE
          color: 00FFFF
          calc_fnc: ALL
          item:
            host: 'BA - MIB - Aruba'
            key: memory.usage
        -
          sortorder: '1'
          color: FF8000
          yaxisside: RIGHT
          calc_fnc: ALL
          item:
            host: 'BA - MIB - Aruba'
            key: memory.used

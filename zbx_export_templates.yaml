zabbix_export:
  version: '6.4'
  template_groups:
    - uuid: 2d74333e7c9d46ee9fd27559f11a7d0e
      name: BA/Generic
    - uuid: 8fdb1680986b48c781ac1ea2a485a917
      name: BA/HTTP
    - uuid: ca9da747aeb34dbcbaacd78655243f3e
      name: BA/Macros
    - uuid: 3fdb37c563464c49b24b75703e0038ed
      name: BA/MIBs
    - uuid: 709a337c872146989712a383cb393fa8
      name: BA/ONVIF
    - uuid: d323af8072864defab6d6e380742fb4d
      name: BA/Procedures
    - uuid: b384f4b048b0408a9adfeae61f5574ae
      name: BA/Profiles
    - uuid: 83b7b6180c974b1680cca7fa1fbac757
      name: BA/Profiles/Cameras
    - uuid: a9ae9cbb57864537879e36c074d112ca
      name: BA/Profiles/Networking
    - uuid: 2128cf518279432187a98490d555a270
      name: BA/Profiles/Servers
    - uuid: 08afccc1647440e2bdf5025bd5f4b3e0
      name: BA/SSH
  templates:
    - uuid: 1096884d9c9340b095f2b3473a20a7f5
      template: 'BA - Generic - ICMP'
      name: 'BA - Generic - ICMP'
      groups:
        - name: BA/Generic
      items:
        - uuid: 925ec895069249bca0ec0472a970d21a
          name: 'ICMP Loss'
          type: SIMPLE
          key: 'icmppingloss[{HOST.HOST},10,50,1000,500]'
          history: 7d
          value_type: FLOAT
          units: '%'
          tags:
            - tag: ICMP
            - tag: Type
              value: Loss
          triggers:
            - uuid: 7e3ebb73a3e4415a8f69c2ddb2d40edb
              expression: 'avg(/BA - Generic - ICMP/icmppingloss[{HOST.HOST},10,50,1000,500],#3)>={$ICMP_HIGH_LOSS_WARN}'
              name: 'ICMP Loss >= {$ICMP_HIGH_LOSS_WARN}%'
              priority: WARNING
              dependencies:
                - name: 'Device offline'
                  expression: 'last(/BA - Generic - ICMP/icmpping[{HOST.HOST}])=0'
              tags:
                - tag: ICMP
        - uuid: 8b397b5e4de74806b3d4814da8ca7497
          name: 'ICMP Latency'
          type: SIMPLE
          key: 'icmppingsec[{HOST.HOST}]'
          history: 7d
          value_type: FLOAT
          units: ms
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1000'
          tags:
            - tag: ICMP
            - tag: Type
              value: Latency
          triggers:
            - uuid: 0b6fa791e1cc4993bd779488cc08fe64
              expression: 'avg(/BA - Generic - ICMP/icmppingsec[{HOST.HOST}],#3)>={$ICMP_HIGH_LATENCY_WARN}'
              name: 'ICMP Latency >= {$ICMP_HIGH_LATENCY_WARN}'
              priority: INFO
              dependencies:
                - name: 'Device offline'
                  expression: 'last(/BA - Generic - ICMP/icmpping[{HOST.HOST}])=0'
              tags:
                - tag: ICMP
        - uuid: 157c0a57578f4b6fa626c497c413b7ff
          name: 'ICMP Ping'
          type: SIMPLE
          key: 'icmpping[{HOST.HOST}]'
          delay: 10s
          history: 7d
          valuemap:
            name: 'Ping Status'
          tags:
            - tag: ICMP
            - tag: Type
              value: Status
          triggers:
            - uuid: 77f9ed9ba5d44b938fd34d222cd5c502
              expression: 'last(/BA - Generic - ICMP/icmpping[{HOST.HOST}])=0'
              name: 'Device offline'
              priority: HIGH
              tags:
                - tag: ICMP
      tags:
        - tag: Type
          value: Generic
      dashboards:
        - uuid: fd7f3696289d4db0a96b6e8a9b22bd76
          name: 'ICMP Statistics'
          pages:
            - widgets:
                - type: item
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - Generic - ICMP'
                        key: 'icmpping[{HOST.HOST}]'
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: show
                      value: '3'
                    - type: INTEGER
                      name: time_v_pos
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                    - type: INTEGER
                      name: value_v_pos
                      value: '0'
                - type: clock
                  'y': '2'
                  width: '4'
                  height: '5'
                - type: graph
                  x: '4'
                  width: '20'
                  height: '7'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'BA - Generic - ICMP'
                        name: 'ICMP Statistics'
      valuemaps:
        - uuid: 4e0b1b29cccb413ea3dbe1730a188450
          name: 'Ping Status'
          mappings:
            - value: '0'
              newvalue: Down
            - value: '1'
              newvalue: Up
    - uuid: f4d0ecadd0e647d3bf034ea2af2cf2b9
      template: 'BA - HTTP - Axis'
      name: 'BA - HTTP - Axis'
      groups:
        - name: BA/HTTP
      items:
        - uuid: d2a61ecc1d0f40c2b51e92acc2321e0d
          name: 'Device Firmware Version'
          type: DEPENDENT
          key: camera.firmware.version
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: OS
          preprocessing:
            - type: REGEX
              parameters:
                - 'root.Properties.Firmware.Version="(.*)"'
                - \1
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.parameters
          tags:
            - tag: Type
              value: Firmware
        - uuid: b55cd1f3182b449c95525eaf00cac1c8
          name: 'Device Model'
          type: DEPENDENT
          key: camera.model
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: MODEL
          preprocessing:
            - type: REGEX
              parameters:
                - 'root.Brand.ProdNbr="(.*)"'
                - \1
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.parameters
          tags:
            - tag: Type
              value: Model
        - uuid: d9a3aac2a16745529f93a65b78f0c274
          name: 'Device Name'
          type: DEPENDENT
          key: camera.name
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: NAME
          preprocessing:
            - type: REGEX
              parameters:
                - 'root.ImageSource.I0.Name="(.*)"'
                - \1
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.parameters
          tags:
            - tag: Type
              value: Name
        - uuid: 95ddd29e014c4505b55c8fb1cd604c0b
          name: 'Device MAC'
          type: DEPENDENT
          key: camera.net.mac
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: MACADDRESS_A
          preprocessing:
            - type: REGEX
              parameters:
                - 'root.Network.eth0.MACAddress="(.*)"'
                - \1
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.parameters
          tags:
            - tag: Type
              value: MAC
        - uuid: ec385938d1354e08876f86565f5d7ccf
          name: 'Device Parameters'
          type: HTTP_AGENT
          key: camera.parameters
          delay: 15m
          history: 1h
          trends: '0'
          value_type: TEXT
          authtype: DIGEST
          username: '{$AXIS_CAM_USERNAME}'
          password: '{$AXIS_CAM_PASSWORD}'
          timeout: 30s
          url: 'http://{HOST.IP}/axis-cgi/admin/paramlist.cgi'
          tags:
            - tag: Type
              value: HTTP
          triggers:
            - uuid: d3e13913f3cc4d7381e6be130c70ca79
              expression: 'nodata(/BA - HTTP - Axis/camera.parameters,60m)=1'
              name: 'Could not retrieve device parameters via HTTP'
              priority: WARNING
              description: 'Please check the password on the device.'
              dependencies:
                - name: 'Device offline'
                  expression: 'last(/BA - Generic - ICMP/icmpping[{HOST.HOST}])=0'
                - name: 'ICMP Loss >= {$ICMP_HIGH_LOSS_WARN}%'
                  expression: 'avg(/BA - Generic - ICMP/icmppingloss[{HOST.HOST},10,50,1000,500],#3)>={$ICMP_HIGH_LOSS_WARN}'
              tags:
                - tag: Type
                  value: HTTP
        - uuid: ab21bc5de5734e6e8aa6f20a243fa019
          name: 'Device Sensor'
          type: DEPENDENT
          key: camera.sensor
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: TYPE
          preprocessing:
            - type: REGEX
              parameters:
                - 'root.Image.I0.Appearance.Resolution="(.*)"'
                - \1
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.parameters
          tags:
            - tag: Type
              value: Sensor
        - uuid: 1e7e44b7fcb34b32abd25100f9748166
          name: 'Device Serial'
          type: DEPENDENT
          key: camera.serial
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: SERIALNO_A
          preprocessing:
            - type: REGEX
              parameters:
                - 'root.Properties.System.SerialNumber="(.*)"'
                - \1
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.parameters
          tags:
            - tag: Type
              value: Serial
      tags:
        - tag: Type
          value: HTTP
    - uuid: 96d88b30329a4c36b6d42b341295e558
      template: 'BA - HTTP - Veeam'
      name: 'BA - HTTP - Veeam'
      groups:
        - name: BA/HTTP
      items:
        - uuid: 9ae4e0df868a44f88026330676fc4974
          name: 'Veeam Jobs Discovery'
          type: SCRIPT
          key: veeam.jobs
          delay: 5m
          history: '0'
          trends: '0'
          value_type: TEXT
          params: |
            var obj = JSON.parse(value);
            var url = obj.url;
            var api = obj.api;
            var user = "{$VEEAM_USER}";
            var pass = "{$VEEAM_PASS}";
            var request = new HttpRequest();
            request.addHeader("x-api-version: 1.1-rev0");
            request.addHeader("accept: application/json");
            var token = JSON.parse(request.post(url + "oauth2/token", "grant_type=password&username=" + user + "&password=" + pass)).access_token;
            request.addHeader("Authorization: Bearer " + token);
            return request.get(url + api);
          parameters:
            - name: api
              value: v1/jobs/states
            - name: url
              value: 'https://{HOST.HOST}:9419/api/'
          tags:
            - tag: Type
              value: Discovery
            - tag: Veeam
        - uuid: 831492be81dd4b849cd77348b3edd618
          name: 'Veeam Version'
          type: SCRIPT
          key: veeam.version
          delay: 12h
          history: 30d
          trends: '0'
          value_type: TEXT
          params: |
            var obj = JSON.parse(value);
            var url = obj.url;
            var api = obj.api;
            var user = "{$VEEAM_USER}";
            var pass = "{$VEEAM_PASS}";
            var request = new HttpRequest();
            request.addHeader("x-api-version: 1.1-rev0");
            request.addHeader("accept: application/json");
            var token = JSON.parse(request.post(url + "oauth2/token", "grant_type=password&username=" + user + "&password=" + pass)).access_token;
            request.addHeader("Authorization: Bearer " + token);
            return request.get(url + api);
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.buildVersion
          parameters:
            - name: api
              value: v1/serverInfo
            - name: url
              value: 'https://{HOST.HOST}:9419/api/'
          tags:
            - tag: Type
              value: Version
            - tag: Veeam
      discovery_rules:
        - uuid: 5b80dbbc2f564807be78cbc079cdcdd8
          name: 'Veeam Jobs Discovery'
          type: DEPENDENT
          key: veeam.jobs.discovery
          delay: '0'
          item_prototypes:
            - uuid: 1fc5becbc7b345f99d43676d3d62faf1
              name: 'Veeam Job ({#NAME}) Last Result'
              type: DEPENDENT
              key: 'veeam.jobs.lastresult[{#NAME}]'
              delay: '0'
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.data.[?(@.name=="{#NAME}")].lastResult.first()'
              master_item:
                key: veeam.jobs
              tags:
                - tag: Job
                  value: '{#NAME}'
                - tag: Type
                  value: Status
                - tag: Veeam
              trigger_prototypes:
                - uuid: 5737da01e3e34a1ebeb05a2dac82d549
                  expression: 'last(/BA - HTTP - Veeam/veeam.jobs.lastresult[{#NAME}])<>"Success" and last(/BA - HTTP - Veeam/veeam.jobs.lastresult[{#NAME}])<>"None"'
                  name: 'Veeam Job ({#NAME}) Last Result != Success'
                  priority: HIGH
                  description: 'The last run of this job was not successful.'
                  tags:
                    - tag: Job
                      value: '{#NAME}'
                    - tag: Type
                      value: Status
                    - tag: Veeam
            - uuid: 77ef2a4ddcfe4854895283fe5ce21e10
              name: 'Veeam Job ({#NAME}) Last Run'
              type: DEPENDENT
              key: 'veeam.jobs.lastrun[{#NAME}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.data.[?(@.name=="{#NAME}")].lastRun.first()'
              master_item:
                key: veeam.jobs
              tags:
                - tag: Job
                  value: '{#NAME}'
                - tag: Type
                  value: Date
                - tag: Veeam
            - uuid: 827c77eb38914b65b311f3c3c859a390
              name: 'Veeam Job ({#NAME}) Next Run'
              type: DEPENDENT
              key: 'veeam.jobs.nextrun[{#NAME}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.data.[?(@.name=="{#NAME}")].nextRun.first()'
              master_item:
                key: veeam.jobs
              tags:
                - tag: Job
                  value: '{#NAME}'
                - tag: Type
                  value: Date
                - tag: Veeam
            - uuid: feda128672764e18b1a627a0fafb4e73
              name: 'Veeam Job ({#NAME}) Status'
              type: DEPENDENT
              key: 'veeam.jobs.status[{#NAME}]'
              delay: '0'
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.data.[?(@.name=="{#NAME}")].status.first()'
              master_item:
                key: veeam.jobs
              tags:
                - tag: Job
                  value: '{#NAME}'
                - tag: Type
                  value: Status
                - tag: Veeam
            - uuid: 4b20b0db8a4d40928192d18ab673daec
              name: 'Veeam Job ({#NAME}) Type'
              type: DEPENDENT
              key: 'veeam.jobs.type[{#NAME}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.data.[?(@.name=="{#NAME}")].type.first()'
              master_item:
                key: veeam.jobs
              tags:
                - tag: Job
                  value: '{#NAME}'
                - tag: Type
                  value: Type
                - tag: Veeam
            - uuid: 752c067975ca4b639b1becbbcd31a5e8
              name: 'Veeam Job ({#NAME}) Workload'
              type: DEPENDENT
              key: 'veeam.jobs.workload[{#NAME}]'
              delay: '0'
              history: 7d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.data.[?(@.name=="{#NAME}")].workload.first()'
              master_item:
                key: veeam.jobs
              tags:
                - tag: Job
                  value: '{#NAME}'
                - tag: Type
                  value: Type
                - tag: Veeam
          master_item:
            key: veeam.jobs
          lld_macro_paths:
            - lld_macro: '{#NAME}'
              path: $.name
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.data
    - uuid: 02f18dcc823241fe9c718128522f1188
      template: 'BA - Macro - Generic'
      name: 'BA - Macro - Generic'
      groups:
        - name: BA/Macros
      tags:
        - tag: Type
          value: Macro
      macros:
        - macro: '{$CPU_HIGH_AVG_TIME_WARN}'
          value: 15m
          description: 'Amount of time the percentage must be over to alert.'
        - macro: '{$CPU_USAGE_WARN}'
          value: '90'
          description: 'Percentage to trigger a CPU usage alert.'
        - macro: '{$DISK_HIGH_AVG_PERC_WARN}'
          value: '95'
          description: 'Disk space usage warn threshold.'
        - macro: '{$ICMP_HIGH_LATENCY_WARN}'
          value: '500'
          description: 'Ping time in MS'
        - macro: '{$ICMP_HIGH_LOSS_WARN}'
          value: '20'
          description: 'Percentage of ICMP loss to warn.'
        - macro: '{$LOOP_PROTECT_TIMER}'
          value: '300'
          description: 'What the loop protect timer should be set too in seconds.'
        - macro: '{$LOOP_PROTECT_TIMER_WARN}'
          value: '1800'
          description: 'Loop protect detect interval. How many seconds since the last loop should trigger an alert?'
        - macro: '{$MEM_USAGE_WARN}'
          value: '95'
          description: 'Percentage to trigger a memory usage alert.'
        - macro: '{$SOFTWARE_VERSION_STRINGS}'
          value: (7\.14)
          description: 'A REGEX list of software strings. Trigger an alert if the software versions do not match this value.'
        - macro: '{$TEMP_C_WARN}'
          value: '75'
          description: 'Temp in Celsius to trigger an alert.'
    - uuid: 2e06dea1d714489c8d284e35778039ce
      template: 'BA - Macro - Interfaces'
      name: 'BA - Macro - Interfaces'
      groups:
        - name: BA/Macros
      tags:
        - tag: Type
          value: Macro
      macros:
        - macro: '{$INTER_ERROR_WARN}'
          value: '1'
          description: 'The count of errors allowed on an interface.'
        - macro: '{$INTER_ERROR_WARN_TIME}'
          value: 6h
          description: 'The timeframe for counting errors.'
        - macro: '{$INTER_FILTER_REGEX}'
          value: '(^tunnel|ppp|loopback|LightWeight|Scheduler|Local Area Connection|Hyper-V|enc0|lo0|pflog0|pfsync0|Logical-int|Nu0|Vl1|veth|lo|docker0$|br|tif|lo|wifi|wlan|eth\d\d?!|dhcp|VLAN|Po|ubond|ath|^<sstp-|^enP)'
          description: 'Filters via Name & Alias'
        - macro: '{$INTER_FLAP_WARN_COUNT}'
          value: '3'
          description: 'The count of flaps allowed on an interface.'
        - macro: '{$INTER_FLAP_WARN_TIME}'
          value: 60m
          description: 'The timeframe for counting interface flaps.'
        - macro: '{$INTER_UPLINK_LIMIT}'
          value: '10'
          description: 'Limit on MACs that can be discovered on an interface.'
        - macro: '{$INTER_UPLINK_MANAGED_EXCLUDE_LLDP_DESC}'
          value: (HP|Aruba|Cisco|ProLiant|Ruckus|ProCurve|4548GT-PWR|MS-2424|MikroTik)
          description: 'An interface LLDP description that contains this regex will automatically be counted as managed.'
        - macro: '{$INTER_UPLINK_THRESHOLD}'
          value: '3'
          description: 'The number of MACs on a port needed to be considered an uplink port.'
        - macro: '{$INTER_USAGE_WARN}'
          value: '90'
          description: 'The usage threshold on an interface in percent.'
    - uuid: 65d533f18b41407cbc7556aca81dd27e
      template: 'BA - MIB - APC'
      name: 'BA - MIB - APC (PowerNet)'
      groups:
        - name: BA/MIBs
      items:
        - uuid: 31b29a6628354795a998732e896b8654
          name: 'Manufacture Date'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.318.1.1.1.1.2.2.0
          key: snmp.apc.age
          delay: 6h
          history: 30d
          trends: '0'
          value_type: CHAR
          inventory_link: DATE_HW_INSTALL
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: Type
              value: Age
        - uuid: d549b5471b8548128aa405835e8c5ddc
          name: 'Battery Charge'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.318.1.1.1.2.2.1.0
          key: snmp.apc.battery.charge
          delay: 5m
          history: 30d
          units: '%'
          tags:
            - tag: Type
              value: Charge
        - uuid: f9a549dec7d84875b115c585c234d5d4
          name: 'Battery Last Replacement Date'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.318.1.1.1.2.1.3.0
          key: snmp.apc.battery.replaced
          delay: 6h
          history: 30d
          trends: '0'
          value_type: CHAR
          description: 'Last time the battery was replaced.'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: Type
              value: Age
        - uuid: 7ab01e7accb34f0d993b187c2f1fa4d3
          name: 'Battery Replacement Status'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.318.1.1.1.2.2.4.0
          key: snmp.apc.battery.replacementstat
          delay: 5m
          history: 30d
          valuemap:
            name: 'Battery Replace Indicator'
          tags:
            - tag: Type
              value: Status
          triggers:
            - uuid: bf6b90a31ea1446a826c79972f9c58cd
              expression: 'last(/BA - MIB - APC/snmp.apc.battery.replacementstat)<>1'
              name: 'Battery Replacement Status not OK'
              priority: AVERAGE
              description: 'The battery in this UPS needs replaced.'
              tags:
                - tag: Type
                  value: Status
        - uuid: 1d613a65a3de4be5b28b9d528844dd48
          name: 'Battery Runtime'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.318.1.1.1.2.2.3.0
          key: snmp.apc.battery.runtime
          delay: 5m
          history: 30d
          units: s
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: Type
              value: Runtime
        - uuid: 785505c01c9548199ca4e141ef1a73b4
          name: 'Battery Status'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.318.1.1.1.2.1.1.0
          key: snmp.apc.battery.status
          delay: 5m
          history: 30d
          valuemap:
            name: 'Battery Status'
          tags:
            - tag: Type
              value: Status
        - uuid: 07d861b545bd46b58d2b76d09f8fd914
          name: 'Battery Temperature'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.318.1.1.1.2.2.2.0
          key: snmp.apc.battery.temperature
          delay: 5m
          history: 30d
          units: C
          tags:
            - tag: Type
              value: Temperature
        - uuid: 5dce911b6f264f6f8dd4906295f7b2f3
          name: Model
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.318.1.1.1.1.1.1.0
          key: snmp.apc.model
          delay: 6h
          history: 30d
          trends: '0'
          value_type: CHAR
          inventory_link: MODEL
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: Type
              value: Model
        - uuid: 1a544eeb51b6425cba2bc57bff6ad459
          name: Serial
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.318.1.1.1.1.2.3.0
          key: snmp.apc.serial
          delay: 6h
          history: 30d
          trends: '0'
          value_type: CHAR
          inventory_link: SERIALNO_A
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: Type
              value: Serial
        - uuid: 53a6d636ce0740f9895d404032755dbe
          name: 'UPS Input Frequency'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.318.1.1.1.3.2.4.0
          key: snmp.apc.ups.inputfreq
          delay: 5m
          history: 30d
          units: Hertz
          tags:
            - tag: Type
              value: Hertz
        - uuid: bc2bbdb6c20b43678dde33349f2c37a0
          name: 'UPS Input Voltage'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.318.1.1.1.3.2.1.0
          key: snmp.apc.ups.inputvoltage
          delay: 5m
          history: 30d
          units: Volts
          tags:
            - tag: Type
              value: Voltage
        - uuid: 64d4fe1b663b493d8157f92c8b6be952
          name: 'UPS Status'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.318.1.1.1.4.1.1.0
          key: snmp.apc.ups.status
          delay: 5m
          history: 30d
          valuemap:
            name: 'UPS Status'
          tags:
            - tag: Type
              value: Status
          triggers:
            - uuid: 186e941c59a949c68602aa70525e3549
              expression: 'last(/BA - MIB - APC/snmp.apc.ups.status)<>2'
              name: 'UPS Status not Online'
              priority: WARNING
              tags:
                - tag: Type
                  value: Status
      discovery_rules:
        - uuid: f42c8b0552674b92813e17b07d391dc7
          name: 'Battery Packs Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#CARTSTATUS}, .1.3.6.1.4.1.318.1.1.1.2.3.10.2.1.10]'
          key: snmp.apc.battery.discovery
          delay: 12h
          filter:
            conditions:
              - macro: '{#CARTSTATUS}'
                value: ^$
                operator: NOT_MATCHES_REGEX
                formulaid: A
          item_prototypes:
            - uuid: 9b5e9a80135d4b4bbb863731ac7fb21f
              name: 'Battery ({#SNMPINDEX}) Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.318.1.1.1.2.3.10.2.1.10.{#SNMPINDEX}'
              key: 'snmp.apc.battery.status[{#SNMPINDEX}]'
              delay: 1h
              history: 30d
              trends: '0'
              value_type: CHAR
              description: |
                The battery cartridge status.
                
                bit 0 Disconnected
                bit 1 Overvoltage
                bit 2 NeedsReplacement
                bit 3 OvertemperatureCritical
                bit 4 Charger
                bit 5 TemperatureSensor
                bit 6 BusSoftStart
                bit 7 OvertemperatureWarning
                bit 8 GeneralError
                bit 9 Communication
                bit 10 DisconnectedFrame
                bit 11 FirmwareMismatch
              tags:
                - tag: Type
                  value: Status
              trigger_prototypes:
                - uuid: 8ee2b3b363194f3b9b53f15b1f298e5b
                  expression: 'find(/BA - MIB - APC/snmp.apc.battery.status[{#SNMPINDEX}],,"regexp" ,"..1.............")=1'
                  name: 'Battery ({#SNMPINDEX}) Replacement Status not OK'
                  priority: AVERAGE
                  tags:
                    - tag: Type
                      value: Status
      tags:
        - tag: Type
          value: MIB
      dashboards:
        - uuid: 05593197f4914bfcb57afafcfbeb88fd
          name: APC
          pages:
            - widgets:
                - type: item
                  width: '8'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - APC'
                        key: snmp.apc.ups.status
                - type: graph
                  'y': '2'
                  width: '24'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'BA - MIB - APC'
                        name: 'Battery Charge'
                - type: graph
                  'y': '7'
                  width: '24'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'BA - MIB - APC'
                        name: 'UPS Input'
                - type: graph
                  'y': '12'
                  width: '24'
                  height: '5'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - APC'
                        key: snmp.apc.battery.temperature
                    - type: INTEGER
                      name: source_type
                      value: '1'
                - type: item
                  x: '8'
                  width: '8'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - APC'
                        key: snmp.apc.model
                    - type: INTEGER
                      name: show
                      value: '2'
                - type: item
                  x: '16'
                  width: '8'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - APC'
                        key: snmp.apc.serial
                    - type: INTEGER
                      name: show
                      value: '2'
      valuemaps:
        - uuid: c906e884cf7549d6b51f73b35ee7ee42
          name: 'Battery Replace Indicator'
          mappings:
            - value: '1'
              newvalue: 'No Battery Needs Replacing'
            - value: '2'
              newvalue: 'Battery Needs Replacing'
        - uuid: e82ea3b33488450e9119caec94008573
          name: 'Battery Status'
          mappings:
            - value: '1'
              newvalue: Unkown
            - value: '2'
              newvalue: 'Battery Normal'
            - value: '3'
              newvalue: 'Battery Low'
        - uuid: 83bdd49e6e674d8d8b1b6b397f461643
          name: 'UPS Status'
          mappings:
            - value: '1'
              newvalue: Unknown
            - value: '2'
              newvalue: Online
            - value: '3'
              newvalue: 'On Battery'
            - value: '4'
              newvalue: 'On Smart Boost'
            - value: '5'
              newvalue: 'Timed Sleeping'
            - value: '6'
              newvalue: 'Software Bypass'
            - value: '7'
              newvalue: 'Off'
            - value: '8'
              newvalue: Rebooting
            - value: '9'
              newvalue: 'Switched Bypass'
            - value: '10'
              newvalue: 'Hardware Failure Bypass'
            - value: '11'
              newvalue: 'Sleeping Unit Power Return'
            - value: '12'
              newvalue: 'On Smart Trim'
    - uuid: 49d106e4ab994d41b8533cccb7a04abf
      template: 'BA - MIB - Aruba OS'
      name: 'BA - MIB - Aruba OS (STATISTICS POWERSUPPLY FAN HP-ICF-CONFIG HP-ICF-BRIDGE)'
      groups:
        - name: BA/MIBs
      items:
        - uuid: d21b1ba6ab874dedad8afac0dabf7328
          name: 'CPU Usage'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.11.2.14.11.5.1.9.6.1.0
          key: cpu.usage
          history: 7d
          units: '%'
          tags:
            - tag: CPU
            - tag: Type
              value: Usage
          triggers:
            - uuid: 6b1079669c50408998310050e7d208b4
              expression: 'avg(/BA - MIB - Aruba OS/cpu.usage,{$CPU_HIGH_AVG_TIME_WARN})>={$CPU_USAGE_WARN}'
              name: 'CPU Usage >= {$CPU_USAGE_WARN}% for {$CPU_HIGH_AVG_TIME_WARN}'
              priority: AVERAGE
              tags:
                - tag: CPU
                - tag: Type
                  value: Usage
        - uuid: 2fa7b638fe4d4da8bef7ff8c58974a88
          name: 'Memory Size'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SIZE}, .1.3.6.1.4.1.11.2.14.11.5.1.1.2.2.1.1.5]'
          key: memory.size
          delay: 1h
          history: 7d
          units: B
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.*.[''{#SIZE}''].sum()'
          tags:
            - tag: Memory
            - tag: Type
              value: Size
        - uuid: 525480a2f9a542f29cbc5a626c8e65bd
          name: 'Memory Usage'
          type: CALCULATED
          key: memory.usage
          history: 7d
          value_type: FLOAT
          units: '%'
          params: last(//memory.used)/last(//memory.size)
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '100'
          tags:
            - tag: Memory
            - tag: Type
              value: Usage
          triggers:
            - uuid: af7039dacfbc4facbe0677c9b402d06e
              expression: 'last(/BA - MIB - Aruba OS/memory.usage)>={$CPU_USAGE_WARN}'
              name: 'Memory Usage >= {$MEM_USAGE_WARN}%'
              priority: AVERAGE
              tags:
                - tag: Memory
                - tag: Type
                  value: Usage
        - uuid: eb706ca0daea468595ef2a0b6ca09275
          name: 'Memory Used'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#FREE}, .1.3.6.1.4.1.11.2.14.11.5.1.1.2.2.1.1.6]'
          key: memory.used
          history: 7d
          units: B
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.*.[''{#FREE}''].sum()'
          tags:
            - tag: Memory
            - tag: Type
              value: Used
        - uuid: 5e4b2dafd1994d47b8604d26a2d75af9
          name: 'Running Config SHA'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.11.2.14.11.5.1.136.4.1.2.0
          key: snmp.aruba.config.sha.running
          delay: 15m
          history: 7d
          trends: '0'
          value_type: CHAR
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: Type
              value: SHA
        - uuid: 9c9386c0f5c04abd99c9b6ebc5cc2508
          name: 'Startup Config SHA'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.11.2.14.11.5.1.136.4.1.3.0
          key: snmp.aruba.config.sha.startup
          delay: 15m
          history: 7d
          trends: '0'
          value_type: CHAR
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: Type
              value: SHA
        - uuid: 3c14903dbe254135bd2c2d29f5c7a650
          name: 'Flash Version'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.11.2.14.11.5.1.59.1.3.1.4.1
          key: snmp.aruba.flash.version
          delay: 1d
          trends: '0'
          value_type: CHAR
          inventory_link: OS_SHORT
          tags:
            - tag: Software
              value: Flash
            - tag: Type
              value: Version
          triggers:
            - uuid: c3fe47015dbf41609e4f6b5fec1af2d1
              expression: 'find(/BA - MIB - Aruba OS/snmp.aruba.flash.version,,"regexp","{$SOFTWARE_VERSION_STRINGS}")=0'
              name: 'Flash version out of date'
              priority: INFO
              description: 'Please update the software on this device.'
              tags:
                - tag: Software
                  value: Flash
                - tag: Type
                  value: Version
        - uuid: 393faa601d5d4bc8bb6c0b3e5f41b39b
          name: 'Loop Protect Status'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#ENABLED}, .1.3.6.1.4.1.11.2.14.11.5.1.12.1.5.2.1.1.1]'
          key: snmp.aruba.loopprotect.status
          delay: 1h
          history: 7d
          description: 'Is loop protect enabled on all ports?'
          valuemap:
            name: Status
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.*.[''{#ENABLED}''].max()'
          tags:
            - tag: Config
              value: 'Loop Protect'
            - tag: Type
              value: Status
          triggers:
            - uuid: ace8b81ed191423eb5c11ef7dcb577c4
              expression: 'last(/BA - MIB - Aruba OS/snmp.aruba.loopprotect.status)=2'
              name: 'Loop Protect disabled'
              priority: INFO
              tags:
                - tag: Config
                  value: 'Loop Protect'
                - tag: Type
                  value: Status
        - uuid: 7d4f92aaf4d24a6d9897fe7a55b4e91b
          name: 'Loop Protect Timer'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.11.2.14.11.5.1.12.1.5.1.3.0
          key: snmp.aruba.loopprotect.timer
          delay: 1h
          history: 7d
          units: seconds
          tags:
            - tag: Config
              value: 'Loop Protect'
            - tag: Type
              value: Seconds
          triggers:
            - uuid: b4e904ee82e5466bbf04d14ae07954ef
              expression: 'last(/BA - MIB - Aruba OS/snmp.aruba.loopprotect.timer)<>{$LOOP_PROTECT_TIMER}'
              name: 'Loop Protect Timer not set to {$LOOP_PROTECT_TIMER}s'
              priority: INFO
              description: 'Loop Protect Timer is not set to {$LOOP_PROTECT_TIMER} seconds.'
              tags:
                - tag: Config
                  value: 'Loop Protect'
                - tag: Type
                  value: Seconds
        - uuid: 98e32926ace9445b9694a8b13559a1a1
          name: 'Spanning Tree Status'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.11.2.14.11.5.1.12.1.4.4.0
          key: snmp.aruba.rstp.status
          delay: 1h
          history: 7d
          description: 'Is rapid spanning tree enabled on the switch?'
          valuemap:
            name: Status
          tags:
            - tag: Config
              value: 'Spanning Tree'
            - tag: Type
              value: Status
          triggers:
            - uuid: c138a27225a84c9a9e7115c542fa80d6
              expression: 'last(/BA - MIB - Aruba OS/snmp.aruba.rstp.status)=1'
              name: 'Spanning Tree enabled'
              priority: INFO
              tags:
                - tag: Config
                  value: 'Spanning Tree'
                - tag: Type
                  value: Status
      discovery_rules:
        - uuid: 02c13eb8b1d14ff4bbf1687ac279c71b
          name: 'Aruba Fan Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#STATE}, .1.3.6.1.4.1.11.2.14.11.5.1.54.2.1.1.4]'
          key: aruba.fan.discovery
          delay: 1h
          item_prototypes:
            - uuid: c1fd1186bed24c198b26b8d2cb0266b9
              name: 'Aruba Fan ({#SNMPINDEX}) Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.11.2.14.11.5.1.54.2.1.1.4.{#SNMPINDEX}'
              key: 'aruba.fan.status[{#SNMPINDEX}]'
              delay: 1h
              history: 7d
              valuemap:
                name: 'Fan Status'
              tags:
                - tag: Fan
                  value: '{#SNMPINDEX}'
                - tag: Type
                  value: Status
              trigger_prototypes:
                - uuid: 2623bf6494cd42fa8bc84c04e93b1291
                  expression: 'last(/BA - MIB - Aruba OS/aruba.fan.status[{#SNMPINDEX}])=0 or last(/BA - MIB - Aruba OS/aruba.fan.status[{#SNMPINDEX}])=1 or last(/BA - MIB - Aruba OS/aruba.fan.status[{#SNMPINDEX}])=3 or last(/BA - MIB - Aruba OS/aruba.fan.status[{#SNMPINDEX}])=4 or last(/BA - MIB - Aruba OS/aruba.fan.status[{#SNMPINDEX}])=6'
                  name: 'Aruba Fan ({#SNMPINDEX}) Status Fault'
                  priority: AVERAGE
                  tags:
                    - tag: Fan
                      value: '{#SNMPINDEX}'
                    - tag: Type
                      value: Status
        - uuid: ebf3d7bbf6bc407493285c95101d29fb
          name: 'Aruba PSU Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#STATUS}, .1.3.6.1.4.1.11.2.14.11.5.1.55.1.1.1.2, {#TEMP}, .1.3.6.1.4.1.11.2.14.11.5.1.55.1.1.1.4]'
          key: aruba.psu.discovery
          delay: 1h
          item_prototypes:
            - uuid: e5c62e89d091416d8f513ad15b5a4458
              name: 'Aruba PSU ({#SNMPINDEX}) Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.11.2.14.11.5.1.55.1.1.1.2.{#SNMPINDEX}'
              key: 'aruba.psu.status[{#SNMPINDEX}]'
              delay: 1h
              history: 7d
              valuemap:
                name: 'PSU Status'
              tags:
                - tag: PSU
                  value: '{#SNMPINDEX}'
                - tag: Type
                  value: Status
              trigger_prototypes:
                - uuid: e061727ff41e4d1da6d54acc47a88027
                  expression: |
                    last(/BA - MIB - Aruba OS/aruba.psu.status[{#SNMPINDEX}])=2 or
                    last(/BA - MIB - Aruba OS/aruba.psu.status[{#SNMPINDEX}])=4 or
                    last(/BA - MIB - Aruba OS/aruba.psu.status[{#SNMPINDEX}])=5 or
                    last(/BA - MIB - Aruba OS/aruba.psu.status[{#SNMPINDEX}])=6
                  name: 'Aruba PSU ({#SNMPINDEX}) Status Fault'
                  priority: AVERAGE
                  tags:
                    - tag: PSU
                      value: '{#SNMPINDEX}'
                    - tag: Type
                      value: Status
            - uuid: 7eb98047105a4bc1a84e4d9230ed9a54
              name: 'Aruba PSU ({#SNMPINDEX}) Temperature'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.11.2.14.11.5.1.55.1.1.1.4.{#SNMPINDEX}'
              key: 'aruba.psu.temp[{#SNMPINDEX}]'
              delay: 30m
              history: 7d
              units: Celsius
              tags:
                - tag: PSU
                  value: '{#SNMPINDEX}'
                - tag: Type
                  value: Celsius
              trigger_prototypes:
                - uuid: a8d0b6bb5c5343a2a130dd8bc39a0f33
                  expression: 'last(/BA - MIB - Aruba OS/aruba.psu.temp[{#SNMPINDEX}])>={$TEMP_C_WARN}'
                  name: 'Aruba PSU ({#SNMPINDEX}) Temperature >= {$TEMP_C_WARN}C'
                  priority: AVERAGE
                  tags:
                    - tag: PSU
                      value: '{#SNMPINDEX}'
                    - tag: Type
                      value: Celsius
          overrides:
            - name: 'No Temp'
              step: '1'
              filter:
                conditions:
                  - macro: '{#TEMP}'
                    value: '0'
                    formulaid: A
                  - macro: '{#TEMP}'
                    value: '254'
                    formulaid: B
              operations:
                - operationobject: ITEM_PROTOTYPE
                  operator: LIKE
                  value: Temperature
                  discover: NO_DISCOVER
                - operationobject: TRIGGER_PROTOTYPE
                  operator: LIKE
                  value: Temperature
                  discover: NO_DISCOVER
      tags:
        - tag: Type
          value: MIB
      dashboards:
        - uuid: 5a74a2692f494cf1ae093a9fc4141824
          name: Aruba
          pages:
            - widgets:
                - type: graph
                  width: '11'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'BA - MIB - Aruba OS'
                        name: 'CPU Usage'
                - type: graph
                  'y': '5'
                  width: '11'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'BA - MIB - Aruba OS'
                        name: 'Memory Usage'
                - type: item
                  x: '11'
                  width: '4'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - Aruba OS'
                        key: snmp.aruba.flash.version
                    - type: INTEGER
                      name: show
                      value: '2'
                - type: item
                  x: '11'
                  'y': '2'
                  width: '4'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - Aruba OS'
                        key: snmp.aruba.rstp.status
                    - type: INTEGER
                      name: show
                      value: '2'
                - type: item
                  x: '11'
                  'y': '4'
                  width: '4'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - Aruba OS'
                        key: snmp.aruba.loopprotect.status
                    - type: INTEGER
                      name: show
                      value: '2'
                - type: item
                  x: '11'
                  'y': '6'
                  width: '4'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - Aruba OS'
                        key: snmp.aruba.loopprotect.timer
                    - type: INTEGER
                      name: show
                      value: '2'
                - type: item
                  x: '15'
                  width: '9'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - Aruba OS'
                        key: snmp.aruba.config.sha.running
                    - type: INTEGER
                      name: show
                      value: '2'
                - type: item
                  x: '15'
                  'y': '2'
                  width: '9'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - Aruba OS'
                        key: snmp.aruba.config.sha.startup
                    - type: INTEGER
                      name: show
                      value: '2'
      valuemaps:
        - uuid: 9b1fc8e853c74f7088adf58aba8ab698
          name: 'Fan Status'
          mappings:
            - value: '0'
              newvalue: Failed
            - value: '1'
              newvalue: Removed
            - value: '2'
              newvalue: 'Off'
            - value: '3'
              newvalue: 'Under Speed'
            - value: '4'
              newvalue: 'Over Speed'
            - value: '5'
              newvalue: OK
            - value: '6'
              newvalue: Maxed
        - uuid: 83f6c58a912942d3b2b28f315efe79f0
          name: 'PSU Status'
          mappings:
            - value: '1'
              newvalue: 'Not Present'
            - value: '2'
              newvalue: 'Not Plugged'
            - value: '3'
              newvalue: Powered
            - value: '4'
              newvalue: Failed
            - value: '5'
              newvalue: 'Permanent Failure'
            - value: '6'
              newvalue: Maxed
        - uuid: 8eb209439d724701966573df46e17da0
          name: Status
          mappings:
            - value: '1'
              newvalue: Enabled
            - value: '2'
              newvalue: Disabled
    - uuid: e5761accf2dd4f6180e536fbc1d19612
      template: 'BA - MIB - Cyber Power'
      name: 'BA - MIB - Cyber Power (CPS)'
      groups:
        - name: BA/MIBs
      items:
        - uuid: 0330598b770a48c8834ca5d8a413905d
          name: 'Battery Charge'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.3808.1.1.1.2.2.1.0
          key: snmp.cps.battery.charge
          delay: 5m
          history: 30d
          units: '%'
          tags:
            - tag: Type
              value: Charge
        - uuid: 05f89524723b42268c9675e966d78330
          name: 'Battery Last Replacement Date'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.3808.1.1.1.2.1.3.0
          key: snmp.cps.battery.replaced
          delay: 6h
          history: 30d
          trends: '0'
          value_type: CHAR
          description: 'Last time the battery was replaced.'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: Type
              value: Age
        - uuid: dd6892088b68483899e2e58a81bd2b72
          name: 'Battery Replacement Status'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.3808.1.1.1.2.2.5.0
          key: snmp.cps.battery.replacementstat
          delay: 5m
          history: 30d
          valuemap:
            name: 'Battery Replace Indicator'
          tags:
            - tag: Type
              value: Status
          triggers:
            - uuid: 51859a6d64964de989b2ee50cdc2de14
              expression: 'last(/BA - MIB - Cyber Power/snmp.cps.battery.replacementstat)<>1'
              name: 'Battery Replacement Status not OK'
              priority: AVERAGE
              description: 'The battery in this UPS needs replaced.'
              tags:
                - tag: Type
                  value: Status
        - uuid: 42ab4ab29fc24a94909bb478dd260058
          name: 'Battery Runtime'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.3808.1.1.1.2.2.4.0
          key: snmp.cps.battery.runtime
          delay: 5m
          history: 30d
          units: s
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: Type
              value: Runtime
        - uuid: 82a0e47ebf8041e7b11c331020a30a26
          name: 'Battery Status'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.3808.1.1.1.2.1.1.0
          key: snmp.cps.battery.status
          delay: 5m
          history: 30d
          valuemap:
            name: 'Battery Status'
          tags:
            - tag: Type
              value: Status
        - uuid: 8de781b3dede4bc3b6366470d3b141a4
          name: 'Battery Temperature'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.3808.1.1.1.2.2.3.0
          key: snmp.cps.battery.temperature
          delay: 5m
          history: 30d
          units: C
          tags:
            - tag: Type
              value: Temperature
        - uuid: 8b9caea167324421a35130dbeb493ef4
          name: Model
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.3808.1.1.1.1.1.1.0
          key: snmp.cps.model
          delay: 6h
          history: 30d
          trends: '0'
          value_type: CHAR
          inventory_link: MODEL
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: Type
              value: Model
        - uuid: c07237c22ccc4366a6ab66f4a556a1b1
          name: Serial
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.3808.1.1.1.1.2.3.0
          key: snmp.cps.serial
          delay: 6h
          history: 30d
          trends: '0'
          value_type: CHAR
          inventory_link: SERIALNO_A
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: Type
              value: Serial
        - uuid: fd0a96096d3645ed9728ecdde84484ee
          name: 'UPS Input Frequency'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.3808.1.1.1.3.2.4.0
          key: snmp.cps.ups.inputfreq
          delay: 5m
          history: 30d
          units: Hertz
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.1'
          tags:
            - tag: Type
              value: Hertz
        - uuid: 940103e8330148a2960fec819cfd2b0a
          name: 'UPS Input Voltage'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.3808.1.1.1.3.2.1.0
          key: snmp.cps.ups.inputvoltage
          delay: 5m
          history: 30d
          units: Volts
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.1'
          tags:
            - tag: Type
              value: Voltage
        - uuid: 48885bf925b7466aaeec73ae70d1dddd
          name: 'UPS Status'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.3808.1.1.1.4.1.1.0
          key: snmp.cps.ups.status
          delay: 5m
          history: 30d
          valuemap:
            name: 'UPS Status'
          tags:
            - tag: Type
              value: Status
          triggers:
            - uuid: aa2be7bb37e14efb931ac865bfb27385
              expression: 'last(/BA - MIB - Cyber Power/snmp.cps.ups.status)<>2'
              name: 'UPS Status not Online'
              priority: WARNING
              tags:
                - tag: Type
                  value: Status
      tags:
        - tag: Type
          value: MIB
      dashboards:
        - uuid: 0b0ad3476602407c83ddac095017661d
          name: APC
          pages:
            - widgets:
                - type: item
                  width: '8'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - Cyber Power'
                        key: snmp.cps.ups.status
                - type: graph
                  'y': '2'
                  width: '24'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'BA - MIB - Cyber Power'
                        name: 'Battery Charge'
                - type: graph
                  'y': '7'
                  width: '24'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'BA - MIB - Cyber Power'
                        name: 'UPS Input'
                - type: graph
                  'y': '12'
                  width: '24'
                  height: '5'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - Cyber Power'
                        key: snmp.cps.battery.temperature
                    - type: INTEGER
                      name: source_type
                      value: '1'
                - type: item
                  x: '8'
                  width: '8'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - Cyber Power'
                        key: snmp.cps.model
                    - type: INTEGER
                      name: show
                      value: '2'
                - type: item
                  x: '16'
                  width: '8'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - Cyber Power'
                        key: snmp.cps.serial
                    - type: INTEGER
                      name: show
                      value: '2'
      valuemaps:
        - uuid: d2ffc6a43eb34045b9d1c2d8b90bef59
          name: 'Battery Replace Indicator'
          mappings:
            - value: '1'
              newvalue: 'No Battery Needs Replacing'
            - value: '2'
              newvalue: 'Battery Needs Replacing'
        - uuid: 9b3c5fea6a9844d0b75e1d302e95bfec
          name: 'Battery Status'
          mappings:
            - value: '1'
              newvalue: Unkown
            - value: '2'
              newvalue: 'Battery Normal'
            - value: '3'
              newvalue: 'Battery Low'
        - uuid: 01175c0c673f4b69a0b5232570fad142
          name: 'UPS Status'
          mappings:
            - value: '1'
              newvalue: Unknown
            - value: '2'
              newvalue: Online
            - value: '3'
              newvalue: 'On Battery'
            - value: '4'
              newvalue: 'On Smart Boost'
            - value: '5'
              newvalue: 'Timed Sleeping'
            - value: '6'
              newvalue: 'Software Bypass'
            - value: '7'
              newvalue: 'Off'
            - value: '8'
              newvalue: Rebooting
            - value: '9'
              newvalue: 'Switched Bypass'
            - value: '10'
              newvalue: 'Hardware Failure Bypass'
            - value: '11'
              newvalue: 'Sleeping Unit Power Return'
            - value: '12'
              newvalue: 'On Smart Trim'
    - uuid: 996e61cf1dd84efe93ea42c66397176d
      template: 'BA - MIB - Entity'
      name: 'BA - MIB - Entity (ENTITY & ENTITY-STATE & ENTITY-SENSOR)'
      groups:
        - name: BA/MIBs
      discovery_rules:
        - uuid: c6d1b1f21d1b4c77a0e97a9db4d210de
          name: 'Entity Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#NAME}, .1.3.6.1.2.1.47.1.1.1.1.7, {#MODEL}, .1.3.6.1.2.1.47.1.1.1.1.13, {#SERIAL}, .1.3.6.1.2.1.47.1.1.1.1.11, {#CLASS}, .1.3.6.1.2.1.47.1.1.1.1.5, {#SENSORTYPE}, .1.3.6.1.2.1.99.1.1.1.1, {#SENSORVALUE}, .1.3.6.1.2.1.99.1.1.1.4, {#ALARM}, .1.3.6.1.2.1.131.1.1.1.5]'
          key: entity.discovery
          delay: 1h
          filter:
            evaltype: OR
            conditions:
              - macro: '{#CLASS}'
                operator: NOT_EXISTS
                formulaid: A
              - macro: '{#CLASS}'
                value: ^2|5|10$
                operator: NOT_MATCHES_REGEX
                formulaid: B
          item_prototypes:
            - uuid: bdd96b4040ef4985abc5c82e9738a33a
              name: 'Entity ({#NAME}) Alarm'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.131.1.1.1.5.{#SNMPINDEX}'
              key: 'entity.alarm[{#SNMPINDEX}]'
              history: 7d
              valuemap:
                name: Alarm
              tags:
                - tag: Entity
                  value: '{#NAME}'
                - tag: Type
                  value: Alarm
              trigger_prototypes:
                - uuid: 28d8f5392b4f4a6099d0ee260d504be2
                  expression: 'last(/BA - MIB - Entity/entity.alarm[{#SNMPINDEX}])<>0'
                  name: 'Entity ({#NAME}) Alarm Fault'
                  priority: HIGH
                  description: 'An alarm has been triggered!'
                  tags:
                    - tag: Entity
                      value: '{#NAME}'
                    - tag: Type
                      value: Alarm
            - uuid: 2dcd7f640d80439b97e9b0c367465d77
              name: 'Entity ({#NAME}) Class'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.47.1.1.1.1.5.{#SNMPINDEX}'
              key: 'entity.class[{#SNMPINDEX}]'
              delay: 12h
              history: 7d
              valuemap:
                name: Class
              tags:
                - tag: Entity
                  value: '{#NAME}'
                - tag: Type
                  value: Class
            - uuid: 48fbdf1f81504698b8a40c6ae64aa453
              name: 'Entity ({#NAME}) Description'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.47.1.1.1.1.2.{#SNMPINDEX}'
              key: 'entity.desc[{#SNMPINDEX}]'
              delay: 12h
              history: 365d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                - tag: Entity
                  value: '{#NAME}'
                - tag: Type
                  value: Description
            - uuid: 8ce3cfa23d134747945c774e0ad6e8f8
              name: 'Entity ({#NAME}) Model'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.47.1.1.1.1.13.{#SNMPINDEX}'
              key: 'entity.model[{#SNMPINDEX}]'
              delay: 12h
              history: 365d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                - tag: Entity
                  value: '{#NAME}'
                - tag: Type
                  value: Model
            - uuid: f8806d92cf224591bff4b3ed9027e35d
              name: 'Entity ({#NAME}) Sensor Type'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.99.1.1.1.1.{#SNMPINDEX}'
              key: 'entity.sensor.type[{#SNMPINDEX}]'
              delay: 12h
              history: 7d
              valuemap:
                name: 'Sensor Type'
              tags:
                - tag: Entity
                  value: '{#NAME}'
                - tag: Type
                  value: Type
            - uuid: af38085e9c464cbb94a5fbf7629aa576
              name: 'Entity ({#NAME}) Sensor Value'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.99.1.1.1.4.{#SNMPINDEX}'
              key: 'entity.sensor.value[{#SNMPINDEX}]'
              history: 7d
              tags:
                - tag: Entity
                  value: '{#NAME}'
                - tag: Type
                  value: Value
            - uuid: b362e9cc210a448f839040e71db6dd96
              name: 'Entity ({#NAME}) Serial'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.47.1.1.1.1.11.{#SNMPINDEX}'
              key: 'entity.serial[{#SNMPINDEX}]'
              delay: 12h
              history: 365d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                - tag: Entity
                  value: '{#NAME}'
                - tag: Type
                  value: Serial
          graph_prototypes:
            - uuid: 54db887b37754d2ab01476b2e2acdb48
              name: 'Entity ({#NAME}) Sensor Value'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - Entity'
                    key: 'entity.sensor.value[{#SNMPINDEX}]'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value);
                  data.forEach(function(v, k) {
                      if (data[k]['{#NAME}'] == undefined) {
                          data[k]['{#NAME}'] = 'Unknown ' + k;
                      }
                  });
                  return JSON.stringify(data);
          overrides:
            - name: 'No Class'
              step: '1'
              filter:
                conditions:
                  - macro: '{#CLASS}'
                    operator: NOT_EXISTS
                    formulaid: A
              operations:
                - operationobject: ITEM_PROTOTYPE
                  operator: LIKE
                  value: Class
                  discover: NO_DISCOVER
            - name: 'No Description'
              step: '2'
              filter:
                evaltype: OR
                conditions:
                  - macro: '{#DESCRIPTION}'
                    operator: NOT_EXISTS
                    formulaid: A
                  - macro: '{#DESCRIPTION}'
                    value: .+
                    operator: NOT_MATCHES_REGEX
                    formulaid: B
              operations:
                - operationobject: ITEM_PROTOTYPE
                  operator: LIKE
                  value: Description
                  discover: NO_DISCOVER
            - name: 'No Sensor Type'
              step: '3'
              filter:
                conditions:
                  - macro: '{#SENSORTYPE}'
                    operator: NOT_EXISTS
                    formulaid: A
              operations:
                - operationobject: ITEM_PROTOTYPE
                  operator: LIKE
                  value: 'Sensor Type'
                  discover: NO_DISCOVER
            - name: 'No Sensor Value'
              step: '4'
              filter:
                conditions:
                  - macro: '{#SENSORVALUE}'
                    operator: NOT_EXISTS
                    formulaid: A
              operations:
                - operationobject: ITEM_PROTOTYPE
                  operator: LIKE
                  value: 'Sensor Value'
                  discover: NO_DISCOVER
                - operationobject: GRAPH_PROTOTYPE
                  operator: LIKE
                  value: 'Sensor Value'
                  discover: NO_DISCOVER
            - name: 'No Alarm'
              step: '5'
              filter:
                conditions:
                  - macro: '{#ALARM}'
                    operator: NOT_EXISTS
                    formulaid: A
                  - macro: '{#ALARM}'
                    value: ^$
                    formulaid: B
              operations:
                - operationobject: ITEM_PROTOTYPE
                  operator: LIKE
                  value: Alarm
                  discover: NO_DISCOVER
                - operationobject: TRIGGER_PROTOTYPE
                  operator: LIKE
                  value: Alarm
                  discover: NO_DISCOVER
            - name: 'No Model'
              step: '6'
              filter:
                evaltype: OR
                conditions:
                  - macro: '{#MODEL}'
                    operator: NOT_EXISTS
                    formulaid: A
                  - macro: '{#MODEL}'
                    value: .+
                    operator: NOT_MATCHES_REGEX
                    formulaid: B
              operations:
                - operationobject: ITEM_PROTOTYPE
                  operator: REGEXP
                  value: Model
                  discover: NO_DISCOVER
            - name: 'No Serial'
              step: '7'
              filter:
                evaltype: OR
                conditions:
                  - macro: '{#SERIAL}'
                    operator: NOT_EXISTS
                    formulaid: A
                  - macro: '{#SERIAL}'
                    value: .+
                    operator: NOT_MATCHES_REGEX
                    formulaid: B
              operations:
                - operationobject: ITEM_PROTOTYPE
                  operator: LIKE
                  value: Serial
                  discover: NO_DISCOVER
      tags:
        - tag: Type
          value: MIB
      valuemaps:
        - uuid: 7caa4aac7c634155b5562ff764894989
          name: Alarm
          mappings:
            - value: '0'
              newvalue: OK
            - value: '1'
              newvalue: 'Under Repair'
            - value: '2'
              newvalue: Critical
            - value: '3'
              newvalue: Major
            - value: '4'
              newvalue: Minor
            - value: '5'
              newvalue: Warning
            - value: '6'
              newvalue: Indeterminate
        - uuid: 2d1137ea13da40699b7a2fbdf087254e
          name: Class
          mappings:
            - value: '1'
              newvalue: Other
            - value: '2'
              newvalue: Unknown
            - value: '3'
              newvalue: Chassis
            - value: '4'
              newvalue: Backplane
            - value: '5'
              newvalue: Container
            - value: '6'
              newvalue: 'Power Supply'
            - value: '7'
              newvalue: Fan
            - value: '8'
              newvalue: Sensor
            - value: '9'
              newvalue: Module
            - value: '10'
              newvalue: Port
            - value: '11'
              newvalue: Stack
            - value: '12'
              newvalue: CPU
        - uuid: 3d5438f67c324a56b0e567e68a90a14a
          name: 'Sensor Status'
          mappings:
            - value: '1'
              newvalue: OK
            - value: '2'
              newvalue: Unavailable
            - value: '3'
              newvalue: 'Non Operational'
        - uuid: abc18022ee8a440cb3d5b58ef645fd1c
          name: 'Sensor Type'
          mappings:
            - value: '1'
              newvalue: Other
            - value: '2'
              newvalue: Unknown
            - value: '3'
              newvalue: 'Volts AC'
            - value: '4'
              newvalue: 'Volts DC'
            - value: '5'
              newvalue: Amps
            - value: '6'
              newvalue: Watts
            - value: '7'
              newvalue: Hertz
            - value: '8'
              newvalue: Celsius
            - value: '9'
              newvalue: 'Percent Relative Humidity'
            - value: '10'
              newvalue: RPM
            - value: '11'
              newvalue: 'Cubic Meters per Minute'
            - value: '12'
              newvalue: Boolean
    - uuid: 0ed25cacfaad433dbf26caee5e9849a0
      template: 'BA - MIB - Generic'
      name: 'BA - MIB - Generic (RFC1213)'
      groups:
        - name: BA/MIBs
      items:
        - uuid: e56547fd128b4f38a3fba5cd167bb047
          name: 'SNMP Description'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.1.0
          key: snmp.description
          delay: 12h
          history: 365d
          trends: '0'
          value_type: CHAR
          inventory_link: NOTES
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: SNMP
            - tag: Type
              value: Description
        - uuid: 0aac83f830854eedbb489a7623b73dd4
          name: 'SNMP Location'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.6.0
          key: snmp.location
          delay: 12h
          history: 365d
          trends: '0'
          value_type: CHAR
          inventory_link: LOCATION
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: SNMP
            - tag: Type
              value: Location
        - uuid: 892eced5e100486b8e5353fa6ba6fe31
          name: 'SNMP Name'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.5.0
          key: snmp.name
          delay: 12h
          history: 365d
          trends: '0'
          value_type: CHAR
          inventory_link: NAME
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: SNMP
            - tag: Type
              value: Name
          triggers:
            - uuid: b02a2f213a7b4df28c734ddd3e4415da
              expression: 'change(/BA - MIB - Generic/snmp.name)=1'
              recovery_mode: NONE
              name: 'Device name changed'
              priority: INFO
              manual_close: 'YES'
              tags:
                - tag: SNMP
        - uuid: 72a2a3118d0d4bdc8196f91d45d06094
          name: 'SNMP Object ID'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.2.0
          key: snmp.objectid
          delay: 12h
          history: 365d
          trends: '0'
          value_type: CHAR
          inventory_link: TYPE
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: SNMP
            - tag: Type
              value: 'Object ID'
        - uuid: 8d6e1a0ceb5f4d52b884d4be397652a8
          name: 'SNMP Uptime'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.3.0
          key: snmp.uptime
          history: 7d
          units: s
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: SNMP
            - tag: Type
              value: Uptime
          triggers:
            - uuid: f320509f49d6454e87a36f0499efd9bd
              expression: 'nodata(/BA - MIB - Generic/snmp.uptime,2h)=1'
              name: 'Device is not responding to SNMP'
              priority: AVERAGE
              dependencies:
                - name: 'Device offline'
                  expression: 'last(/BA - Generic - ICMP/icmpping[{HOST.HOST}])=0'
              tags:
                - tag: SNMP
            - uuid: ed77aa0f513b454d90a231185baef9be
              expression: 'last(/BA - MIB - Generic/snmp.uptime)<=300'
              name: 'Device rebooted'
              priority: AVERAGE
              description: 'This device rebooted within the last 5 minutes.'
              tags:
                - tag: SNMP
      tags:
        - tag: Type
          value: MIB
    - uuid: b1abf69b89d145d0bb16bf3296e42c7d
      template: 'BA - MIB - Host Resources'
      name: 'BA - MIB - Host Resources (HOST-RESOURCES)'
      groups:
        - name: BA/MIBs
      items:
        - uuid: 06f324c51e5f4598907c5cb273b658b8
          name: 'CPU Count'
          type: DEPENDENT
          key: cpu.count
          delay: '0'
          history: 7d
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - usage
                - .1.3.6.1.2.1.25.3.3.1.2
                - '0'
            - type: JSONPATH
              parameters:
                - $.length()
          master_item:
            key: snmp.cpu
          tags:
            - tag: CPU
            - tag: Type
              value: Count
        - uuid: 5025fa88f9a7452289629d2d127374e8
          name: 'CPU Usage'
          type: DEPENDENT
          key: cpu.usage
          delay: '0'
          history: 7d
          value_type: FLOAT
          units: '%'
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - usage
                - .1.3.6.1.2.1.25.3.3.1.2
                - '0'
            - type: JSONPATH
              parameters:
                - $..usage.avg()
          master_item:
            key: snmp.cpu
          tags:
            - tag: CPU
            - tag: Type
              value: Usage
          triggers:
            - uuid: 54befd1674e64270b7bc9876c05d5204
              expression: 'avg(/BA - MIB - Host Resources/cpu.usage,{$CPU_USAGE_WARN})>={$CPU_USAGE_WARN}'
              name: 'CPU Usage >= {$CPU_USAGE_WARN}% for {$CPU_HIGH_AVG_TIME_WARN}'
              priority: AVERAGE
              tags:
                - tag: CPU
                - tag: Type
                  value: Usage
        - uuid: dfe4572fa178448692691e4d75cd44bc
          name: 'Memory Usage'
          type: DEPENDENT
          key: memory.usage
          delay: '0'
          history: 7d
          units: '%'
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - desc
                - .1.3.6.1.2.1.25.2.3.1.3
                - '0'
                - size
                - .1.3.6.1.2.1.25.2.3.1.5
                - '0'
                - used
                - .1.3.6.1.2.1.25.2.3.1.6
                - '0'
            - type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value);
                  var used;
                  var size;
                  var linux;
                  data.forEach(function(item) {
                      if(item['desc'] == 'main memory' || item['desc'] == 'Physical Memory' || item['desc'] == 'Real Memory') { //MikroTik / Windows / VMWare
                          used = item['used'];
                          size = item['size'];
                      }
                      if(item['desc'] == 'Physical memory') { //Linux
                          linux = true;
                          size = item['size'];
                      }
                      if(item['desc'] == 'Available memory') { //Linux
                          linux = true;
                          used = item['size'];
                      }
                  });
                  if (linux) {
                      return Math.round((((used / size) - 1) * -1) * 100);
                  }
                  return Math.round(used / size * 100);
          master_item:
            key: snmp.hr.storage
          tags:
            - tag: Memory
            - tag: Type
              value: Usage
          triggers:
            - uuid: 678770fcf45c4c8a8f617d58c4a77776
              expression: 'last(/BA - MIB - Host Resources/memory.usage)>={$MEM_USAGE_WARN}'
              name: 'Memory Usage >= {$MEM_USAGE_WARN}%'
              priority: AVERAGE
              tags:
                - tag: Memory
                - tag: Type
                  value: Usage
        - uuid: 466a0ad4e7d64c64ac813cf42a1a42f6
          name: 'CPU Discovery'
          type: SNMP_AGENT
          snmp_oid: 'walk[.1.3.6.1.2.1.25.3.3.1.2]'
          key: snmp.cpu
          history: '0'
          trends: '0'
          value_type: TEXT
        - uuid: d6776d1e932247fca27a366c365cd41f
          name: 'Storage Discovery'
          type: SNMP_AGENT
          snmp_oid: 'walk[.1.3.6.1.2.1.25.2.3.1.2, .1.3.6.1.2.1.25.2.3.1.3, .1.3.6.1.2.1.25.2.3.1.4, .1.3.6.1.2.1.25.2.3.1.5, .1.3.6.1.2.1.25.2.3.1.6]'
          key: snmp.hr.storage
          history: '0'
          trends: '0'
          value_type: TEXT
      discovery_rules:
        - uuid: 0c403e28a6c4499a9ca25969557b655a
          name: 'Processor Discovery'
          type: DEPENDENT
          key: snmp.hr.cpu.discovery
          delay: '0'
          item_prototypes:
            - uuid: d7b4dc1bc39e46548aa5dcbcc9e42d9a
              name: 'CPU ({#SNMPINDEX}) Usage'
              type: DEPENDENT
              key: 'snmp.hr.cpu.usage[{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              units: '%'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.2.1.25.3.3.1.2.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: snmp.cpu
              tags:
                - tag: CPU
                  value: '{#SNMPINDEX}'
                - tag: Type
                  value: Usage
          master_item:
            key: snmp.cpu
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#USAGE}'
                - .1.3.6.1.2.1.25.3.3.1.2
                - '0'
        - uuid: b06ed58b63fe4b74b7028ec8eb23facc
          name: 'Fixed Disk Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#TYPE}, .1.3.6.1.2.1.25.2.3.1.2, {#DESC}, .1.3.6.1.2.1.25.2.3.1.3, {#AUNITS}, .1.3.6.1.2.1.25.2.3.1.4]'
          key: snmp.hr.fdisk.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#TYPE}'
                value: 'HOST-RESOURCES-TYPES::hrStorageFixedDisk'
                formulaid: A
              - macro: '{#TYPE}'
                value: iso.3.6.1.2.1.25.2.1.4
                formulaid: B
          lifetime: 1d
          item_prototypes:
            - uuid: 974a620b61674937a5561e9227ab54c3
              name: 'Disk ({#DESC}) Size'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.25.2.3.1.5.{#SNMPINDEX}'
              key: 'snmp.hr.fdisk.size[{#SNMPINDEX}]'
              delay: 6h
              history: 7d
              units: B
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      value = parseInt(value)
                      if (value < 0) {
                          value = value + (2147483648 * 2);
                      }
                      return value * {#AUNITS};
              tags:
                - tag: Disk
                  value: '{#DESC}'
                - tag: Type
                  value: Size
            - uuid: d9309c8752944c33ad352b0b23118259
              name: 'Disk ({#DESC}) Usage'
              type: CALCULATED
              key: 'snmp.hr.fdisk.usage[{#SNMPINDEX}]'
              delay: 1h
              history: 7d
              value_type: FLOAT
              units: '%'
              params: 'last(//snmp.hr.fdisk.used[{#SNMPINDEX}])/last(//snmp.hr.fdisk.size[{#SNMPINDEX}])'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '100'
              tags:
                - tag: Disk
                  value: '{#DESC}'
                - tag: Type
                  value: Usage
              trigger_prototypes:
                - uuid: 4e5aa0b34f4745ada32f998ac09fe99e
                  expression: 'last(/BA - MIB - Host Resources/snmp.hr.fdisk.usage[{#SNMPINDEX}])>={$DISK_HIGH_AVG_PERC_WARN}'
                  name: 'Disk ({#DESC}) Usage >= {$DISK_HIGH_AVG_PERC_WARN}%'
                  priority: HIGH
            - uuid: d12b45c4665144ab99bcc2b12ee4073d
              name: 'Disk ({#DESC}) Used'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.25.2.3.1.6.{#SNMPINDEX}'
              key: 'snmp.hr.fdisk.used[{#SNMPINDEX}]'
              delay: 1h
              history: 7d
              units: B
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      value = parseInt(value)
                      if (value < 0) {
                          value = value + (2147483648 * 2);
                      }
                      return value * {#AUNITS};
              tags:
                - tag: Disk
                  value: '{#DESC}'
                - tag: Type
                  value: Used
          graph_prototypes:
            - uuid: c257fe03d5424e8485a040c39e920cc0
              name: 'Disk ({#DESC}) Statistics'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - Host Resources'
                    key: 'snmp.hr.fdisk.size[{#SNMPINDEX}]'
                - sortorder: '1'
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - Host Resources'
                    key: 'snmp.hr.fdisk.used[{#SNMPINDEX}]'
                - sortorder: '2'
                  color: 2774A4
                  yaxisside: RIGHT
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - Host Resources'
                    key: 'snmp.hr.fdisk.usage[{#SNMPINDEX}]'
            - uuid: 80c9eb5bde2e4873af69913d1cc94a51
              name: 'Disk ({#DESC}) Usage'
              yaxismax: '0'
              show_work_period: 'NO'
              show_triggers: 'NO'
              type: PIE
              show_3d: 'YES'
              graph_items:
                - color: F0F0F0
                  calc_fnc: LAST
                  type: GRAPH_SUM
                  item:
                    host: 'BA - MIB - Host Resources'
                    key: 'snmp.hr.fdisk.size[{#SNMPINDEX}]'
                - sortorder: '1'
                  color: E57373
                  calc_fnc: LAST
                  item:
                    host: 'BA - MIB - Host Resources'
                    key: 'snmp.hr.fdisk.used[{#SNMPINDEX}]'
        - uuid: 5f9d9f2ab44f452cae7c7d8b67873df2
          name: 'Memory Discovery'
          type: DEPENDENT
          key: snmp.hr.memory.discovery
          delay: '0'
          filter:
            conditions:
              - macro: '{#DESC}'
                value: '[Mm]emory'
                formulaid: A
          item_prototypes:
            - uuid: e1a4c937289a420399b88d93a12d2936
              name: 'Memory ({#DESC}) Size'
              type: DEPENDENT
              key: 'snmp.hr.memory.size[{#DESC}]'
              delay: '0'
              history: 7d
              units: B
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.2.1.25.2.3.1.5.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '{#ALLOCUNITS}'
              master_item:
                key: snmp.hr.storage
              tags:
                - tag: Memory
                  value: '{#DESC}'
                - tag: Type
                  value: Size
            - uuid: 7dff57c2b11144b791f310ddb854afe0
              name: 'Memory ({#DESC}) Usage'
              type: DEPENDENT
              key: 'snmp.hr.memory.usage[{#DESC}]'
              delay: '0'
              history: 7d
              units: '%'
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - 'return Math.round({#USED} / {#SIZE} * 100);'
              master_item:
                key: snmp.hr.storage
              tags:
                - tag: Memory
                  value: '{#DESC}'
                - tag: Type
                  value: Usage
            - uuid: 27f46f9cff5e4fc1a7699dce1b869cbd
              name: 'Memory ({#DESC}) Used'
              type: DEPENDENT
              key: 'snmp.hr.memory.used[{#DESC}]'
              delay: '0'
              history: 7d
              units: B
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.2.1.25.2.3.1.6.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '{#ALLOCUNITS}'
              master_item:
                key: snmp.hr.storage
              tags:
                - tag: Memory
                  value: '{#DESC}'
                - tag: Type
                  value: Used
          graph_prototypes:
            - uuid: 8d9417a5eeab4a8487ea550f9ef784fe
              name: 'Memory ({#DESC}) Statistics'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - Host Resources'
                    key: 'snmp.hr.memory.size[{#DESC}]'
                - sortorder: '1'
                  color: F63100
                  yaxisside: RIGHT
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - Host Resources'
                    key: 'snmp.hr.memory.usage[{#DESC}]'
                - sortorder: '2'
                  color: 2774A4
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - Host Resources'
                    key: 'snmp.hr.memory.used[{#DESC}]'
            - uuid: ac45f37962c04cb1b37a0c240ca18eca
              name: 'Memory ({#DESC}) Usage'
              yaxismax: '0'
              show_work_period: 'NO'
              show_triggers: 'NO'
              type: PIE
              show_3d: 'YES'
              graph_items:
                - color: FFEBEE
                  calc_fnc: LAST
                  type: GRAPH_SUM
                  item:
                    host: 'BA - MIB - Host Resources'
                    key: 'snmp.hr.memory.size[{#DESC}]'
                - sortorder: '1'
                  color: 0080FF
                  calc_fnc: LAST
                  item:
                    host: 'BA - MIB - Host Resources'
                    key: 'snmp.hr.memory.used[{#DESC}]'
          master_item:
            key: snmp.hr.storage
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#TYPE}'
                - .1.3.6.1.2.1.25.2.3.1.2
                - '0'
                - '{#DESC}'
                - .1.3.6.1.2.1.25.2.3.1.3
                - '0'
                - '{#ALLOCUNITS}'
                - .1.3.6.1.2.1.25.2.3.1.4
                - '0'
                - '{#SIZE}'
                - .1.3.6.1.2.1.25.2.3.1.5
                - '0'
                - '{#USED}'
                - .1.3.6.1.2.1.25.2.3.1.6
                - '0'
      tags:
        - tag: Type
          value: MIB
      dashboards:
        - uuid: 230ad7e9ab814c76a271c4d937cb0e4f
          name: 'Host Resources'
          pages:
            - widgets:
                - type: item
                  width: '3'
                  height: '3'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - Host Resources'
                        key: cpu.usage
                - type: graph
                  'y': '3'
                  width: '6'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'BA - MIB - Host Resources'
                        name: CPU
                - type: graph
                  'y': '8'
                  width: '6'
                  height: '5'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - Host Resources'
                        key: memory.usage
                    - type: INTEGER
                      name: source_type
                      value: '1'
                - type: item
                  x: '3'
                  width: '3'
                  height: '3'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - Host Resources'
                        key: memory.usage
                - type: graphprototype
                  x: '6'
                  width: '3'
                  height: '24'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        host: 'BA - MIB - Host Resources'
                        name: 'Memory ({#DESC}) Usage'
                    - type: INTEGER
                      name: rows
                      value: '6'
                - type: graphprototype
                  x: '9'
                  width: '6'
                  height: '24'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        host: 'BA - MIB - Host Resources'
                        name: 'Memory ({#DESC}) Statistics'
                    - type: INTEGER
                      name: rows
                      value: '6'
                - type: graphprototype
                  x: '15'
                  width: '3'
                  height: '24'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        host: 'BA - MIB - Host Resources'
                        name: 'Disk ({#DESC}) Usage'
                    - type: INTEGER
                      name: rows
                      value: '6'
                - type: graphprototype
                  x: '18'
                  width: '6'
                  height: '24'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        host: 'BA - MIB - Host Resources'
                        name: 'Disk ({#DESC}) Statistics'
                    - type: INTEGER
                      name: rows
                      value: '6'
    - uuid: 2f56e1feb21d4d4dac7dd9f89b819162
      template: 'BA - MIB - iDRAC'
      name: 'BA - MIB - iDRAC (IDRAC)'
      groups:
        - name: BA/MIBs
      items:
        - uuid: e63d7779047a4b279061315c5d418b21
          name: Model
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.674.10892.5.1.3.12.0
          key: snmp.idrac.model
          delay: 6h
          trends: '0'
          value_type: CHAR
          inventory_link: MODEL
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: Type
              value: Model
        - uuid: 9927ce6906e244cea23ebda392226b74
          name: 'Service Tag'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.674.10892.5.1.3.2.0
          key: snmp.idrac.servicetag
          delay: 6h
          trends: '0'
          value_type: CHAR
          inventory_link: TAG
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: Type
              value: 'Service Tag'
        - uuid: b951924d1d874343b38dd8211ac4cc2e
          name: 'Global Status'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.674.10892.5.2.1.0
          key: snmp.idrac.status
          valuemap:
            name: 'Object Status'
          tags:
            - tag: Global
            - tag: Type
              value: Status
          triggers:
            - uuid: e90c3fc7f46649c0975c3f32feb31023
              expression: 'last(/BA - MIB - iDRAC/snmp.idrac.status)<>3'
              name: 'Global Status not OK'
              priority: HIGH
              tags:
                - tag: Global
                - tag: Type
                  value: Status
      discovery_rules:
        - uuid: 42d18f824b4a41929333629f1f45d0e6
          name: 'Drive Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#DISK}, .1.3.6.1.4.1.674.10892.5.5.1.20.130.4.1.1]'
          key: snmp.idrac.drive.discovery
          delay: 6h
          item_prototypes:
            - uuid: fa2afc17242e459ea4a5f788a3b0beb6
              name: 'Drive ({#DISK}) Make'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.674.10892.5.5.1.20.130.4.1.3.{#SNMPINDEX}'
              key: 'snmp.idrac.drive.make[{#DISK}]'
              delay: 6h
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                - tag: Drive
                  value: '{#DISK}'
                - tag: Type
                  value: Make
            - uuid: 5fed734179be429baab0bd253fcca232
              name: 'Drive ({#DISK}) Model'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.674.10892.5.5.1.20.130.4.1.6.{#SNMPINDEX}'
              key: 'snmp.idrac.drive.model[{#DISK}]'
              delay: 6h
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                - tag: Drive
                  value: '{#DISK}'
                - tag: Type
                  value: Model
            - uuid: 19dd14130fde4e189e6bdcdf0dbd72df
              name: 'Drive ({#DISK}) Serial'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.674.10892.5.5.1.20.130.4.1.7.{#SNMPINDEX}'
              key: 'snmp.idrac.drive.serial[{#DISK}]'
              delay: 6h
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                - tag: Drive
                  value: '{#DISK}'
                - tag: Type
                  value: Serial
            - uuid: b7162973d9aa42a7b118abeb144b58ae
              name: 'Drive ({#DISK}) Size'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.674.10892.5.5.1.20.130.4.1.11.{#SNMPINDEX}'
              key: 'snmp.idrac.drive.size[{#DISK}]'
              delay: 6h
              history: 30d
              units: B
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '1153024'
              tags:
                - tag: Drive
                  value: '{#DISK}'
                - tag: Type
                  value: Size
            - uuid: 39c74ddcf558450590be63665674d40b
              name: 'Drive ({#DISK}) Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.674.10892.5.5.1.20.130.4.1.4.{#SNMPINDEX}'
              key: 'snmp.idrac.drive.state[{#DISK}]'
              delay: 5m
              history: 30d
              valuemap:
                name: 'Drive Status'
              tags:
                - tag: Drive
                  value: '{#DISK}'
                - tag: Type
                  value: Status
              trigger_prototypes:
                - uuid: 0227fce3a12e4548b6ef0ddb0c0e0140
                  expression: |
                    last(/BA - MIB - iDRAC/snmp.idrac.drive.state[{#DISK}])<>2
                    and last(/BA - MIB - iDRAC/snmp.idrac.drive.state[{#DISK}])<>3
                  name: 'Drive ({#DISK}) Status not OK'
                  priority: HIGH
                  tags:
                    - tag: Drive
                      value: '{#DISK}'
                    - tag: Type
                      value: Status
            - uuid: 4441802ef1f944a5b898af0ec09b42d1
              name: 'Drive ({#DISK}) Type'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.674.10892.5.5.1.20.130.4.1.35.{#SNMPINDEX}'
              key: 'snmp.idrac.drive.type[{#DISK}]'
              delay: 6h
              history: 30d
              valuemap:
                name: 'Drive Type'
              tags:
                - tag: Drive
                  value: '{#DISK}'
                - tag: Type
                  value: Type
        - uuid: ec4335a8bc7f46019fb5760475b77ed6
          name: 'Fan Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#FAN}, .1.3.6.1.4.1.674.10892.5.4.700.12.1.2]'
          key: snmp.idrac.fan.discovery
          delay: 6h
          item_prototypes:
            - uuid: 2954d6333acf4db0986fa5f537fa49d1
              name: 'Fan ({#FAN}) RPM'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.674.10892.5.4.700.12.1.6.{#SNMPINDEX}'
              key: 'snmp.idrac.fan.rpm[{#FAN}]'
              delay: 5m
              history: 30d
              units: RPM
              tags:
                - tag: Fan
                  value: '{#FAN}'
                - tag: Type
                  value: RPM
            - uuid: 1c602031725b413b8083c21630d3b228
              name: 'Fan ({#FAN}) Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.674.10892.5.4.700.12.1.5.{#SNMPINDEX}'
              key: 'snmp.idrac.fan.status[{#FAN}]'
              delay: 5m
              history: 30d
              valuemap:
                name: 'Object Status'
              tags:
                - tag: Fan
                  value: '{#FAN}'
                - tag: Type
                  value: Status
              trigger_prototypes:
                - uuid: e6ee458513b64b308e44893bfab0a2d4
                  expression: 'last(/BA - MIB - iDRAC/snmp.idrac.fan.status[{#FAN}])<>3'
                  name: 'Fan ({#FAN}) Status not OK'
                  priority: AVERAGE
                  tags:
                    - tag: Fan
                      value: '{#FAN}'
                    - tag: Type
                      value: Status
        - uuid: 1a56ee105c1447a5aa91c7dc3c6d8fdb
          name: 'Memory Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#LOCATION}, .1.3.6.1.4.1.674.10892.5.4.1100.50.1.8]'
          key: snmp.idrac.memory.discovery
          delay: 6h
          item_prototypes:
            - uuid: ec41f97fb2574579a461d7c1b141d663
              name: 'Memory ({#LOCATION}) Size'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.674.10892.5.4.1100.50.1.14.{#SNMPINDEX}'
              key: 'snmp.idrac.memory.size[{#LOCATION}]'
              delay: 6h
              history: 30d
              units: B
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '1024'
              tags:
                - tag: Memory
                  value: '{#LOCATION}'
                - tag: Type
                  value: Size
            - uuid: a595bcdab1e7464db8e98fb1deb32e42
              name: 'Memory ({#LOCATION}) Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.674.10892.5.4.1100.50.1.5.{#SNMPINDEX}'
              key: 'snmp.idrac.memory.status[{#LOCATION}]'
              delay: 5m
              history: 30d
              valuemap:
                name: 'Object Status'
              tags:
                - tag: Memory
                  value: '{#LOCATION}'
                - tag: Type
                  value: Status
        - uuid: 5a1c95dbdadf4b9cb23a70422f770c02
          name: 'Power Supply Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SLOT}, .1.3.6.1.4.1.674.10892.5.4.600.12.1.2]'
          key: snmp.idrac.psu.discovery
          delay: 6h
          item_prototypes:
            - uuid: 6b518d142f6749ba9f1d978d175085ab
              name: 'Power Supply ({#SLOT}) Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.674.10892.5.4.600.12.1.5.{#SNMPINDEX}'
              key: 'snmp.psu.status[{#SLOT}]'
              delay: 5m
              history: 30d
              valuemap:
                name: 'Object Status'
              tags:
                - tag: 'Power Supply'
                  value: '{#SLOT}'
                - tag: Type
                  value: Status
              trigger_prototypes:
                - uuid: 992bf6b5677d4a2b968870f8e7a99508
                  expression: 'last(/BA - MIB - iDRAC/snmp.psu.status[{#SLOT}])<>3'
                  name: 'Power Supply ({#SLOT}) Status not OK'
                  priority: HIGH
                  tags:
                    - tag: 'Power Supply'
                      value: '{#SLOT}'
                    - tag: Type
                      value: Status
            - uuid: ba4d71e1cf524a06927a3a7258d5c73c
              name: 'Power Supply ({#SLOT}) Input Volts'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.674.10892.5.4.600.12.1.16.{#SNMPINDEX}'
              key: 'snmp.psu.volts[{#SLOT}]'
              delay: 5m
              history: 30d
              tags:
                - tag: 'Power Supply'
                  value: '{#SLOT}'
                - tag: Type
                  value: Volts
        - uuid: e3f42b9ea61e4a1dbd7177e91d693fab
          name: 'Temperature Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#LOCATION}, .1.3.6.1.4.1.674.10892.5.4.700.20.1.8]'
          key: snmp.idrac.temp.discovery
          delay: 6h
          item_prototypes:
            - uuid: 4defb8c45dc6400aa3f1371f7998c915
              name: 'Temperature ({#LOCATION}) Celsius'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.674.10892.5.4.700.20.1.6.{#SNMPINDEX}'
              key: 'snmp.idrac.temp.celsius[{#LOCATION}]'
              delay: 5m
              history: 30d
              units: C
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '0.1'
              tags:
                - tag: Temperature
                  value: '{#LOCATION}'
                - tag: Type
                  value: Celsius
            - uuid: 59fce9c9227640a8894473dab7f6d019
              name: 'Temperature ({#LOCATION}) Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.674.10892.5.4.700.20.1.5.{#SNMPINDEX}'
              key: 'snmp.idrac.temp.status[{#LOCATION}]'
              delay: 5m
              history: 30d
              valuemap:
                name: 'Object Status'
              tags:
                - tag: Temperature
                  value: '{#LOCATION}'
                - tag: Type
                  value: Status
              trigger_prototypes:
                - uuid: b866a3981892411ebf2cfa9094a563d3
                  expression: 'last(/BA - MIB - iDRAC/snmp.idrac.temp.status[{#LOCATION}])<>3'
                  name: 'Temperature ({#LOCATION}) Status not OK'
                  priority: AVERAGE
                  tags:
                    - tag: Temperature
                      value: '{#LOCATION}'
                    - tag: Type
                      value: Status
      tags:
        - tag: Type
          value: MIB
      dashboards:
        - uuid: d2d9f956b6ab4cfb909ef6e57e601c2d
          name: iDRAC
          pages:
            - widgets:
                - type: item
                  width: '5'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - iDRAC'
                        key: snmp.idrac.status
                - type: graphprototype
                  'y': '4'
                  width: '24'
                  height: '5'
                  fields:
                    - type: ITEM_PROTOTYPE
                      name: itemid
                      value:
                        host: 'BA - MIB - iDRAC'
                        key: 'snmp.psu.volts[{#SLOT}]'
                    - type: INTEGER
                      name: source_type
                      value: '3'
                - type: graphprototype
                  'y': '9'
                  width: '24'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '4'
                    - type: ITEM_PROTOTYPE
                      name: itemid
                      value:
                        host: 'BA - MIB - iDRAC'
                        key: 'snmp.idrac.temp.celsius[{#LOCATION}]'
                    - type: INTEGER
                      name: source_type
                      value: '3'
                - type: graphprototype
                  'y': '14'
                  width: '24'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '4'
                    - type: ITEM_PROTOTYPE
                      name: itemid
                      value:
                        host: 'BA - MIB - iDRAC'
                        key: 'snmp.idrac.fan.rpm[{#FAN}]'
                    - type: INTEGER
                      name: source_type
                      value: '3'
                - type: item
                  x: '5'
                  width: '19'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - iDRAC'
                        key: snmp.idrac.model
                    - type: INTEGER
                      name: show
                      value: '2'
                - type: item
                  x: '5'
                  'y': '2'
                  width: '19'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - iDRAC'
                        key: snmp.idrac.servicetag
                    - type: INTEGER
                      name: show
                      value: '2'
      valuemaps:
        - uuid: 87528ad19e974197bd45389575d08cc4
          name: 'Drive Status'
          mappings:
            - value: '1'
              newvalue: Unknown
            - value: '2'
              newvalue: Ready
            - value: '3'
              newvalue: Online
            - value: '4'
              newvalue: Foreign
            - value: '5'
              newvalue: Offline
            - value: '6'
              newvalue: Blocked
            - value: '7'
              newvalue: Failed
            - value: '8'
              newvalue: 'Non Raid'
            - value: '9'
              newvalue: Removed
            - value: '10'
              newvalue: 'Read Only'
        - uuid: 9bf34b9795194880806b30db0958782a
          name: 'Drive Type'
          mappings:
            - value: '1'
              newvalue: Unknown
            - value: '2'
              newvalue: HDD
            - value: '3'
              newvalue: SSD
        - uuid: 67ac04bbb6a4456080692021506a2dec
          name: 'Object Status'
          mappings:
            - value: '1'
              newvalue: Other
            - value: '2'
              newvalue: Unknown
            - value: '3'
              newvalue: OK
            - value: '4'
              newvalue: 'Non Critical'
            - value: '5'
              newvalue: Critical
            - value: '6'
              newvalue: 'Non Recoverable'
    - uuid: c132e4d556724cb4aab6f04f031d698c
      template: 'BA - MIB - iLO'
      name: 'BA - MIB - iLO (CPQHLTH CPQIDA CPQSINFO)'
      groups:
        - name: BA/MIBs
      items:
        - uuid: b82373e1ca9e42958d5134cbd2ee00ac
          name: 'BIOS Status'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.232.6.2.16.1.0
          key: ilo.bios.status
          delay: 30m
          history: 7d
          trends: 90d
          valuemap:
            name: Condition
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: BIOS
            - tag: Type
              value: Status
          triggers:
            - uuid: 8a90f354f7d8437ebcc6b624f6116407
              expression: 'last(/BA - MIB - iLO/ilo.bios.status)>=3'
              name: 'BIOS Status fault'
              priority: HIGH
              tags:
                - tag: iLO
                - tag: Type
                  value: Status
        - uuid: 73df4e29470f42d59d96b26542526767
          name: 'Health Status'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.232.6.1.3.0
          key: snmp.ilo.health
          history: 30d
          description: 'Overall global health of the server.'
          valuemap:
            name: Condition
          tags:
            - tag: Type
              value: Status
          triggers:
            - uuid: f885f35b8aca4be0be3b1c571a34fa5e
              expression: 'last(/BA - MIB - iLO/snmp.ilo.health)<>2'
              name: 'Health Status not OK'
              priority: HIGH
              tags:
                - tag: Type
                  value: Status
        - uuid: 1c023652a69044c7baeac117a853e465
          name: Model
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.232.2.2.4.2.0
          key: snmp.ilo.model
          delay: 6h
          history: 30d
          trends: '0'
          value_type: CHAR
          inventory_link: MODEL
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: Type
              value: Model
        - uuid: 5d539a8d1d45450a81bc3caaec350537
          name: Serial
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.232.2.2.2.1.0
          key: snmp.ilo.serial
          delay: 6h
          history: 30d
          trends: '0'
          value_type: CHAR
          inventory_link: SERIALNO_A
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: Type
              value: Serial
      discovery_rules:
        - uuid: 8082351a93ad426c85a987c28b766b87
          name: 'Drive Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#BAY}, .1.3.6.1.4.1.232.3.2.5.1.1.5]'
          key: ilo.drive.discovery
          delay: 1h
          item_prototypes:
            - uuid: f99a9648f1ef4aabb258ff46d06dad80
              name: 'Drive ({#BAY}) Model'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.3.2.5.1.1.3.{#SNMPINDEX}'
              key: 'ilo.drive.model[{#BAY}]'
              delay: 6h
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 24h
              tags:
                - tag: Drive
                  value: '{#BAY}'
                - tag: Type
                  value: Model
            - uuid: 6d48ed1d609d474ea8edc0a89e103de7
              name: 'Drive ({#BAY}) Serial'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.3.2.5.1.1.51.{#SNMPINDEX}'
              key: 'ilo.drive.serial[{#BAY}]'
              delay: 6h
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 24h
              tags:
                - tag: Drive
                  value: '{#BAY}'
                - tag: Type
                  value: Serial
            - uuid: 66924d8968f548de839cfd1867b0d4eb
              name: 'Drive ({#BAY}) Size'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.3.2.5.1.1.45.{#SNMPINDEX}'
              key: 'ilo.drive.size[{#BAY}]'
              delay: 6h
              history: 30d
              units: B
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '1152000'
              tags:
                - tag: Drive
                  value: '{#BAY}'
                - tag: Type
                  value: Size
            - uuid: 426d44830dd843bbaca34b43b0ab60c3
              name: 'Drive ({#BAY}) Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.3.2.5.1.1.6.{#SNMPINDEX}'
              key: 'ilo.drive.status[{#BAY}]'
              delay: 5m
              history: 30d
              valuemap:
                name: 'Drive Status'
              tags:
                - tag: Drive
                  value: '{#BAY}'
                - tag: Type
                  value: Status
              trigger_prototypes:
                - uuid: 684d29e15385460f96b9837fce515c27
                  expression: 'last(/BA - MIB - iLO/ilo.drive.status[{#BAY}])<>2'
                  name: 'Drive ({#BAY}) Status not OK'
                  priority: HIGH
                  description: 'The status of this drive is not OK.'
                  tags:
                    - tag: Drive
                      value: '{#BAY}'
                    - tag: Type
                      value: Status
            - uuid: 8541b50c6cbb46fbbc118e39eb186c73
              name: 'Drive ({#BAY}) Temperature'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.3.2.5.1.1.70.{#SNMPINDEX}'
              key: 'ilo.drive.temp[{#BAY}]'
              delay: 5m
              history: 30d
              units: C
              preprocessing:
                - type: IN_RANGE
                  parameters:
                    - '1'
                    - '254'
              tags:
                - tag: Drive
                  value: '{#BAY}'
                - tag: Type
                  value: Temperature
            - uuid: c56c65a63b234a578da62b14b334940d
              name: 'Drive ({#BAY}) Type'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.3.2.5.1.1.69.{#SNMPINDEX}'
              key: 'ilo.drive.type[{#BAY}]'
              delay: 6h
              history: 30d
              valuemap:
                name: 'Drive Type'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 24h
              tags:
                - tag: Drive
                  value: '{#BAY}'
                - tag: Type
                  value: Type
        - uuid: 259907ba7ffb434db9ab561e915ef699
          name: 'Fan Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#INDEX}, .1.3.6.1.4.1.232.6.2.6.7.1.2, {#PRESENT}, .1.3.6.1.4.1.232.6.2.6.7.1.4]'
          key: ilo.fan.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#PRESENT}'
                value: '3'
                formulaid: A
          item_prototypes:
            - uuid: cb685095094047d09132ff16f3cdc909
              name: 'Fan ({#INDEX}) Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.6.2.6.7.1.9.{#SNMPINDEX}'
              key: 'ilo.fan.status[{#SNMPINDEX}]'
              delay: 15m
              history: 7d
              trends: 90d
              valuemap:
                name: Condition
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                - tag: Fan
                  value: '{#INDEX}'
                - tag: Type
                  value: Status
              trigger_prototypes:
                - uuid: c0ea2d1cbf594b8e9386b99bb74cef7c
                  expression: 'last(/BA - MIB - iLO/ilo.fan.status[{#SNMPINDEX}])>=3'
                  name: 'Fan ({#INDEX}) Status Fault'
                  priority: AVERAGE
                  tags:
                    - tag: Fan
                      value: '{#INDEX}'
                    - tag: Type
                      value: Status
        - uuid: 0e2ce50fc37a42339ecce8ff57b64aff
          name: 'Memory Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#LOCATION}, .1.3.6.1.4.1.232.6.2.14.13.1.13, {#STATUS}, .1.3.6.1.4.1.232.6.2.14.13.1.19]'
          key: ilo.memory.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#STATUS}'
                value: '2'
                operator: NOT_MATCHES_REGEX
                formulaid: A
          item_prototypes:
            - uuid: dbd6d96ebc9c41c38327508e10ad42b2
              name: 'Memory Module ({#LOCATION}) Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.6.2.14.13.1.19.{#SNMPINDEX}'
              key: 'ilo.memory.status[{#SNMPINDEX}]'
              delay: 5m
              history: 7d
              trends: 90d
              valuemap:
                name: 'Memory Status'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                - tag: Memory
                  value: '{#LOCATION}'
                - tag: Type
                  value: Status
              trigger_prototypes:
                - uuid: 9756f0986d89482289d228966f731dbf
                  expression: |
                    last(/BA - MIB - iLO/ilo.memory.status[{#SNMPINDEX}])=8 or last(/BA - MIB - iLO/ilo.memory.status[{#SNMPINDEX}])=9 or
                    last(/BA - MIB - iLO/ilo.memory.status[{#SNMPINDEX}])=10 or
                    last(/BA - MIB - iLO/ilo.memory.status[{#SNMPINDEX}])=11 or
                    last(/BA - MIB - iLO/ilo.memory.status[{#SNMPINDEX}])=13 or
                    last(/BA - MIB - iLO/ilo.memory.status[{#SNMPINDEX}])=14 or
                    last(/BA - MIB - iLO/ilo.memory.status[{#SNMPINDEX}])=15
                  name: 'Memory Module ({#LOCATION}) Status Fault'
                  priority: HIGH
                  tags:
                    - tag: Memory
                      value: '{#LOCATION}'
                    - tag: Type
                      value: Status
        - uuid: 1ef1a17f77aa4016b9d4141fd9ac27e4
          name: 'Power Supply Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#BAY}, .1.3.6.1.4.1.232.6.2.9.3.1.2]'
          key: ilo.psu.discovery
          delay: 1h
          item_prototypes:
            - uuid: 55c324a536154fa8ada8ad8b17029a04
              name: 'Power Supply ({#BAY}) Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.6.2.9.3.1.4.{#SNMPINDEX}'
              key: 'ilo.psu.status[{#SNMPINDEX}]'
              delay: 15m
              history: 7d
              trends: 90d
              valuemap:
                name: Condition
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                - tag: 'Power Supply'
                  value: '{#BAY}'
                - tag: Type
                  value: Status
              trigger_prototypes:
                - uuid: 67085e3c3e4a430d939dfefbb43a9a1a
                  expression: 'last(/BA - MIB - iLO/ilo.psu.status[{#SNMPINDEX}])>=3'
                  name: 'Power Supply ({#BAY}) Status Fault'
                  priority: HIGH
                  tags:
                    - tag: 'Power Supply'
                      value: '{#BAY}'
                    - tag: Type
                      value: Status
            - uuid: 86b7a6491c684353b2a1b868bc25ea3d
              name: 'Power Supply ({#BAY}) Input Volts'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.6.2.9.3.1.6.{#SNMPINDEX}'
              key: 'ilo.psu.volts[{#SNMPINDEX}]'
              delay: 15m
              history: 7d
              units: V
              tags:
                - tag: 'Power Supply'
                  value: '{#BAY}'
                - tag: Type
                  value: Volts
            - uuid: 0e71a00b711145c4b12e1d5a8d380ff1
              name: 'Power Supply ({#BAY}) Output Watts'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.6.2.9.3.1.7.{#SNMPINDEX}'
              key: 'ilo.psu.watts[{#SNMPINDEX}]'
              delay: 15m
              history: 7d
              units: W
              tags:
                - tag: 'Power Supply'
                  value: '{#BAY}'
                - tag: Type
                  value: Watts
          graph_prototypes:
            - uuid: d230d7ac6e5e43dc944c1b624be84fbd
              name: 'Power Supply ({#BAY}) Input Volts / Output Watts'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - iLO'
                    key: 'ilo.psu.volts[{#SNMPINDEX}]'
                - sortorder: '1'
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - iLO'
                    key: 'ilo.psu.watts[{#SNMPINDEX}]'
        - uuid: a397d83fcc6d4190b8f9bb3d2eb9d414
          name: 'Temperature Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#LOCALE}, .1.3.6.1.4.1.232.6.2.6.8.1.3]'
          key: ilo.temp.discovery
          delay: 1h
          item_prototypes:
            - uuid: d8f0505960564bf191f0518f4b9602e6
              name: 'Temperature ({#LOCALE}) Celsius'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.6.2.6.8.1.4.{#SNMPINDEX}'
              key: 'ilo.temp.celsius[{#SNMPINDEX}]'
              delay: 5m
              history: 7d
              units: C
              tags:
                - tag: Temperature
                  value: '{#LOCALE}'
                - tag: Type
                  value: Celsius
            - uuid: 892880b41bc7497e889d3a9901f36947
              name: 'Temperature ({#LOCALE}) Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.232.6.2.6.8.1.6.{#SNMPINDEX}'
              key: 'ilo.temp.status[{#SNMPINDEX}]'
              delay: 15m
              history: 7d
              trends: 90d
              valuemap:
                name: Condition
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                - tag: Temperature
                  value: '{#LOCALE}'
                - tag: Type
                  value: Status
              trigger_prototypes:
                - uuid: 74e231598873468e8b3657365506fa40
                  expression: 'last(/BA - MIB - iLO/ilo.temp.status[{#SNMPINDEX}])>=3'
                  name: 'Temperature ({#LOCALE}) Status Fault'
                  priority: HIGH
                  tags:
                    - tag: Temperature
                      value: '{#LOCALE}'
                    - tag: Type
                      value: Status
          preprocessing:
            - type: STR_REPLACE
              parameters:
                - '"1"'
                - '"Other"'
            - type: STR_REPLACE
              parameters:
                - '"2"'
                - '"Unknown"'
            - type: STR_REPLACE
              parameters:
                - '"3"'
                - '"System"'
            - type: STR_REPLACE
              parameters:
                - '"4"'
                - '"System Board"'
            - type: STR_REPLACE
              parameters:
                - '"5"'
                - '"IO Board"'
            - type: STR_REPLACE
              parameters:
                - '"6"'
                - '"CPU"'
            - type: STR_REPLACE
              parameters:
                - '"7"'
                - '"Memory"'
            - type: STR_REPLACE
              parameters:
                - '"8"'
                - '"Storage"'
            - type: STR_REPLACE
              parameters:
                - '"9"'
                - '"Removeable Media"'
            - type: STR_REPLACE
              parameters:
                - '"10"'
                - '"Power Supply"'
            - type: STR_REPLACE
              parameters:
                - '"11"'
                - '"Ambient"'
            - type: STR_REPLACE
              parameters:
                - '"12"'
                - '"Chassis"'
            - type: STR_REPLACE
              parameters:
                - '"13"'
                - '"Bridge Card"'
      tags:
        - tag: Type
          value: MIB
      dashboards:
        - uuid: db86ebd68489487fb4664c66286c8d93
          name: iLO
          pages:
            - widgets:
                - type: item
                  width: '5'
                  height: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - iLO'
                        key: snmp.ilo.health
                    - type: STRING
                      name: thresholds.color.0
                      value: 1B5E20
                    - type: STRING
                      name: thresholds.threshold.0
                      value: '2'
                - type: graphprototype
                  'y': '4'
                  width: '24'
                  height: '5'
                  fields:
                    - type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        host: 'BA - MIB - iLO'
                        name: 'Power Supply ({#BAY}) Input Volts / Output Watts'
                - type: graphprototype
                  'y': '9'
                  width: '24'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '4'
                    - type: ITEM_PROTOTYPE
                      name: itemid
                      value:
                        host: 'BA - MIB - iLO'
                        key: 'ilo.temp.celsius[{#SNMPINDEX}]'
                    - type: INTEGER
                      name: source_type
                      value: '3'
                - type: graphprototype
                  'y': '14'
                  width: '24'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '4'
                    - type: ITEM_PROTOTYPE
                      name: itemid
                      value:
                        host: 'BA - MIB - iLO'
                        key: 'ilo.drive.temp[{#BAY}]'
                    - type: INTEGER
                      name: source_type
                      value: '3'
                - type: item
                  x: '5'
                  width: '19'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - iLO'
                        key: snmp.ilo.model
                    - type: INTEGER
                      name: show
                      value: '2'
                - type: item
                  x: '5'
                  'y': '2'
                  width: '19'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - iLO'
                        key: snmp.ilo.serial
                    - type: INTEGER
                      name: show
                      value: '2'
      valuemaps:
        - uuid: 5d0a36b6fc934ec8960c3f2f22ad2338
          name: Condition
          mappings:
            - value: '1'
              newvalue: Other
            - value: '2'
              newvalue: OK
            - value: '3'
              newvalue: Degraded
            - value: '4'
              newvalue: Failed
        - uuid: e36970e130a049a19885414304878330
          name: 'Drive Status'
          mappings:
            - value: '1'
              newvalue: Other
            - value: '2'
              newvalue: OK
            - value: '3'
              newvalue: Failed
            - value: '4'
              newvalue: 'Predictive Failure'
            - value: '5'
              newvalue: Erasing
            - value: '6'
              newvalue: 'Erasing Done'
            - value: '7'
              newvalue: 'Erase Queued'
            - value: '8'
              newvalue: 'SSD Wear Out'
            - value: '9'
              newvalue: 'Not Authenticated'
        - uuid: e8755e7be88745a5a927a3fbeb7b6b52
          name: 'Drive Type'
          mappings:
            - value: '1'
              newvalue: Other
            - value: '2'
              newvalue: HDD
            - value: '3'
              newvalue: SSD
            - value: '4'
              newvalue: SMR
        - uuid: 8663d7853f594e4a927b2d0d49ec902d
          name: 'Memory Status'
          mappings:
            - value: '1'
              newvalue: Other
            - value: '2'
              newvalue: 'Not Present'
            - value: '3'
              newvalue: Present
            - value: '4'
              newvalue: Good
            - value: '5'
              newvalue: Add
            - value: '6'
              newvalue: Upgrade
            - value: '7'
              newvalue: Missing
            - value: '8'
              newvalue: 'Does Not Match'
            - value: '9'
              newvalue: 'Not Supported'
            - value: '10'
              newvalue: 'Bad Config'
            - value: '11'
              newvalue: Degraded
            - value: '12'
              newvalue: Spare
            - value: '13'
              newvalue: Partial
            - value: '14'
              newvalue: 'Config Error'
            - value: '15'
              newvalue: 'Training Failure'
    - uuid: 71e181bbccaf4ac6ad6dbc31f4ef7ffa
      template: 'BA - MIB - Interfaces'
      name: 'BA - MIB - Interfaces (RFC1213 & IF)'
      groups:
        - name: BA/MIBs
      items:
        - uuid: 7dbba147f0de468cbc4b1335674c4405
          name: 'Interfaces Discovery'
          type: SNMP_AGENT
          snmp_oid: 'walk[.1.3.6.1.2.1.31.1.1.1.1,.1.3.6.1.2.1.31.1.1.1.18,.1.3.6.1.2.1.2.2.1.2,.1.3.6.1.2.1.2.2.1.8,.1.3.6.1.2.1.2.2.1.7,.1.3.6.1.2.1.2.2.1.10,.1.3.6.1.2.1.2.2.1.16,.1.3.6.1.2.1.2.2.1.8,.1.3.6.1.2.1.2.2.1.14,.1.3.6.1.2.1.2.2.1.20,.1.3.6.1.2.1.2.2.1.5,.1.3.6.1.2.1.31.1.1.1.18]'
          key: snmp.interfaces
          delay: 10s
          history: '0'
          trends: '0'
          value_type: TEXT
      discovery_rules:
        - uuid: e4cdcd9f67b24b3c93b312a52bf78a11
          name: 'Interfaces Discovery'
          type: DEPENDENT
          key: snmp.interfaces.discovery
          delay: '0'
          filter:
            conditions:
              - macro: '{#ALIAS}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: A
              - macro: '{#ASTATUS}'
                value: '2'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#NAME}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: C
              - macro: '{#OSTATUS}'
                value: '6'
                operator: NOT_MATCHES_REGEX
                formulaid: D
          lifetime: 1d
          item_prototypes:
            - uuid: a78b4fcd86c140c8a63b1b1d2bcc8925
              name: 'Interface ({#NAME}: {#ALIAS}) Alert On Errors'
              type: CALCULATED
              key: 'snmp.interfaces.alertonerrors[{#NAME}]'
              delay: 1h
              history: 1d
              trends: '0'
              params: 'last(//snmp.interfaces.mac.uplinkstatus[{#NAME}])'
              valuemap:
                name: 'Alert On Errors'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - ''
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Status
            - uuid: 87b5057634ea44dabc70e8d9a5c71e55
              name: 'Interface ({#NAME}: {#ALIAS}) Alias'
              type: DEPENDENT
              key: 'snmp.interfaces.alias[{#NAME}]'
              delay: '0'
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.2.1.31.1.1.1.18.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: snmp.interfaces
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Alias
            - uuid: 5760b2886c8640fd9bab2f200c57ce0d
              name: 'Interface ({#NAME}: {#ALIAS}) In Errors'
              type: DEPENDENT
              key: 'snmp.interfaces.in.errors[{#NAME}]'
              delay: '0'
              history: 7d
              units: bps
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              master_item:
                key: snmp.interfaces
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Errors
            - uuid: 6b9bd480242345febbcfc08b18bece36
              name: 'Interface ({#NAME}: {#ALIAS}) In Usage'
              type: CALCULATED
              key: 'snmp.interfaces.in.usage[{#NAME}]'
              history: 7d
              value_type: FLOAT
              units: '%'
              params: 'last(//snmp.interfaces.in[{#SNMPINDEX}])/last(//snmp.interfaces.speed[{#SNMPINDEX}])'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - ''
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: MULTIPLIER
                  parameters:
                    - '100'
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Usage
            - uuid: d41db500945643b6afc4b82015f5f5e6
              name: 'Interface ({#NAME}: {#ALIAS}) In Rate'
              type: DEPENDENT
              key: 'snmp.interfaces.in[{#NAME}]'
              delay: '0'
              history: 7d
              units: bps
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.2.1.2.2.1.10.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              master_item:
                key: snmp.interfaces
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Rate
            - uuid: b39447b3446c4432a3c66ef3e46fb5a6
              name: 'Interface ({#NAME}: {#ALIAS}) Operational Status'
              type: DEPENDENT
              key: 'snmp.interfaces.operstatus[{#NAME}]'
              delay: '0'
              history: 7d
              valuemap:
                name: 'Operational Status'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: snmp.interfaces
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Status
              trigger_prototypes:
                - uuid: 5436374b9ed946e79cb2bf75e02f30e4
                  expression: 'changecount(/BA - MIB - Interfaces/snmp.interfaces.operstatus[{#NAME}],{$INTER_FLAP_WARN_TIME},"dec")>={$INTER_FLAP_WARN_COUNT}'
                  name: 'Interface ({#NAME}: {#ALIAS}) Flapped >= {$INTER_FLAP_WARN_COUNT}x Within {$INTER_FLAP_WARN_TIME}'
                  priority: WARNING
                  tags:
                    - tag: Interface
                      value: '{#NAME}'
                    - tag: Type
                      value: Status
                - uuid: 49be460d2f1841e6963d2cfcfd402401
                  expression: 'last(/BA - MIB - Interfaces/snmp.interfaces.operstatus[{#NAME}])<>1'
                  name: 'Interface ({#NAME}: {#ALIAS}) Operational Status != Up'
                  status: DISABLED
                  priority: AVERAGE
                  tags:
                    - tag: Interface
                      value: '{#NAME}'
                    - tag: Type
                      value: Status
            - uuid: 8767d44b389a4d39bfa7cdd9bef3e19d
              name: 'Interface ({#NAME}: {#ALIAS}) Out Errors'
              type: DEPENDENT
              key: 'snmp.interfaces.out.errors[{#NAME}]'
              delay: '0'
              history: 7d
              units: bps
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              master_item:
                key: snmp.interfaces
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Errors
            - uuid: 27685ca79f79438f9dcd391306f44291
              name: 'Interface ({#NAME}: {#ALIAS}) Out Usage'
              type: CALCULATED
              key: 'snmp.interfaces.out.usage[{#NAME}]'
              history: 7d
              value_type: FLOAT
              units: '%'
              params: 'last(//snmp.interfaces.out[{#SNMPINDEX}])/last(//snmp.interfaces.speed[{#SNMPINDEX}])'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - ''
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: MULTIPLIER
                  parameters:
                    - '100'
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Usage
            - uuid: 560a80f3986f4daaa67307817be05cda
              name: 'Interface ({#NAME}: {#ALIAS}) Out Rate'
              type: DEPENDENT
              key: 'snmp.interfaces.out[{#NAME}]'
              delay: '0'
              history: 7d
              units: bps
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.2.1.2.2.1.16.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              master_item:
                key: snmp.interfaces
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Rate
            - uuid: d025c6fb73e04829822ba94aa58f4a45
              name: 'Interface ({#NAME}: {#ALIAS}) Speed'
              type: DEPENDENT
              key: 'snmp.interfaces.speed[{#NAME}]'
              delay: '0'
              history: 7d
              units: bps
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.2.1.2.2.1.5.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: snmp.interfaces
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Speed
          trigger_prototypes:
            - uuid: 62ed56a4a893446fa8515de4852ca5fa
              expression: '(sum(/BA - MIB - Interfaces/snmp.interfaces.in.errors[{#NAME}],{$INTER_ERROR_WARN_TIME})>={$INTER_ERROR_WARN} or sum(/BA - MIB - Interfaces/snmp.interfaces.out.errors[{#NAME}],{$INTER_ERROR_WARN_TIME})>={$INTER_ERROR_WARN}) and last(/BA - MIB - Interfaces/snmp.interfaces.alertonerrors[{#NAME}])=1'
              name: 'Interface ({#NAME}: {#ALIAS}) Errors >= {$INTER_ERROR_WARN} Within {$INTER_ERROR_WARN_TIME} On Uplink'
              priority: WARNING
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Errors
            - uuid: b429247383cd421db1f0e4471e286c98
              expression: 'last(/BA - MIB - Interfaces/snmp.interfaces.in.usage[{#NAME}])>={$INTER_USAGE_WARN} or last(/BA - MIB - Interfaces/snmp.interfaces.out.usage[{#NAME}])>={$INTER_USAGE_WARN}'
              name: 'Interface ({#NAME}: {#ALIAS}) Usage >= {$INTER_USAGE_WARN}%'
              priority: WARNING
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Usage
          graph_prototypes:
            - uuid: 777a7a1a8c8d49aea746670c7dacd759
              name: 'Interface ({#NAME}: {#ALIAS}) Statistics'
              graph_items:
                - color: 1E88E5
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - Interfaces'
                    key: 'snmp.interfaces.in[{#NAME}]'
                - sortorder: '1'
                  color: 2E7D32
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - Interfaces'
                    key: 'snmp.interfaces.out[{#NAME}]'
                - sortorder: '2'
                  color: FF5722
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - Interfaces'
                    key: 'snmp.interfaces.in.errors[{#NAME}]'
                - sortorder: '3'
                  color: FFA726
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - Interfaces'
                    key: 'snmp.interfaces.out.errors[{#NAME}]'
          master_item:
            key: snmp.interfaces
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#NAME}'
                - .1.3.6.1.2.1.31.1.1.1.1
                - '0'
                - '{#ALIAS}'
                - .1.3.6.1.2.1.31.1.1.1.18
                - '0'
                - '{#DESC}'
                - .1.3.6.1.2.1.2.2.1.2
                - '0'
                - '{#OSTATUS}'
                - .1.3.6.1.2.1.2.2.1.8
                - '0'
                - '{#ASTATUS}'
                - .1.3.6.1.2.1.2.2.1.7
                - '0'
            - type: JAVASCRIPT
              parameters:
                - |
                  if (!value.includes('{#NAME}')) {
                      return value.replace(/"{#DESC}"/g, '"{#ALIAS}":"","{#NAME}"');
                  } else {
                      return value;
                  }
          overrides:
            - name: 'No Alias'
              step: '1'
              filter:
                conditions:
                  - macro: '{#ALIAS}'
                    value: ^$
                    formulaid: A
              operations:
                - operationobject: ITEM_PROTOTYPE
                  operator: LIKE
                  value: Alias
                  discover: NO_DISCOVER
      tags:
        - tag: Type
          value: MIB
      dashboards:
        - uuid: 9f66f49a16914a42b4731103a16d816f
          name: Interfaces
          pages:
            - widgets:
                - type: graphprototype
                  width: '24'
                  height: '11'
                  fields:
                    - type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        host: 'BA - MIB - Interfaces'
                        name: 'Interface ({#NAME}: {#ALIAS}) Statistics'
                    - type: INTEGER
                      name: rows
                      value: '2'
      valuemaps:
        - uuid: bada8a429d464bfba60f2ca27c549d6f
          name: 'Alert On Errors'
          mappings:
            - value: '0'
              newvalue: 'False'
            - value: '1'
              newvalue: 'True'
        - uuid: 042dd6004ca744328459b83d571efd02
          name: 'Operational Status'
          mappings:
            - value: '1'
              newvalue: Up
            - value: '2'
              newvalue: Down
            - value: '3'
              newvalue: Testing
    - uuid: c978731e458f4899bad556a58a4f7722
      template: 'BA - MIB - Interfaces - Aruba OS'
      name: 'BA - MIB - Interfaces - Aruba OS (IF & HP-ICF-BRIDGE)'
      groups:
        - name: BA/MIBs
      discovery_rules:
        - uuid: 42af4ec9d263413a81306b4b6c2bfcef
          name: 'Interfaces Loop Protect Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#ENABLED}, .1.3.6.1.4.1.11.2.14.11.5.1.12.1.5.2.1.1.1, {#NAME}, .1.3.6.1.2.1.31.1.1.1.1, {#ALIAS}, .1.3.6.1.2.1.31.1.1.1.18]'
          key: snmp.interfaces.loopprotect.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              - macro: '{#ALIAS}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: A
              - macro: '{#ENABLED}'
                operator: EXISTS
                formulaid: B
              - macro: '{#ENABLED}'
                value: '1'
                formulaid: C
              - macro: '{#NAME}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: D
              - macro: '{#NAME}'
                value: '^(Vl|Bl|Nu).*$'
                operator: NOT_MATCHES_REGEX
                formulaid: E
          lifetime: 1d
          item_prototypes:
            - uuid: 6f074bb7eaf6440b9f60faae0eba55cb
              name: 'Interface ({#NAME}: {#ALIAS}) Loop Detection Count'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.11.2.14.11.5.1.12.1.5.2.1.1.4.{#SNMPINDEX}'
              key: 'snmp.interfaces.aruba.loopdetected.status[{#NAME}]'
              history: 7d
              valuemap:
                name: 'Loop Detected'
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: 'Loop Detection'
                - tag: Type
                  value: Count
              trigger_prototypes:
                - uuid: 3add992e000848a29c0808061e524b72
                  expression: 'changecount(/BA - MIB - Interfaces - Aruba OS/snmp.interfaces.aruba.loopdetected.status[{#NAME}],{$LOOP_PROTECT_TIMER_WARN},"inc")>0'
                  name: 'Interface ({#NAME}: {#ALIAS}) Loop Detected'
                  priority: HIGH
                  description: 'A loop has been detected on this port!'
                  tags:
                    - tag: Interface
                      value: '{#NAME}'
                    - tag: 'Loop Detected'
                    - tag: Type
                      value: Status
      tags:
        - tag: Type
          value: MIB
      valuemaps:
        - uuid: e2de721ce9284480becb8755327cfbe0
          name: 'Loop Detected'
          mappings:
            - value: '1'
              newvalue: 'Yes'
            - value: '2'
              newvalue: 'No'
    - uuid: e610e67b64ae4a89b9838318c002d244
      template: 'BA - MIB - Interfaces LLDP'
      name: 'BA - MIB - Interfaces LLDP (IF & LLDP)'
      groups:
        - name: BA/MIBs
      items:
        - uuid: 6dae965baba64ff5867d18ea435a6b46
          name: 'Interfaces LLDP Discovery'
          type: SNMP_AGENT
          snmp_oid: 'walk[.1.0.8802.1.1.2.1.4.1.1.4,.1.3.6.1.2.1.31.1.1.1.1,.1.3.6.1.2.1.31.1.1.1.18,.1.0.8802.1.1.2.1.4.1.1.10,.1.0.8802.1.1.2.1.4.1.1.9,.1.0.8802.1.1.2.1.4.1.1.7]'
          key: snmp.interfaces.lldp
          delay: 15s
          history: '0'
          trends: '0'
          value_type: TEXT
      discovery_rules:
        - uuid: 792c76d171b54eb2b4308a4f0b4747c7
          name: 'Interfaces LLDP Discovery'
          type: DEPENDENT
          key: snmp.interfaces.lldp.discovery
          delay: '0'
          filter:
            conditions:
              - macro: '{#ALIAS}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: A
              - macro: '{#NAME}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#NAME}'
                value: '^(Vl|Bl|Nu).*$'
                operator: NOT_MATCHES_REGEX
                formulaid: C
          lifetime: 1d
          item_prototypes:
            - uuid: 67a3110993f44f008ba62945fe121530
              name: 'Interface ({#NAME}: {#ALIAS}) LLDP Remote Description'
              type: DEPENDENT
              key: 'snmp.interfaces.lldp.desc[{#NAME}]'
              delay: '0'
              history: 365d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.0.8802.1.1.2.1.4.1.1.10.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: snmp.interfaces.lldp
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: LLDP
                - tag: Type
                  value: Description
            - uuid: ac8d2f33e8444fba9e6275d1a531ebb2
              name: 'Interface ({#NAME}: {#ALIAS}) LLDP Remote Host'
              type: DEPENDENT
              key: 'snmp.interfaces.lldp.host[{#NAME}]'
              delay: '0'
              history: 365d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.0.8802.1.1.2.1.4.1.1.9.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: snmp.interfaces.lldp
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: LLDP
                - tag: Type
                  value: Host
            - uuid: 0559d8d6479a4eac8e12a88170d63e89
              name: 'Interface ({#NAME}: {#ALIAS}) LLDP Remote Port'
              type: DEPENDENT
              key: 'snmp.interfaces.lldp.port[{#NAME}]'
              delay: '0'
              history: 365d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.0.8802.1.1.2.1.4.1.1.7.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: snmp.interfaces.lldp
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: LLDP
                - tag: Type
                  value: 'Remote Port'
          master_item:
            key: snmp.interfaces.lldp
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#LLDP}'
                - .1.0.8802.1.1.2.1.4.1.1.4
                - '0'
                - '{#NAME}'
                - .1.3.6.1.2.1.31.1.1.1.1
                - '0'
                - '{#ALIAS}'
                - .1.3.6.1.2.1.31.1.1.1.18
                - '0'
            - type: JAVASCRIPT
              parameters:
                - |
                  var newData = [];
                  var data = JSON.parse(value);
                  data.forEach(function(item1) {
                      if(item1['{#SNMPINDEX}'].includes('.')) {
                          data.forEach(function(item2) {
                              if(item1['{#SNMPINDEX}'].split('.')[1] == item2['{#SNMPINDEX}']) {
                                  item2['{#SNMPINDEX}'] = item1['{#SNMPINDEX}'];
                                  newData.push(item2);
                              }
                          });
                      }
                  });
                  return JSON.stringify(newData);
      tags:
        - tag: Type
          value: MIB
    - uuid: 6ca02ebb5e5b4ba7a83e37c81d53c44b
      template: 'BA - MIB - Interfaces MAC'
      name: 'BA - MIB - Interfaces MAC (IF & BRIDGE)'
      groups:
        - name: BA/MIBs
      items:
        - uuid: fc899d89f8354984b896bbad38c158ac
          name: 'Interfaces MAC Count Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#PORT}, .1.3.6.1.2.1.17.4.3.1.2, {#NAME}, .1.3.6.1.2.1.31.1.1.1.1, {#ALIAS}, .1.3.6.1.2.1.31.1.1.1.18]'
          key: snmp.interfaces.mac.count.discovery.json
          delay: 15m
          history: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value);
                  var ports = {};
                  var results = [];
                  data.forEach(function(macs) {
                      if (macs['{#PORT}'] == undefined) return;
                      if (ports[macs['{#PORT}']] == undefined) {
                          ports[macs['{#PORT}']] = 1;
                      } else {
                          ports[macs['{#PORT}']] += 1;
                      }
                  });
                  data.forEach(function(interfaces) {
                          if (interfaces['{#NAME}'] == undefined) return;
                          interfaces['{#MACS}'] = ports[interfaces['{#SNMPINDEX}']];
                          if (interfaces['{#MACS}'] == undefined) interfaces['{#MACS}'] = 0;
                          results.push(interfaces);
                      });
                  return JSON.stringify(results);
          tags:
            - tag: 'MAC Count'
            - tag: Type
              value: Discovery
        - uuid: 9ebe2ba0750e44d6aba6d54dba1504b4
          name: 'Interfaces MAC Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#ADDR}, .1.3.6.1.2.1.17.4.3.1.1, {#PORT}, .1.3.6.1.2.1.17.4.3.1.2, {#NAME}, .1.3.6.1.2.1.31.1.1.1.1, {#ALIAS}, .1.3.6.1.2.1.31.1.1.1.18]'
          key: snmp.interfaces.mac.discovery.json
          delay: 15m
          history: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var result = [];
                  var addressReg = /("{#ADDR}":"..)( )(..)( )(..)( )(..)( )(..)( )(..)( )/g;
                  value = value.replace(addressReg, '$1:$3:$5:$7:$9:$11');
                  var jvalue = JSON.parse(value);
                  jvalue.forEach(function(port) {
                      if (port['{#ALIAS}'] == undefined) return;
                      var portResult = [];
                      jvalue.forEach(function(address) {
                          if (portResult.length > {$INTER_UPLINK_LIMIT}) return;
                          if (address['{#ADDR}'] == undefined) return;
                          if (address['{#PORT}'] == port['{#SNMPINDEX}']) {
                              var newAddrParts = [];
                              var addr = address['{#ADDR}'].toLowerCase();
                              var addrParts = addr.split(':');
                              addrParts.forEach(function(v) {
                                  if (v.length == 1) v = '0' + v;
                                  newAddrParts.push(v);
                              });
                              var newAddr = newAddrParts.join(':');
                              var obj = {
                                  '{#SNMPINDEX}': newAddr,
                                  '{#PORT}': port['{#SNMPINDEX}'],
                                  '{#NAME}': port['{#NAME}'],
                                  '{#ALIAS}': port['{#ALIAS}']
                              };
                              portResult.push(obj);
                          }
                      });
                      if (portResult.length > 0 && portResult.length <= {$INTER_UPLINK_LIMIT}) {
                          portResult.forEach(function(item) {
                              result.push(item);
                          });
                      }
                  });
                  return JSON.stringify(result);
          tags:
            - tag: MAC
            - tag: Type
              value: Discovery
      discovery_rules:
        - uuid: b2841a94cb24434798eb25f1bae1be56
          name: 'Interfaces MAC Count Discovery'
          type: DEPENDENT
          key: snmp.interfaces.mac.count.discovery
          delay: '0'
          filter:
            conditions:
              - macro: '{#ALIAS}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: A
              - macro: '{#NAME}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          item_prototypes:
            - uuid: ea1e8ad01fa44b9c9432becb0580604c
              name: 'Interface ({#NAME}: {#ALIAS}) MAC Count'
              type: DEPENDENT
              key: 'snmp.interfaces.mac.count[{#NAME}]'
              delay: '0'
              history: 7d
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - 'return {#MACS};'
              master_item:
                key: snmp.interfaces.mac.count.discovery.json
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Count
            - uuid: 8205834112a849e9aaa49a9f929ecb6d
              name: 'Interface ({#NAME}: {#ALIAS}) Managed LLDP Status'
              type: CALCULATED
              key: 'snmp.interfaces.mac.managed.lldp[{#NAME}]'
              delay: 15m
              history: 7d
              status: DISABLED
              discover: NO_DISCOVER
              params: 'find(//snmp.interfaces.lldp.desc[{#NAME}],#1,"regexp","{$INTER_UPLINK_MANAGED_EXCLUDE_LLDP_DESC}")'
              valuemap:
                name: 'Managed Status'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - ''
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Status
            - uuid: 62187cc596264fe4938e8dd2cdc358ba
              name: 'Interface ({#NAME}: {#ALIAS}) Uplink Status'
              type: DEPENDENT
              key: 'snmp.interfaces.mac.uplinkstatus[{#NAME}]'
              delay: '0'
              history: 7d
              valuemap:
                name: 'Uplink Status'
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      if ({#MACS} >= {$INTER_UPLINK_THRESHOLD}) {
                          return 1;
                      }
                      return 0;
              master_item:
                key: snmp.interfaces.mac.count.discovery.json
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Status
          trigger_prototypes:
            - uuid: 3ba62eed99da49268e57928089ac4d41
              expression: 'last(/BA - MIB - Interfaces MAC/snmp.interfaces.mac.uplinkstatus[{#NAME}])=1 and last(/BA - MIB - Interfaces MAC/snmp.interfaces.mac.managed.lldp[{#NAME}])=0'
              name: 'Interface ({#NAME}: {#ALIAS}) MAC Count >= {$INTER_UPLINK_THRESHOLD} With Un-managed Device'
              status: DISABLED
              discover: NO_DISCOVER
              priority: INFO
              description: 'This interface has an un-managed device connected.'
          master_item:
            key: snmp.interfaces.mac.count.discovery.json
          overrides:
            - name: 'Uplink Exclude Name'
              step: '1'
              filter:
                conditions:
                  - macro: '{#NAME}'
                    value: '{$INTER_UPLINK_MANAGED_EXCLUDE_NAME}'
                    formulaid: A
              operations:
                - operationobject: ITEM_PROTOTYPE
                  operator: LIKE
                  value: Managed
                  discover: NO_DISCOVER
                - operationobject: TRIGGER_PROTOTYPE
                  operator: LIKE
                  value: Un-managed
                  discover: NO_DISCOVER
        - uuid: 5bcb64d2d3f54e908235d4610981cddd
          name: 'Interfaces MAC Discovery'
          type: DEPENDENT
          key: snmp.interfaces.mac.discovery
          delay: '0'
          item_prototypes:
            - uuid: 44672117f4544766855c1c106404e8c7
              name: 'Interface ({#NAME}: {#ALIAS}), MAC: {#SNMPINDEX}'
              type: DEPENDENT
              key: 'snmp.interfaces.mac.status[{#NAME}:{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: 30d
              valuemap:
                name: 'MAC Status'
              preprocessing:
                - type: MATCHES_REGEX
                  parameters:
                    - '{.SNMPINDEX}":"{#SNMPINDEX}","{.PORT}":"{#PORT}"'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: JAVASCRIPT
                  parameters:
                    - |
                      if (value == 0) return value;
                      return 1;
              master_item:
                key: snmp.interfaces.mac.discovery.json
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: MAC
                  value: '{#SNMPINDEX}'
                - tag: Type
                  value: Status
          master_item:
            key: snmp.interfaces.mac.discovery.json
      tags:
        - tag: Type
          value: MIB
      valuemaps:
        - uuid: 4832488ec33a470b8f7ee84221ceb82b
          name: 'MAC Status'
          mappings:
            - value: '0'
              newvalue: Stale
            - value: '1'
              newvalue: Active
        - uuid: 7f55d972ef1043b99c1846822e7ea797
          name: 'Managed Status'
          mappings:
            - value: '0'
              newvalue: Un-managed
            - value: '1'
              newvalue: Managed
        - uuid: f7f237d11e6648cbad93b136ccf62d2a
          name: 'Uplink Status'
          mappings:
            - value: '0'
              newvalue: 'False'
            - value: '1'
              newvalue: 'True'
    - uuid: c96e74b51406426fa9678cb3e36e305f
      template: 'BA - MIB - Interfaces POE'
      name: 'BA - MIB - Interfaces POE (RFC1213 & IF & POWER-ETHERNET)'
      groups:
        - name: BA/MIBs
      discovery_rules:
        - uuid: fc9a676e681547f7976992861096cbee
          name: 'Interfaces POE Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#POEENAB}, .1.3.6.1.2.1.105.1.1.1.3, {#IFINDEX}, .1.3.6.1.2.1.17.1.4.1.2, {#NAME}, .1.3.6.1.2.1.31.1.1.1.1, {#ALIAS}, .1.3.6.1.2.1.31.1.1.1.18, {#ASTATUS}, .1.3.6.1.2.1.2.2.1.7]'
          key: snmp.interfaces.poe.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#ALIAS}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: A
              - macro: '{#ASTATUS}'
                value: '2'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#NAME}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: C
          lifetime: 1d
          item_prototypes:
            - uuid: 608070fdd95b40d5b1d12d99608cfe02
              name: 'Interface ({#NAME}: {#ALIAS}) POE Admin Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.105.1.1.1.3.{#SNMPINDEX}'
              key: 'snmp.interfaces.poe.astatus[{#NAME}]'
              delay: 30m
              history: 7d
              valuemap:
                name: 'POE Admin'
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: POE
                - tag: Type
                  value: Status
            - uuid: 617cdf1c471444099069446bb97565b5
              name: 'Interface ({#NAME}: {#ALIAS}) POE Detection'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.105.1.1.1.6.{#SNMPINDEX}'
              key: 'snmp.interfaces.poe.dstatus[{#NAME}]'
              history: 7d
              valuemap:
                name: 'POE Status'
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: POE
                - tag: Type
                  value: Status
              trigger_prototypes:
                - uuid: c0a0fe136b29476a883a005dddc2a666
                  expression: 'last(/BA - MIB - Interfaces POE/snmp.interfaces.poe.dstatus[{#NAME}])=4 or last(/BA - MIB - Interfaces POE/snmp.interfaces.poe.dstatus[{#NAME}])=6'
                  name: 'Interface ({#NAME}: {#ALIAS}) POE Detection Fault'
                  priority: WARNING
                  tags:
                    - tag: Interface
                      value: '{#NAME}'
                    - tag: POE
                    - tag: Type
                      value: Status
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var newData = [];
                  var data = JSON.parse(value);
                  data.forEach(function(item1) {
                      if(item1['{#SNMPINDEX}'].includes('.')) {
                          data.forEach(function(item2) {
                              if(item1['{#SNMPINDEX}'].split('.')[1] == item2['{#SNMPINDEX}']) {
                                  item2['{#SNMPINDEX}'] = item1['{#SNMPINDEX}'];
                                  newData.push(item2);
                              }
                          });
                      }
                  });
                  return JSON.stringify(newData);
      tags:
        - tag: Type
          value: MIB
      valuemaps:
        - uuid: 850c51d7192742ab927fcdf43d7ae8a4
          name: 'POE Admin'
          mappings:
            - value: '1'
              newvalue: Enabled
            - value: '2'
              newvalue: Disabled
        - uuid: ef4f68d4621c45b29c33579af98ad7d3
          name: 'POE Status'
          mappings:
            - value: '1'
              newvalue: Disabled
            - value: '2'
              newvalue: Searching
            - value: '3'
              newvalue: 'Delivering Power'
            - value: '4'
              newvalue: Fault
            - value: '5'
              newvalue: Test
            - value: '6'
              newvalue: 'Other Fault'
    - uuid: a882acc6990047b492315f6d10e851ee
      template: 'BA - MIB - Interfaces VLAN'
      name: 'BA - MIB - Interfaces VLAN (RFC1213 & IF & Q-BRIDGE)'
      groups:
        - name: BA/MIBs
      discovery_rules:
        - uuid: 9b3f3fcece214eea9a16084fa0039e13
          name: 'Interfaces VLAN Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#VLAN}, .1.3.6.1.2.1.17.7.1.4.5.1.1, {#NAME}, .1.3.6.1.2.1.31.1.1.1.1, {#ALIAS}, .1.3.6.1.2.1.31.1.1.1.18, {#ASTATUS}, .1.3.6.1.2.1.2.2.1.7]'
          key: snmp.interfaces.vlan.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#ALIAS}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: A
              - macro: '{#ASTATUS}'
                value: '2'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#NAME}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: C
              - macro: '{#VLAN}'
                operator: EXISTS
                formulaid: D
          lifetime: 1d
          item_prototypes:
            - uuid: dec676c9f63b4fe4804f11bc396bf9d5
              name: 'Interface ({#NAME}: {#ALIAS}) VLAN PVID'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.17.7.1.4.5.1.1.{#SNMPINDEX}'
              key: 'snmp.interfaces.vlan.pvid[{#NAME}]'
              delay: 1h
              history: 7d
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: PVID
                - tag: VLAN
      tags:
        - tag: Type
          value: MIB
    - uuid: e062d321550c42d9bdce4b4c23a365e3
      template: 'BA - MIB - MAC to IP - IP'
      name: 'BA - MIB - MAC to IP (IP)'
      groups:
        - name: BA/MIBs
      items:
        - uuid: 6f39fc0fe41f4d91ac1f0eb612fc88c4
          name: 'MAC to IP Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#MAC}, .1.3.6.1.2.1.4.35.1.4]'
          key: m2i.discovery.json
          delay: 15m
          history: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value);
                  data.forEach(function(record, r_index) {
                      var snmp_index = record['{#SNMPINDEX}'];
                      var raw_mac = record['{#MAC}'];
                      var index_parts = snmp_index.split('.');
                      raw_mac = raw_mac.substr(0, 17);
                      raw_mac = raw_mac.replace(/ /g, ':');
                      var newAddrParts = [];
                      var addr = raw_mac.toLowerCase();
                      var addrParts = addr.split(':');
                      addrParts.forEach(function(v) {
                          if (v.length == 1) v = '0' + v;
                          newAddrParts.push(v);
                      });
                      var mac = newAddrParts.join(':');
                      var ip = '';
                      if (index_parts[1] == 1) { //IPV4
                          ip = index_parts.slice(3, 7).join('.');
                      }
                      if (index_parts[1] == 2) { //IPV6
                          var ip_part = '';
                          var ip_parts = index_parts.slice(3);
                          var compressed = false;
                          var compressing = false;
                          ip_parts.forEach(function(part, p_index) {
                              var ip_byte = Number.parseInt(part).toString(16);
                              if (ip_byte.length == 1) ip_byte = '0' + ip_byte;
                              ip_part += ip_byte;
                              if (ip_part.length == 4) {
                                  ip_part = ip_part.replace(/^0000|^000|^00|^0/, '');
                                  if (!compressed && ip_part == '') {
                                      compressing = true;
                                  }
                                  if (!compressing && ip_part == '') ip_part = '0';
                                  if (compressed || ip_part !== '') {
                                      if (!compressed && compressing) {
                                          ip += ':';
                                          compressed = true;
                                          compressing = false;
                                      }
                                      if (p_index !== 1) ip_part = ':' + ip_part;
                                      ip += ip_part;
                                  }
                                  ip_part = '';
                              } 
                          });
                      }
                      data[r_index]['{#IP}'] = ip;
                      data[r_index]['{#MAC}'] = mac;
                  });
                  return JSON.stringify(data);
          tags:
            - tag: 'MAC to IP'
            - tag: Type
              value: Discovery
      discovery_rules:
        - uuid: 517f02751b524658a4c505ad3996b7a6
          name: 'MAC to IP Discovery'
          type: DEPENDENT
          key: m2i.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#MAC}'
                value: ^$
                operator: NOT_MATCHES_REGEX
                formulaid: A
              - macro: '{#MAC}'
                value: '^00:00:00:00:00:00$'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#MAC}'
                value: '^ff:ff:ff:ff:ff:ff$'
                operator: NOT_MATCHES_REGEX
                formulaid: C
          item_prototypes:
            - uuid: 8f42984ce1a84b209699e231ba07a9de
              name: 'MAC: {#MAC}, IP: {#IP}'
              type: DEPENDENT
              key: 'm2i.status[{#MAC}:{#IP}]'
              delay: '0'
              history: 7d
              trends: 30d
              valuemap:
                name: 'MAC to IP State'
              preprocessing:
                - type: MATCHES_REGEX
                  parameters:
                    - '{.SNMPINDEX}":"{#SNMPINDEX}","{.MAC}":"{#MAC}"'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: JAVASCRIPT
                  parameters:
                    - |
                      if (value == 0) return value;
                      return 1;
              master_item:
                key: m2i.discovery.json
              tags:
                - tag: IP
                  value: '{#IP}'
                - tag: MAC
                  value: '{#MAC}'
                - tag: 'MAC to IP'
                - tag: Type
                  value: Status
          master_item:
            key: m2i.discovery.json
      tags:
        - tag: Type
          value: MIB
      valuemaps:
        - uuid: 1364b8e394e74294a3c6107eef28d797
          name: 'MAC to IP State'
          mappings:
            - value: '0'
              newvalue: Stale
            - value: '1'
              newvalue: Active
    - uuid: 81e18df8f00146508669b18575a0d3f6
      template: 'BA - MIB - MAC to IP - RFC1213'
      name: 'BA - MIB - MAC to IP (RFC1213)'
      groups:
        - name: BA/MIBs
      items:
        - uuid: 06a95ceb13e54dbfa69a010d0f34ac37
          name: 'MAC to IP Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#MAC}, .1.3.6.1.2.1.4.22.1.2, {#IP}, .1.3.6.1.2.1.4.22.1.3]'
          key: m2i.discovery.json
          delay: 15m
          history: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value);
                  data.forEach(function(v, k) {
                      var newAddrParts = [];
                      var addr = v['{#MAC}'].substring(0, 17).replace(/\s/g, ':').toLowerCase();
                      var addrParts = addr.split(':');
                      addrParts.forEach(function(v) {
                          if (v.length == 1) v = '0' + v;
                          newAddrParts.push(v);
                      });
                      data[k]['{#MAC}'] = newAddrParts.join(':');
                  });
                  return JSON.stringify(data);
          tags:
            - tag: 'MAC to IP'
            - tag: Type
              value: Discovery
      discovery_rules:
        - uuid: e61723274ec84ee2b405252948f3ded2
          name: 'MAC to IP Discovery'
          type: DEPENDENT
          key: m2i.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#MAC}'
                value: ^$
                operator: NOT_MATCHES_REGEX
                formulaid: A
              - macro: '{#MAC}'
                value: '^00:00:00:00:00:00$'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#MAC}'
                value: '^ff:ff:ff:ff:ff:ff$'
                operator: NOT_MATCHES_REGEX
                formulaid: C
          item_prototypes:
            - uuid: e1412500b2fe46dcaf99788b070e295d
              name: 'MAC: {#MAC}, IP: {#IP}'
              type: DEPENDENT
              key: 'm2i.status[{#MAC}:{#IP}]'
              delay: '0'
              history: 7d
              trends: 30d
              valuemap:
                name: 'MAC to IP Status'
              preprocessing:
                - type: MATCHES_REGEX
                  parameters:
                    - '"{.MAC}":"{#MAC}","{.IP}":"{#IP}"'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: JAVASCRIPT
                  parameters:
                    - |
                      if (value == 0) return value;
                      return 1;
              master_item:
                key: m2i.discovery.json
              tags:
                - tag: IP
                  value: '{#IP}'
                - tag: MAC
                  value: '{#MAC}'
                - tag: 'MAC to IP'
                - tag: Type
                  value: Status
          master_item:
            key: m2i.discovery.json
      tags:
        - tag: Type
          value: MIB
      valuemaps:
        - uuid: 2d9af5c47ed84c44aa09dc5133cb1002
          name: 'MAC to IP Status'
          mappings:
            - value: '0'
              newvalue: Stale
            - value: '1'
              newvalue: Active
    - uuid: ad0d2cf3f7e84ff09f74ec148818c46d
      template: 'BA - MIB - MikroTik'
      name: 'BA - MIB - MikroTik (MIKROTIK)'
      groups:
        - name: BA/MIBs
      items:
        - uuid: dcdf53f894a043bf83bef95f341c33c8
          name: 'RouterOS Board Name'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.14988.1.1.7.8.0
          key: ros.boardname
          delay: 12h
          history: 30d
          trends: '0'
          value_type: CHAR
          inventory_link: MODEL
          tags:
            - tag: RouterOS
            - tag: Type
              value: Model
        - uuid: 2422b180ee304cadb7b3848987545857
          name: 'CPU Frequency'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.14988.1.1.3.14.0
          key: ros.cpufreq
          history: 7d
          units: Hz
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1000000'
          tags:
            - tag: CPU
            - tag: Type
              value: Frequency
        - uuid: 7d2ce0e43616493cbf1106fbe2a5063f
          name: 'RouterOS Serial'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.14988.1.1.7.3.0
          key: ros.serial
          delay: 12h
          trends: '0'
          value_type: CHAR
          inventory_link: SERIALNO_A
          tags:
            - tag: RouterOS
            - tag: Type
              value: Serial
        - uuid: d98aae57d9454c6a8836fab035873f83
          name: 'RouterOS Version'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.14988.1.1.4.4.0
          key: ros.version
          delay: 5m
          history: 1d
          trends: '0'
          value_type: CHAR
          inventory_link: SOFTWARE
          tags:
            - tag: RouterOS
            - tag: Type
              value: Version
          triggers:
            - uuid: 23f1bc1096ff49728e3c340164fbe352
              expression: 'find(/BA - MIB - MikroTik/ros.version,#1,"regexp","{$SOFTWARE_VERSION_STRINGS}")=0'
              name: 'RouterOS Version Out of Date'
              priority: WARNING
              tags:
                - tag: RouterOS
                - tag: Type
                  value: Version
      discovery_rules:
        - uuid: a218d20f379642fd83b0472df43663e8
          name: 'ROS Gauge Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#NAME}, .1.3.6.1.4.1.14988.1.1.3.100.1.2, {#UNIT}, .1.3.6.1.4.1.14988.1.1.3.100.1.4]'
          key: ros.gauge.discovery
          delay: 1h
          item_prototypes:
            - uuid: efd1a5d94ceb4b098f839bb24c403889
              name: 'Gauge ({#NAME}) {#UNIT}'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.14988.1.1.3.100.1.3.{#SNMPINDEX}'
              key: 'ros.gauge.value[{#SNMPINDEX}]'
              delay: 5m
              history: 7d
              value_type: FLOAT
              units: '{#UNIT}'
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      if ('{#UNIT}' == 'Volts') return value / 10;
                      return value;
              tags:
                - tag: Gauge
                  value: '{#NAME}'
                - tag: Type
                  value: '{#UNIT}'
              trigger_prototypes:
                - uuid: 8bbeacb4fa7b429aa0cc8c0e917c0991
                  expression: 'last(/BA - MIB - MikroTik/ros.gauge.value[{#SNMPINDEX}])>={$TEMP_C_WARN}'
                  name: 'Gauge ({#NAME}) {#UNIT} Temperature >= {$TEMP_C_WARN}C'
                  priority: AVERAGE
                  tags:
                    - tag: Guage
                      value: '{#NAME}'
                    - tag: Type
                      value: '{#UNIT}'
          graph_prototypes:
            - uuid: b15abde9dac841bca795548194e9345e
              name: 'Gauge ({#NAME}) {#UNIT}'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: EF6C00
                  calc_fnc: ALL
                  item:
                    host: 'BA - MIB - MikroTik'
                    key: 'ros.gauge.value[{#SNMPINDEX}]'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value);
                  data.forEach(function(v, k) {
                      if (data[k]['{#UNIT}'] == 1) { data[k]['{#UNIT}'] = 'Celsius'; }
                      if (data[k]['{#UNIT}'] == 2) { data[k]['{#UNIT}'] = 'RPM'; }
                      if (data[k]['{#UNIT}'] == 3) { data[k]['{#UNIT}'] = 'Volts'; }
                      if (data[k]['{#UNIT}'] == 4) { data[k]['{#UNIT}'] = 'Amps'; }
                      if (data[k]['{#UNIT}'] == 5) { data[k]['{#UNIT}'] = 'Watts'; }
                      if (data[k]['{#UNIT}'] == 6) { data[k]['{#UNIT}'] = 'Status'; }
                  });
                  return JSON.stringify(data);
          overrides:
            - name: CPU
              step: '1'
              operations:
                - operationobject: ITEM_PROTOTYPE
                  operator: LIKE
                  value: cpu
                  tags:
                    - tag: CPU
            - name: 'Not Celsius'
              step: '2'
              filter:
                conditions:
                  - macro: '{#UNIT}'
                    value: Celsius
                    operator: NOT_MATCHES_REGEX
                    formulaid: A
              operations:
                - operationobject: TRIGGER_PROTOTYPE
                  operator: LIKE
                  value: Temperature
                  discover: NO_DISCOVER
      tags:
        - tag: Type
          value: MIB
      dashboards:
        - uuid: 64178c330b0846e59eebe2be6abb18be
          name: RouterOS
          pages:
            - widgets:
                - type: item
                  width: '4'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - MikroTik'
                        key: ros.boardname
                    - type: INTEGER
                      name: show
                      value: '2'
                - type: item
                  'y': '2'
                  width: '4'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - MikroTik'
                        key: ros.version
                    - type: INTEGER
                      name: show
                      value: '2'
                - type: item
                  'y': '4'
                  width: '4'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - MikroTik'
                        key: ros.serial
                    - type: INTEGER
                      name: show
                      value: '2'
                - type: graphprototype
                  'y': '6'
                  width: '24'
                  height: '7'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '3'
                    - type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        host: 'BA - MIB - MikroTik'
                        name: 'Gauge ({#NAME}) {#UNIT}'
                    - type: INTEGER
                      name: rows
                      value: '2'
                - type: graph
                  x: '4'
                  width: '20'
                  height: '6'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'BA - MIB - MikroTik'
                        name: 'CPU Frequency'
    - uuid: 6dd5ae1611594a04a59971e486b8ea98
      template: 'BA - MIB - UPS'
      name: 'BA - MIB - UPS (UPS)'
      groups:
        - name: BA/MIBs
      items:
        - uuid: 71604f16c950452fa9209308ad0ef5c9
          name: 'Battery Charge'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.33.1.2.4.0
          key: snmp.ups.battery.charge
          delay: 5m
          history: 30d
          units: '%'
          tags:
            - tag: Type
              value: Charge
        - uuid: 5ec4f24eb4e340778d4d2d8aa33dda35
          name: 'Battery Runtime'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.33.1.2.3.0
          key: snmp.ups.battery.runtime
          delay: 5m
          history: 30d
          units: s
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '60'
          tags:
            - tag: Type
              value: Runtime
        - uuid: c63347bfd19348328c1fdf8a624bf2bf
          name: 'Battery Status'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.33.1.2.1.0
          key: snmp.ups.battery.status
          delay: 5m
          history: 30d
          valuemap:
            name: 'Battery Status'
          tags:
            - tag: Type
              value: Status
        - uuid: 69e69d3b217c49fcaa798d4c17e0fffa
          name: 'Battery Temperature'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.33.1.2.7.0
          key: snmp.ups.battery.temperature
          delay: 5m
          history: 30d
          units: C
          tags:
            - tag: Type
              value: Temperature
        - uuid: 79c701aeac944703b61efe8365e75c9c
          name: Model
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.33.1.1.2.0
          key: snmp.ups.model
          delay: 6h
          history: 30d
          trends: '0'
          value_type: CHAR
          inventory_link: MODEL
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: Type
              value: Model
        - uuid: b97b642cc9e644f5bf444104d2fa184f
          name: 'UPS Alarms'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.33.1.6.1.0
          key: snmp.ups.ups.alarms
          delay: 5m
          history: 30d
          tags:
            - tag: Type
              value: Alarms
          triggers:
            - uuid: 889f353b257f49d28ec3f6264efce1fe
              expression: 'last(/BA - MIB - UPS/snmp.ups.ups.alarms)>0'
              name: 'UPS Alarms > 0'
              priority: AVERAGE
              description: |
                There is an alarm on this UPS.
                
                The battery may need replaced, or there is another fault.
              tags:
                - tag: Type
                  value: Alarms
        - uuid: 88f48d62d7ae42ff846cf7d3e0e75d4f
          name: 'UPS Input Frequency'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.33.1.3.3.1.2.1
          key: snmp.ups.ups.inputfreq
          delay: 5m
          history: 30d
          units: Hertz
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.1'
          tags:
            - tag: Type
              value: Hertz
        - uuid: 0407dae901c64220a4383c73877e767d
          name: 'UPS Input Voltage'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.33.1.3.3.1.3.1
          key: snmp.ups.ups.inputvoltage
          delay: 5m
          history: 30d
          units: Volts
          tags:
            - tag: Type
              value: Voltage
        - uuid: dc34e74a1ef946cab41ce9b33094cb89
          name: 'UPS Status'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.33.1.4.1.0
          key: snmp.ups.ups.status
          delay: 5m
          history: 30d
          valuemap:
            name: 'UPS Status'
          tags:
            - tag: Type
              value: Status
          triggers:
            - uuid: 9b574a1e3ecf4b39b0705847d47cb8aa
              expression: 'last(/BA - MIB - UPS/snmp.ups.ups.status)<>3'
              name: 'UPS Status not Normal'
              priority: WARNING
              tags:
                - tag: Type
                  value: Status
      tags:
        - tag: Type
          value: MIB
      dashboards:
        - uuid: 090b575c82c24738bb3326672240eae0
          name: UPS
          pages:
            - widgets:
                - type: item
                  width: '8'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - UPS'
                        key: snmp.ups.ups.status
                - type: graph
                  'y': '2'
                  width: '24'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'BA - MIB - UPS'
                        name: 'Battery Charge'
                - type: graph
                  'y': '7'
                  width: '24'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid
                      value:
                        host: 'BA - MIB - UPS'
                        name: 'UPS Input'
                - type: graph
                  'y': '12'
                  width: '24'
                  height: '5'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - UPS'
                        key: snmp.ups.battery.temperature
                    - type: INTEGER
                      name: source_type
                      value: '1'
                - type: item
                  x: '8'
                  width: '8'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - UPS'
                        key: snmp.ups.ups.alarms
                - type: item
                  x: '16'
                  width: '8'
                  fields:
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - MIB - UPS'
                        key: snmp.ups.model
                    - type: INTEGER
                      name: show
                      value: '2'
      valuemaps:
        - uuid: e1ea0ce38dba43fbbd6d91fd183681d3
          name: 'Battery Status'
          mappings:
            - value: '1'
              newvalue: Unkown
            - value: '2'
              newvalue: 'Battery Normal'
            - value: '3'
              newvalue: 'Battery Low'
            - value: '4'
              newvalue: 'Battery Depleated'
        - uuid: c99853b8a39749d7ab16c5d96c924906
          name: 'UPS Status'
          mappings:
            - value: '1'
              newvalue: Other
            - value: '2'
              newvalue: None
            - value: '3'
              newvalue: Normal
            - value: '4'
              newvalue: Bypass
            - value: '5'
              newvalue: Battery
            - value: '6'
              newvalue: Booster
            - value: '7'
              newvalue: Reducer
    - uuid: dbe9320a85944279b7d9a7a9e887c146
      template: 'BA - MIB - vSphere VMs'
      name: 'BA - MIB - vSphere VMs (VMWARE-VMINFO)'
      groups:
        - name: BA/MIBs
      items:
        - uuid: 059f8c28dd144f05b792288a14ee9951
          name: 'CPUs Allocated'
          type: CALCULATED
          key: vsphere.cpus.allocated
          delay: 1h
          history: 7d
          params: 'sum(last_foreach(//vsphere.vm.cpus[*]))'
          tags:
            - tag: CPU
            - tag: Type
              value: Count
        - uuid: befdbfd5a25d4e038bc2f53eedab5c98
          name: 'CPU Subscription'
          type: CALCULATED
          key: vsphere.cpus.subscription
          delay: 1h
          history: 7d
          value_type: FLOAT
          units: '%'
          params: last(//vsphere.cpus.allocated)/last(//cpu.count)
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '100'
          tags:
            - tag: CPU
            - tag: Type
              value: Subscription
          triggers:
            - uuid: f9883375c125492abab9ce4181caf353
              expression: 'last(/BA - MIB - vSphere VMs/vsphere.cpus.subscription)>=300'
              name: 'CPU Subscription >= 300%'
              priority: INFO
              dependencies:
                - name: 'CPU Subscription >= 400%'
                  expression: 'last(/BA - MIB - vSphere VMs/vsphere.cpus.subscription)>=400'
                - name: 'CPU Subscription >= 500%'
                  expression: 'last(/BA - MIB - vSphere VMs/vsphere.cpus.subscription)>=500'
              tags:
                - tag: CPU
                - tag: Type
                  value: Usage
            - uuid: 885272fd23404a5b9fe53aef2b7de707
              expression: 'last(/BA - MIB - vSphere VMs/vsphere.cpus.subscription)>=400'
              name: 'CPU Subscription >= 400%'
              priority: WARNING
              dependencies:
                - name: 'CPU Subscription >= 500%'
                  expression: 'last(/BA - MIB - vSphere VMs/vsphere.cpus.subscription)>=500'
              tags:
                - tag: CPU
                - tag: Type
                  value: Usage
            - uuid: 881639b9a7284eac98a5c31b649b4e6c
              expression: 'last(/BA - MIB - vSphere VMs/vsphere.cpus.subscription)>=500'
              name: 'CPU Subscription >= 500%'
              priority: AVERAGE
              tags:
                - tag: CPU
                - tag: Type
                  value: Usage
        - uuid: 55e4078646824cb18348e0194b551123
          name: 'VM Count'
          type: CALCULATED
          key: vsphere.vm.count
          delay: 1h
          history: 7d
          params: 'sum(exists_foreach(//vsphere.vm.state[*]))'
          tags:
            - tag: Type
              value: Count
            - tag: VM
      discovery_rules:
        - uuid: a6fd7567cc30408d9711e1bab1030c56
          name: 'VM Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#NAME}, .1.3.6.1.4.1.6876.2.1.1.2]'
          key: vsphere.vm.discovery
          delay: 1h
          item_prototypes:
            - uuid: 07a6e276f6cf485b8febeca4d71c9eaa
              name: 'VM ({#NAME}) CPUs'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.6876.2.1.1.9.{#SNMPINDEX}'
              key: 'vsphere.vm.cpus[{#SNMPINDEX}]'
              delay: 1h
              history: 7d
              tags:
                - tag: CPU
                - tag: Type
                  value: Count
                - tag: VM
                  value: '{#NAME}'
            - uuid: 3f58ca558b094184ad0c7022480c2287
              name: 'VM ({#NAME}) Guest OS'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.6876.2.1.1.4.{#SNMPINDEX}'
              key: 'vsphere.vm.guestos[{#SNMPINDEX}]'
              delay: 1h
              history: 365d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                - tag: Type
                  value: 'Guest OS'
                - tag: VM
                  value: '{#NAME}'
            - uuid: bfbddf7840304b6183eda41be9e29098
              name: 'VM ({#NAME}) Guest State'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.6876.2.1.1.8.{#SNMPINDEX}'
              key: 'vsphere.vm.gueststate[{#SNMPINDEX}]'
              delay: 5m
              history: 365d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                - tag: Type
                  value: State
                - tag: VM
                  value: '{#NAME}'
            - uuid: fb84d9e71e484a9f8951ee113847eac0
              name: 'VM ({#NAME}) Memory Size'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.6876.2.1.1.5.{#SNMPINDEX}'
              key: 'vsphere.vm.memsize[{#SNMPINDEX}]'
              delay: 6h
              history: 7d
              units: B
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '1048576'
              tags:
                - tag: Type
                  value: Size
                - tag: VM
                  value: '{#NAME}'
            - uuid: bd3e8bd3fd2e4123a7659b62bc4951ed
              name: 'VM ({#NAME}) Power State'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.6876.2.1.1.6.{#SNMPINDEX}'
              key: 'vsphere.vm.state[{#SNMPINDEX}]'
              delay: 5m
              history: 365d
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                - tag: Type
                  value: State
                - tag: VM
                  value: '{#NAME}'
      tags:
        - tag: Type
          value: MIB
    - uuid: c6bf4572df0a4cc28ced8aed23cec940
      template: 'BA - ONVIF - Avigilon'
      name: 'BA - ONVIF - Avigilon'
      groups:
        - name: BA/ONVIF
      items:
        - uuid: 9c5b4a272bb44a8983ff14bda4c749aa
          name: 'Device Firmware Version'
          type: DEPENDENT
          key: camera.firmware.version
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: OS
          preprocessing:
            - type: REGEX
              parameters:
                - 'onvif://www.onvif.org/avigilon/firmware/version/(.*?)"'
                - \1
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.scopes
          tags:
            - tag: Type
              value: Firmware
        - uuid: 62c9ab8714064b7f91eddae1ca247b10
          name: 'Device Info'
          type: HTTP_AGENT
          key: camera.info
          delay: 1h
          history: 3h
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: XML_TO_JSON
              parameters:
                - ''
          timeout: 30s
          url: '{$ONVIF_SHIM_URL}/{HOST.CONN}'
          query_fields:
            - name: user
              value: '{$AVIG_CAM_USERNAME}'
            - name: pass
              value: '{$AVIG_CAM_PASSWORD}'
          posts: '<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema"><soap:Body><tds:GetDeviceInformation /></soap:Body></soap:Envelope>'
          request_method: POST
          tags:
            - tag: Type
              value: ONVIF
        - uuid: a901ebe015ec41578b6f7265970a7efd
          name: 'Device Media'
          type: HTTP_AGENT
          key: camera.media
          delay: 1h
          history: 3h
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: XML_TO_JSON
              parameters:
                - ''
          timeout: 30s
          url: '{$ONVIF_SHIM_URL}/{HOST.CONN}'
          query_fields:
            - name: user
              value: '{$AVIG_CAM_USERNAME}'
            - name: pass
              value: '{$AVIG_CAM_PASSWORD}'
            - name: path
              value: /onvif/media_service
          posts: '<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:trt="http://www.onvif.org/ver10/media/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema"><soap:Body><trt:GetVideoSources /></soap:Body></soap:Envelope>'
          request_method: POST
          tags:
            - tag: Type
              value: ONVIF
        - uuid: cd309dfaf45646d681098c866f2ac499
          name: 'Device Model'
          type: DEPENDENT
          key: camera.model
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: MODEL
          preprocessing:
            - type: REGEX
              parameters:
                - 'onvif://www.onvif.org/hardware/(.*?)"'
                - \1
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.scopes
          tags:
            - tag: Type
              value: Model
        - uuid: cbb50b55e58e43799b3619025ea4a604
          name: 'Device Name'
          type: DEPENDENT
          key: camera.name
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: NAME
          preprocessing:
            - type: REGEX
              parameters:
                - 'onvif://www.onvif.org/name/(.*?)"'
                - \1
            - type: STR_REPLACE
              parameters:
                - acc/
                - ''
            - type: STR_REPLACE
              parameters:
                - '%20'
                - ' '
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.scopes
          tags:
            - tag: Type
              value: Name
        - uuid: c569bead71ff46c9990ec6ca6ee6238b
          name: 'Device MAC'
          type: DEPENDENT
          key: camera.net.mac
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: MACADDRESS_A
          preprocessing:
            - type: REGEX
              parameters:
                - 'onvif://www.onvif.org/avigilon/mac/(.{17})'
                - \1
            - type: STR_REPLACE
              parameters:
                - '-'
                - ':'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.scopes
          tags:
            - tag: Type
              value: MAC
        - uuid: 87a53d70753c474bbb21303663af837f
          name: 'Device Scopes'
          type: HTTP_AGENT
          key: camera.scopes
          delay: 15m
          history: 1h
          trends: '0'
          value_type: TEXT
          preprocessing:
            - type: XML_TO_JSON
              parameters:
                - ''
          timeout: 30s
          url: '{$ONVIF_SHIM_URL}/{HOST.CONN}'
          query_fields:
            - name: user
              value: '{$AVIG_CAM_USERNAME}'
            - name: pass
              value: '{$AVIG_CAM_PASSWORD}'
          posts: '<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema"><soap:Body><tds:GetScopes /><tds:GetDeviceInformation /></soap:Body></soap:Envelope>'
          request_method: POST
          tags:
            - tag: Type
              value: ONVIF
          triggers:
            - uuid: 894908c06a4f42738dd16f954756d551
              expression: 'nodata(/BA - ONVIF - Avigilon/camera.scopes,60m)=1'
              name: 'Could not retrieve device parameters via ONVIF'
              priority: WARNING
              description: 'Please check the password on the device.'
              dependencies:
                - name: 'Device offline'
                  expression: 'last(/BA - Generic - ICMP/icmpping[{HOST.HOST}])=0'
                - name: 'ICMP Loss >= {$ICMP_HIGH_LOSS_WARN}%'
                  expression: 'avg(/BA - Generic - ICMP/icmppingloss[{HOST.HOST},10,50,1000,500],#3)>={$ICMP_HIGH_LOSS_WARN}'
              tags:
                - tag: Type
                  value: ONVIF
        - uuid: 3eb186a618c14079a2f8d7bc6f5a3f3f
          name: 'Device Sensor'
          type: DEPENDENT
          key: camera.sensor
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: TYPE
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var result = '';
                  var data = JSON.parse(value);
                  var source = data.Envelope.Body.GetVideoSourcesResponse.VideoSources;
                  if (data.Envelope.Body.GetVideoSourcesResponse.VideoSources[0] != undefined) { 
                      source = data.Envelope.Body.GetVideoSourcesResponse.VideoSources[0]; 
                  }
                  result += source.Resolution.Width;
                  result += 'x';
                  result += source.Resolution.Height;
                  return result;
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.media
          tags:
            - tag: Type
              value: Sensor
        - uuid: c469663ea4ea4ad69f8b05bfc4b6e2bb
          name: 'Device Serial'
          type: DEPENDENT
          key: camera.serial
          delay: '0'
          history: 7d
          trends: '0'
          value_type: CHAR
          inventory_link: SERIALNO_A
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.Envelope.Body.GetDeviceInformationResponse.SerialNumber
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          master_item:
            key: camera.info
          tags:
            - tag: Type
              value: Serial
      tags:
        - tag: Type
          value: ONVIF
      dashboards:
        - uuid: 520e80c0f687421cb23e6c0f3df2ed13
          name: Avigilon
          pages:
            - widgets:
                - type: item
                  width: '12'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_size
                      value: '10'
                    - type: STRING
                      name: description
                      value: 'Avigilon Camera'
                    - type: INTEGER
                      name: desc_size
                      value: '30'
                    - type: INTEGER
                      name: desc_v_pos
                      value: '0'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - ONVIF - Avigilon'
                        key: camera.name
                    - type: INTEGER
                      name: show
                      value: '1'
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_size
                      value: '10'
                    - type: INTEGER
                      name: value_size
                      value: '35'
                - type: item
                  'y': '2'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_size
                      value: '10'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - ONVIF - Avigilon'
                        key: camera.net.mac
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_size
                      value: '10'
                    - type: INTEGER
                      name: value_bold
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '30'
                - type: item
                  'y': '4'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_size
                      value: '10'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - ONVIF - Avigilon'
                        key: camera.sensor
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_size
                      value: '10'
                    - type: INTEGER
                      name: value_bold
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '30'
                - type: item
                  x: '4'
                  'y': '2'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_size
                      value: '10'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - ONVIF - Avigilon'
                        key: camera.firmware.version
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_size
                      value: '10'
                    - type: INTEGER
                      name: value_bold
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '30'
                - type: item
                  x: '4'
                  'y': '4'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_size
                      value: '10'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - ONVIF - Avigilon'
                        key: camera.serial
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_size
                      value: '10'
                    - type: INTEGER
                      name: value_bold
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '30'
                - type: item
                  x: '8'
                  'y': '2'
                  width: '4'
                  fields:
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: decimal_size
                      value: '10'
                    - type: ITEM
                      name: itemid
                      value:
                        host: 'BA - ONVIF - Avigilon'
                        key: camera.model
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_size
                      value: '10'
                    - type: INTEGER
                      name: value_bold
                      value: '0'
                    - type: INTEGER
                      name: value_size
                      value: '30'
    - uuid: a63b4d7270ab4e44a4618cc7b23e7049
      template: 'BA - Procedure - Update Name'
      name: 'BA - Procedure - Update Name'
      groups:
        - name: BA/Procedures
      items:
        - uuid: 9bb21d98410441d2b53177ca5f1a34a9
          name: 'Update Visible Name via Inventory'
          type: SCRIPT
          key: update.via.inventory
          delay: 12h
          history: 1d
          trends: '0'
          value_type: TEXT
          params: |
            var params = JSON.parse(value);
            var wr = new HttpRequest();
            wr.addHeader('Content-Type: application/json-rpc');
            var raw_resp = wr.post(params.api, JSON.stringify({
                "jsonrpc": "2.0",
                "method": "host.get",
                "params": {
                    "selectInventory": [ "name" ],
                    "filter": {
                        "host": [ params.host ]
                    }
                },
                "id": 1,
                "auth": params.key
            }));
            var response = JSON.parse(raw_resp);
            var name = response.result[0].inventory.name.split('.')[0].toUpperCase();
            var result = wr.post(params.api, JSON.stringify({
                "jsonrpc": "2.0",
                "method": "host.update",
                "params": {
                    "hostid": response.result[0].hostid,
                    "name": name  + ' (' + params.host + ')'
                },
                "id": 1,
                "auth": params.key
            }));
            return result;
          timeout: 30s
          parameters:
            - name: api
              value: '{$ZABSELFAPI}'
            - name: host
              value: '{HOST.HOST}'
            - name: key
              value: '{$ZABSELFKEY}'
          tags:
            - tag: Type
              value: Procedure
          triggers:
            - uuid: cf94790245f74d69803a9680c0032f02
              expression: 'find(/BA - Procedure - Update Name/update.via.inventory,,"regexp","^.*Host with the same visible name.*$")=1'
              name: 'Device name not unique'
              priority: INFO
              description: |
                This device name matches another device with a different IP.
                
                Please ensure that the device names are unique.
              tags:
                - tag: Type
                  value: Procedure
      tags:
        - tag: Type
          value: Procedure
    - uuid: 46224c7ee9ab40cf8fc1807cc2965f2d
      template: 'BA - Profile - APC'
      name: 'BA - Profile - APC'
      templates:
        - name: 'BA - Generic - ICMP'
        - name: 'BA - Macro - Generic'
        - name: 'BA - MIB - APC'
        - name: 'BA - MIB - Generic'
        - name: 'BA - Procedure - Update Name'
      groups:
        - name: BA/Profiles
      tags:
        - tag: Type
          value: Profile
        - tag: Vendor
          value: APC
    - uuid: 901df0e8cba24e74890e3e629e965b9a
      template: 'BA - Profile - Aruba CX Switch'
      name: 'BA - Profile - Aruba CX Switch'
      templates:
        - name: 'BA - Generic - ICMP'
        - name: 'BA - Macro - Generic'
        - name: 'BA - Macro - Interfaces'
        - name: 'BA - MIB - Entity'
        - name: 'BA - MIB - Generic'
        - name: 'BA - MIB - Host Resources'
        - name: 'BA - MIB - Interfaces'
        - name: 'BA - MIB - Interfaces LLDP'
        - name: 'BA - MIB - Interfaces MAC'
        - name: 'BA - MIB - Interfaces POE'
        - name: 'BA - MIB - MAC to IP - IP'
        - name: 'BA - Procedure - Update Name'
        - name: 'BA - SSH - Aruba Config'
      groups:
        - name: BA/Profiles/Networking
      tags:
        - tag: Type
          value: Network
        - tag: Type
          value: Profile
        - tag: Vendor
          value: Aruba
    - uuid: f0572d351d6547c7a33ae487fab360e7
      template: 'BA - Profile - Aruba Switch'
      name: 'BA - Profile - Aruba Switch'
      templates:
        - name: 'BA - Generic - ICMP'
        - name: 'BA - Macro - Generic'
        - name: 'BA - Macro - Interfaces'
        - name: 'BA - MIB - Aruba OS'
        - name: 'BA - MIB - Entity'
        - name: 'BA - MIB - Generic'
        - name: 'BA - MIB - Interfaces'
        - name: 'BA - MIB - Interfaces - Aruba OS'
        - name: 'BA - MIB - Interfaces LLDP'
        - name: 'BA - MIB - Interfaces MAC'
        - name: 'BA - MIB - Interfaces POE'
        - name: 'BA - MIB - Interfaces VLAN'
        - name: 'BA - MIB - MAC to IP - IP'
        - name: 'BA - Procedure - Update Name'
        - name: 'BA - SSH - Aruba Config'
      groups:
        - name: BA/Profiles/Networking
      tags:
        - tag: Type
          value: Network
        - tag: Type
          value: Profile
        - tag: Vendor
          value: Aruba
    - uuid: 32d4adb424bf414683487c8d6414bc72
      template: 'BA - Profile - Avigilon'
      name: 'BA - Profile - Avigilon'
      templates:
        - name: 'BA - Generic - ICMP'
        - name: 'BA - Macro - Generic'
        - name: 'BA - ONVIF - Avigilon'
        - name: 'BA - Procedure - Update Name'
      groups:
        - name: BA/Profiles/Cameras
      tags:
        - tag: Type
          value: Profile
        - tag: Type
          value: Surveillance
        - tag: Vendor
          value: Avigilon
    - uuid: dd62fc36b98043b98668524c168b3787
      template: 'BA - Profile - Axis'
      name: 'BA - Profile - Axis'
      templates:
        - name: 'BA - Generic - ICMP'
        - name: 'BA - HTTP - Axis'
        - name: 'BA - Macro - Generic'
        - name: 'BA - Procedure - Update Name'
      groups:
        - name: BA/Profiles/Cameras
      tags:
        - tag: Type
          value: Profile
        - tag: Type
          value: Surveillance
        - tag: Vendor
          value: Axis
    - uuid: c14d11008b524874a40ab65d935d01cf
      template: 'BA - Profile - Cisco IOS Switch'
      name: 'BA - Profile - Cisco IOS Switch'
      templates:
        - name: 'BA - Generic - ICMP'
        - name: 'BA - Macro - Generic'
        - name: 'BA - Macro - Interfaces'
        - name: 'BA - MIB - Entity'
        - name: 'BA - MIB - Generic'
        - name: 'BA - MIB - Interfaces'
        - name: 'BA - MIB - MAC to IP - RFC1213'
        - name: 'BA - Procedure - Update Name'
      groups:
        - name: BA/Profiles/Networking
      tags:
        - tag: Type
          value: Network
        - tag: Type
          value: Profile
        - tag: Vendor
          value: Cisco
    - uuid: edfde163545d4f058f26a5ace12614f0
      template: 'BA - Profile - Cisco Small Business Switch'
      name: 'BA - Profile - Cisco Small Business Switch'
      templates:
        - name: 'BA - Generic - ICMP'
        - name: 'BA - Macro - Generic'
        - name: 'BA - Macro - Interfaces'
        - name: 'BA - MIB - Entity'
        - name: 'BA - MIB - Generic'
        - name: 'BA - MIB - Interfaces'
        - name: 'BA - MIB - Interfaces LLDP'
        - name: 'BA - MIB - Interfaces MAC'
        - name: 'BA - MIB - Interfaces POE'
        - name: 'BA - MIB - Interfaces VLAN'
        - name: 'BA - MIB - MAC to IP - IP'
        - name: 'BA - Procedure - Update Name'
      groups:
        - name: BA/Profiles/Networking
      tags:
        - tag: Type
          value: Network
        - tag: Type
          value: Profile
        - tag: Vendor
          value: Cisco
    - uuid: c9872f3dbacb455482641a09da61e4c3
      template: 'BA - Profile - Cyber Power'
      name: 'BA - Profile - Cyber Power'
      templates:
        - name: 'BA - Generic - ICMP'
        - name: 'BA - Macro - Generic'
        - name: 'BA - MIB - Cyber Power'
        - name: 'BA - MIB - Generic'
        - name: 'BA - Procedure - Update Name'
      groups:
        - name: BA/Profiles
      tags:
        - tag: Type
          value: Power
        - tag: Type
          value: Profile
        - tag: Vendor
          value: 'Cyber Power'
    - uuid: cba898d4d6af47ccbf5bd0c8c5340c96
      template: 'BA - Profile - iDRAC'
      name: 'BA - Profile - iDRAC'
      templates:
        - name: 'BA - Generic - ICMP'
        - name: 'BA - Macro - Generic'
        - name: 'BA - MIB - Generic'
        - name: 'BA - MIB - iDRAC'
        - name: 'BA - Procedure - Update Name'
      groups:
        - name: BA/Profiles/Servers
      tags:
        - tag: Type
          value: Profile
        - tag: Type
          value: Servers
        - tag: Vendor
          value: iDRAC
    - uuid: 6e39e8aa1a0848f3b2454a082094ecde
      template: 'BA - Profile - iLO'
      name: 'BA - Profile - iLO'
      templates:
        - name: 'BA - Generic - ICMP'
        - name: 'BA - Macro - Generic'
        - name: 'BA - MIB - Generic'
        - name: 'BA - MIB - iLO'
        - name: 'BA - Procedure - Update Name'
      groups:
        - name: BA/Profiles/Servers
      discovery_rules:
        - uuid: a0ac4f59e6544118bd355f3c61bc18c2
          name: 'Interfaces Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#NAME}, .1.3.6.1.2.1.31.1.1.1.1, {#ALIAS}, .1.3.6.1.2.1.31.1.1.1.18, {#OSTATUS}, .1.3.6.1.2.1.2.2.1.8, {#ASTATUS}, .1.3.6.1.2.1.2.2.1.7]'
          key: snmp.interfaces.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#ALIAS}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: A
              - macro: '{#ASTATUS}'
                value: '2'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#NAME}'
                value: '.*{$INTER_FILTER_REGEX}.*'
                operator: NOT_MATCHES_REGEX
                formulaid: C
              - macro: '{#OSTATUS}'
                value: '6'
                operator: NOT_MATCHES_REGEX
                formulaid: D
          lifetime: 1d
          item_prototypes:
            - uuid: ef92486394574885983d2c02b1f3d264
              name: 'Interface ({#NAME}: {#ALIAS}) Alias'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.31.1.1.1.18.{#SNMPINDEX}'
              key: 'snmp.interfaces.alias[{#NAME}]'
              delay: 1h
              trends: '0'
              value_type: CHAR
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 24h
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Alias
            - uuid: 94c1d5de306a47c4963e149a3afb8504
              name: 'Interface ({#NAME}: {#ALIAS}) In Errors'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}'
              key: 'snmp.interfaces.in.errors[{#NAME}]'
              delay: 5m
              history: 7d
              units: bps
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Errors
            - uuid: 5e9b33dcc76645e19d581a89fb396ee9
              name: 'Interface ({#NAME}: {#ALIAS}) In Usage'
              type: CALCULATED
              key: 'snmp.interfaces.in.usage[{#NAME}]'
              history: 7d
              value_type: FLOAT
              units: '%'
              params: 'last(//snmp.interfaces.in[{#SNMPINDEX}])/last(//snmp.interfaces.speed[{#SNMPINDEX}])'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - ''
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: MULTIPLIER
                  parameters:
                    - '100'
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Usage
            - uuid: 767871d53c9a4cbbb0900393193c979a
              name: 'Interface ({#NAME}: {#ALIAS}) In Rate'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.2.2.1.10.{#SNMPINDEX}'
              key: 'snmp.interfaces.in[{#NAME}]'
              history: 7d
              units: bps
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Rate
            - uuid: 210a3f40ad024e85964468495d7f151d
              name: 'Interface ({#NAME}: {#ALIAS}) Operational Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}'
              key: 'snmp.interfaces.operstatus[{#NAME}]'
              delay: 2m
              history: 7d
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Status
              trigger_prototypes:
                - uuid: 673bf191003144baa7b159524e4b4b2f
                  expression: 'changecount(/BA - Profile - iLO/snmp.interfaces.operstatus[{#NAME}],{$INTER_FLAP_WARN_TIME},"dec")>={$INTER_FLAP_WARN_COUNT}'
                  name: 'Interface ({#NAME}: {#ALIAS}) Flapped >= {$INTER_FLAP_WARN_COUNT}x Within {$INTER_FLAP_WARN_TIME}'
                  priority: WARNING
                  tags:
                    - tag: Interface
                      value: '{#NAME}'
                    - tag: Type
                      value: Status
            - uuid: d819c44d41fc4a6bbc5fbe319a7587d1
              name: 'Interface ({#NAME}: {#ALIAS}) Out Errors'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}'
              key: 'snmp.interfaces.out.errors[{#NAME}]'
              delay: 5m
              history: 7d
              units: bps
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Errors
            - uuid: fd552c5cbaa34e37b1264fad7fefa1e5
              name: 'Interface ({#NAME}: {#ALIAS}) Out Usage'
              type: CALCULATED
              key: 'snmp.interfaces.out.usage[{#NAME}]'
              history: 7d
              value_type: FLOAT
              units: '%'
              params: 'last(//snmp.interfaces.out[{#SNMPINDEX}])/last(//snmp.interfaces.speed[{#SNMPINDEX}])'
              preprocessing:
                - type: CHECK_NOT_SUPPORTED
                  parameters:
                    - ''
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: MULTIPLIER
                  parameters:
                    - '100'
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Usage
            - uuid: d75af8046ed14fb0a8f8a2da62ef7494
              name: 'Interface ({#NAME}: {#ALIAS}) Out Rate'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.2.2.1.16.{#SNMPINDEX}'
              key: 'snmp.interfaces.out[{#NAME}]'
              history: 7d
              units: bps
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Rate
            - uuid: eb017fd94d134c4fa097ad10d59eaa35
              name: 'Interface ({#NAME}: {#ALIAS}) Speed'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.2.1.31.1.1.1.15.{#SNMPINDEX}'
              key: 'snmp.interfaces.speed[{#NAME}]'
              delay: 1h
              history: 7d
              units: bps
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '1000000'
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Speed
          trigger_prototypes:
            - uuid: 182e84fa895940ac91884d0df513d3c0
              expression: 'sum(/BA - Profile - iLO/snmp.interfaces.in.errors[{#NAME}],{$INTER_ERROR_WARN_TIME})>={$INTER_ERROR_WARN} or sum(/BA - Profile - iLO/snmp.interfaces.out.errors[{#NAME}],{$INTER_ERROR_WARN_TIME})>={$INTER_ERROR_WARN}'
              name: 'Interface ({#NAME}: {#ALIAS}) Errors >= {$INTER_ERROR_WARN} Within {$INTER_ERROR_WARN_TIME}'
              priority: WARNING
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Errors
            - uuid: 5d4224b75fcc401c8ba547399806ab0c
              expression: 'last(/BA - Profile - iLO/snmp.interfaces.in.usage[{#NAME}])>={$INTER_USAGE_WARN} or last(/BA - Profile - iLO/snmp.interfaces.out.usage[{#NAME}])>={$INTER_USAGE_WARN}'
              name: 'Interface ({#NAME}: {#ALIAS}) Usage >= {$INTER_USAGE_WARN}%'
              priority: WARNING
              tags:
                - tag: Interface
                  value: '{#NAME}'
                - tag: Type
                  value: Usage
          graph_prototypes:
            - uuid: 0be5ec8ae812460ead772320312a3630
              name: 'Interface ({#NAME}: {#ALIAS}) Statistics'
              graph_items:
                - color: 1E88E5
                  calc_fnc: ALL
                  item:
                    host: 'BA - Profile - iLO'
                    key: 'snmp.interfaces.in[{#NAME}]'
                - sortorder: '1'
                  color: 2E7D32
                  calc_fnc: ALL
                  item:
                    host: 'BA - Profile - iLO'
                    key: 'snmp.interfaces.out[{#NAME}]'
                - sortorder: '2'
                  color: FF5722
                  calc_fnc: ALL
                  item:
                    host: 'BA - Profile - iLO'
                    key: 'snmp.interfaces.in.errors[{#NAME}]'
                - sortorder: '3'
                  color: FFA726
                  calc_fnc: ALL
                  item:
                    host: 'BA - Profile - iLO'
                    key: 'snmp.interfaces.out.errors[{#NAME}]'
      tags:
        - tag: Type
          value: Profile
        - tag: Type
          value: Servers
        - tag: Vendor
          value: iLO
    - uuid: cfc4c512c2c4421599b4703ddae48352
      template: 'BA - Profile - Linux'
      name: 'BA - Profile - Linux'
      templates:
        - name: 'BA - Generic - ICMP'
        - name: 'BA - Macro - Generic'
        - name: 'BA - Macro - Interfaces'
        - name: 'BA - MIB - Generic'
        - name: 'BA - MIB - Host Resources'
        - name: 'BA - MIB - Interfaces'
        - name: 'BA - Procedure - Update Name'
      groups:
        - name: BA/Profiles/Servers
      tags:
        - tag: Type
          value: Profile
        - tag: Type
          value: Servers
        - tag: Vendor
          value: Linux
    - uuid: 2d6c963fca534c2eb56112e107ab2e9c
      template: 'BA - Profile - MikroTik'
      name: 'BA - Profile - MikroTik'
      templates:
        - name: 'BA - Generic - ICMP'
        - name: 'BA - Macro - Generic'
        - name: 'BA - Macro - Interfaces'
        - name: 'BA - MIB - Entity'
        - name: 'BA - MIB - Generic'
        - name: 'BA - MIB - Host Resources'
        - name: 'BA - MIB - Interfaces'
        - name: 'BA - MIB - Interfaces LLDP'
        - name: 'BA - MIB - Interfaces MAC'
        - name: 'BA - MIB - MAC to IP - RFC1213'
        - name: 'BA - MIB - MikroTik'
        - name: 'BA - Procedure - Update Name'
        - name: 'BA - SSH - MikroTik Config'
      groups:
        - name: BA/Profiles/Networking
      tags:
        - tag: Type
          value: Network
        - tag: Type
          value: Profile
        - tag: Vendor
          value: MikroTik
    - uuid: c3286d6562bd4c1bad679f800b371f9f
      template: 'BA - Profile - pfSense'
      name: 'BA - Profile - pfSense'
      templates:
        - name: 'BA - Generic - ICMP'
        - name: 'BA - Macro - Generic'
        - name: 'BA - Macro - Interfaces'
        - name: 'BA - MIB - Generic'
        - name: 'BA - MIB - Interfaces'
        - name: 'BA - MIB - MAC to IP - RFC1213'
        - name: 'BA - Procedure - Update Name'
      groups:
        - name: BA/Profiles/Networking
      tags:
        - tag: Type
          value: Network
        - tag: Type
          value: Profile
        - tag: Vendor
          value: pfSense
    - uuid: 59825d81f28447858af5e9f1425cb800
      template: 'BA - Profile - Ruckus'
      name: 'BA - Profile - Ruckus'
      templates:
        - name: 'BA - Generic - ICMP'
        - name: 'BA - Macro - Generic'
        - name: 'BA - Macro - Interfaces'
        - name: 'BA - MIB - Generic'
        - name: 'BA - MIB - Interfaces'
        - name: 'BA - Procedure - Update Name'
      groups:
        - name: BA/Profiles
      tags:
        - tag: Type
          value: Network
        - tag: Type
          value: Profile
        - tag: Vendor
          value: Ruckus
    - uuid: 0a6869fb9afd498ca33833502d4929d2
      template: 'BA - Profile - Ubiquiti'
      name: 'BA - Profile - Ubiquiti'
      templates:
        - name: 'BA - Generic - ICMP'
        - name: 'BA - Macro - Generic'
        - name: 'BA - Macro - Interfaces'
        - name: 'BA - MIB - Generic'
        - name: 'BA - MIB - Interfaces'
        - name: 'BA - Procedure - Update Name'
      groups:
        - name: BA/Profiles/Servers
      tags:
        - tag: Type
          value: Network
        - tag: Type
          value: Profile
        - tag: Vendor
          value: Ubiquiti
    - uuid: a84485143ea944d39947bc6beb5c8dee
      template: 'BA - Profile - UPS'
      name: 'BA - Profile - UPS'
      templates:
        - name: 'BA - Generic - ICMP'
        - name: 'BA - Macro - Generic'
        - name: 'BA - MIB - Generic'
        - name: 'BA - MIB - UPS'
        - name: 'BA - Procedure - Update Name'
      groups:
        - name: BA/Profiles
      tags:
        - tag: Type
          value: Power
        - tag: Type
          value: Profile
        - tag: Vendor
          value: Generic
    - uuid: 00258b13162c4a3d9283a479b1a10f80
      template: 'BA - Profile - vSphere'
      name: 'BA - Profile - vSphere'
      templates:
        - name: 'BA - Generic - ICMP'
        - name: 'BA - Macro - Generic'
        - name: 'BA - Macro - Interfaces'
        - name: 'BA - MIB - Entity'
        - name: 'BA - MIB - Generic'
        - name: 'BA - MIB - Host Resources'
        - name: 'BA - MIB - Interfaces'
        - name: 'BA - MIB - vSphere VMs'
        - name: 'BA - Procedure - Update Name'
      groups:
        - name: BA/Profiles/Servers
      tags:
        - tag: Type
          value: Profile
        - tag: Type
          value: Servers
        - tag: Vendor
          value: VMWare
    - uuid: 22526bb9690840debbaa02fd6f35d5b0
      template: 'BA - Profile - Windows'
      name: 'BA - Profile - Windows'
      templates:
        - name: 'BA - Generic - ICMP'
        - name: 'BA - Macro - Generic'
        - name: 'BA - Macro - Interfaces'
        - name: 'BA - MIB - Generic'
        - name: 'BA - MIB - Host Resources'
        - name: 'BA - MIB - Interfaces'
        - name: 'BA - MIB - MAC to IP - RFC1213'
        - name: 'BA - Procedure - Update Name'
      groups:
        - name: BA/Profiles/Servers
      tags:
        - tag: Type
          value: Profile
        - tag: Type
          value: Servers
        - tag: Vendor
          value: Windows
    - uuid: ed7b2d0bb3bc487f85dd64fe636c783e
      template: 'BA - SSH - Aruba Config'
      name: 'BA - SSH - Aruba Config'
      groups:
        - name: BA/SSH
      items:
        - uuid: 4cdfa361733045b8820676671cb01643
          name: 'Aruba Config'
          type: HTTP_AGENT
          key: ssh.config
          delay: 6h
          trends: '0'
          value_type: TEXT
          inventory_link: SOFTWARE_FULL
          preprocessing:
            - type: REGEX
              parameters:
                - '[\s\S]*(Running|Current) configuration:\R{1,2}([\s\S]*)\R{1,2}'
                - \2
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          timeout: 60s
          url: '{$SSH_SHIM_URL}'
          posts: |
            hostname={HOST.HOST}&username={$ARUBA_SSH_USER}&password={$ARUBA_SSH_PASS}&commands=
            {"Expect":"#"}
            no page
            show run
            @@@
            {"Expect":"# @@@"}
          request_method: POST
          tags:
            - tag: Config
          triggers:
            - uuid: 2fe56d78b3254bbb9535028f50f83ca9
              expression: 'nodata(/BA - SSH - Aruba Config/ssh.config,3d)=1'
              name: 'Could not retrieve configuration via SSH'
              priority: WARNING
              description: 'Check that the SSH user can login to back the configuration up.'
              dependencies:
                - name: 'Device offline'
                  expression: 'last(/BA - Generic - ICMP/icmpping[{HOST.HOST}])=0'
              tags:
                - tag: Config
      tags:
        - tag: Type
          value: SSH
    - uuid: ccb9478d71394cbf9ca818e33e887c22
      template: 'BA - SSH - MikroTik Config'
      name: 'BA - SSH - MikroTik Config'
      groups:
        - name: BA/SSH
      items:
        - uuid: 017e9deb230d40bd81450232f827b526
          name: 'RouterOS Config'
          type: SSH
          key: 'ssh.run[export]'
          delay: 1d
          trends: '0'
          value_type: TEXT
          params: 'export show-sensitive'
          username: '{$ROS_SSH_USER}'
          password: '{$ROS_SSH_PASS}'
          inventory_link: SOFTWARE_FULL
          tags:
            - tag: Config
      tags:
        - tag: Type
          value: SSH
    - uuid: 5363825b8b51440ab13167e282af90de
      template: 'BA - SSH - UPS'
      name: 'BA - SSH - UPS (NUT)'
      groups:
        - name: BA/SSH
      items:
        - uuid: 5dc8fcd056714c81b6f37ada8fd25263
          name: 'UPS Discovery'
          type: SSH
          key: 'ssh.run[upsdiscovery]'
          history: '0'
          trends: '0'
          value_type: TEXT
          params: |
            for ups in $(upsc -l); do
                echo "#$ups";
                upsc $ups;
            done
          username: '{$SSH_USERNAME}'
          password: '{$SSH_PASSWORD}'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var UPSs = value.split('#');
                  var result = [];
                  var mIndex = 0;
                  UPSs.forEach(function(ups) {
                      if (ups == '') { return; }
                      var lines = ups.split('\n');
                      var lIndex = 0;
                      result[mIndex] = {};
                      lines.forEach(function(line) {
                          if (line == '') { return; }
                          if (lIndex++ == 0) { 
                              result[mIndex]['{#NAME}'] = line;
                              result[mIndex]['name'] = line;
                              return;
                          }
                          var kv = line.split(': ');
                          result[mIndex][kv[0]] = kv[1];
                      });
                      mIndex++;
                  });
                  return JSON.stringify(result);
      discovery_rules:
        - uuid: aab88f1eccb54af58b4845c52cf5265e
          name: 'UPS Discovery'
          type: DEPENDENT
          key: ssh.nut.ups.discovery
          delay: '0'
          item_prototypes:
            - uuid: 3141f09d1c8547e485b8f90d9dba0f2a
              name: 'UPS ({#NAME}) Charge'
              type: DEPENDENT
              key: 'ssh.nut.ups.charge[{#NAME}]'
              delay: '0'
              history: 30d
              units: '%'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$..[?(@.name==''{#NAME}'')][''battery.charge''].first()'
              master_item:
                key: 'ssh.run[upsdiscovery]'
              tags:
                - tag: Type
                  value: Charge
                - tag: UPS
                  value: '{#NAME}'
            - uuid: caf05ab2f31346d1aee194218fdc3bef
              name: 'UPS ({#NAME}) Load'
              type: DEPENDENT
              key: 'ssh.nut.ups.load[{#NAME}]'
              delay: '0'
              history: 30d
              units: '%'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$..[?(@.name==''{#NAME}'')][''ups.load''].first()'
              master_item:
                key: 'ssh.run[upsdiscovery]'
              tags:
                - tag: Type
                  value: Load
                - tag: UPS
                  value: '{#NAME}'
            - uuid: ab90c08feeb4464eaf34dc8a21a1def4
              name: 'UPS ({#NAME}) Runtime'
              type: DEPENDENT
              key: 'ssh.nut.ups.runtime[{#NAME}]'
              delay: '0'
              history: 30d
              units: s
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$..[?(@.name==''{#NAME}'')][''battery.runtime''].first()'
              master_item:
                key: 'ssh.run[upsdiscovery]'
              tags:
                - tag: Type
                  value: Runtime
                - tag: UPS
                  value: '{#NAME}'
            - uuid: 1178a6cb711e4f1983c69c82eeb5bacb
              name: 'UPS ({#NAME}) Status'
              type: DEPENDENT
              key: 'ssh.nut.ups.status[{#NAME}]'
              delay: '0'
              history: 30d
              valuemap:
                name: 'UPS Status'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$..[?(@.name==''{#NAME}'')][''ups.status''].first()'
                - type: JAVASCRIPT
                  parameters:
                    - |
                      if (value.includes('OL')) {
                          return 1;
                      } else {
                          return 0;
                      }
              master_item:
                key: 'ssh.run[upsdiscovery]'
              tags:
                - tag: Type
                  value: Status
                - tag: UPS
                  value: '{#NAME}'
              trigger_prototypes:
                - uuid: 61cb309d62f8429f852aff61c7c3fd2f
                  expression: 'last(/BA - SSH - UPS/ssh.nut.ups.status[{#NAME}])=0'
                  name: 'UPS ({#NAME}) Status = Offline'
                  priority: HIGH
                  tags:
                    - tag: Type
                      value: Status
                    - tag: UPS
                      value: '{#NAME}'
            - uuid: 71e2da69276a404c9f3aacd9cac442aa
              name: 'UPS ({#NAME}) Voltage'
              type: DEPENDENT
              key: 'ssh.nut.ups.voltage[{#NAME}]'
              delay: '0'
              history: 30d
              value_type: FLOAT
              units: V
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$..[?(@.name==''{#NAME}'')][''input.voltage''].first()'
              master_item:
                key: 'ssh.run[upsdiscovery]'
              tags:
                - tag: Type
                  value: Voltage
                - tag: UPS
                  value: '{#NAME}'
          master_item:
            key: 'ssh.run[upsdiscovery]'
      valuemaps:
        - uuid: aff82d0edfcb41379ecd4705717395a9
          name: 'UPS Status'
          mappings:
            - value: '0'
              newvalue: Offline
            - value: '1'
              newvalue: Online
  triggers:
    - uuid: 0cb2f24a7f724fad988e17ed41f374ee
      expression: 'last(/BA - MIB - Aruba OS/snmp.aruba.config.sha.startup)<>last(/BA - MIB - Aruba OS/snmp.aruba.config.sha.running)'
      name: 'Configuration not saved'
      priority: WARNING
      description: 'The startup config does not match the running config. Please save the running config to flash.'
      tags:
        - tag: Type
          value: SHA
  graphs:
    - uuid: 13bb88368aab4bd8a4a862360288fc0f
      name: 'Battery Charge'
      graph_items:
        - color: 199C0D
          calc_fnc: ALL
          item:
            host: 'BA - MIB - APC'
            key: snmp.apc.battery.charge
        - sortorder: '1'
          color: F63100
          yaxisside: RIGHT
          calc_fnc: ALL
          item:
            host: 'BA - MIB - APC'
            key: snmp.apc.battery.runtime
    - uuid: ffb6d4eea7c749868407affdda162187
      name: 'Battery Charge'
      graph_items:
        - color: 199C0D
          calc_fnc: ALL
          item:
            host: 'BA - MIB - Cyber Power'
            key: snmp.cps.battery.charge
        - sortorder: '1'
          color: F63100
          yaxisside: RIGHT
          calc_fnc: ALL
          item:
            host: 'BA - MIB - Cyber Power'
            key: snmp.cps.battery.runtime
    - uuid: ab621a713e324752b7a53d0084914239
      name: 'Battery Charge'
      graph_items:
        - color: 199C0D
          calc_fnc: ALL
          item:
            host: 'BA - MIB - UPS'
            key: snmp.ups.battery.charge
        - sortorder: '1'
          color: F63100
          yaxisside: RIGHT
          calc_fnc: ALL
          item:
            host: 'BA - MIB - UPS'
            key: snmp.ups.battery.runtime
    - uuid: 12e77545f5a8427892619e4f55fc37e0
      name: CPU
      graph_items:
        - color: BF00FF
          calc_fnc: ALL
          item:
            host: 'BA - MIB - Host Resources'
            key: cpu.count
        - sortorder: '1'
          drawtype: GRADIENT_LINE
          color: 0288D1
          yaxisside: RIGHT
          calc_fnc: ALL
          item:
            host: 'BA - MIB - Host Resources'
            key: cpu.usage
    - uuid: 621c306af3f44412a3e0a9d1988d6a3c
      name: 'CPU Frequency'
      graph_items:
        - drawtype: GRADIENT_LINE
          color: 1976D2
          calc_fnc: ALL
          item:
            host: 'BA - MIB - MikroTik'
            key: ros.cpufreq
    - uuid: 9cdb0e17c038481daca833f565fc1536
      name: 'CPU Usage'
      graph_items:
        - drawtype: GRADIENT_LINE
          color: 199C0D
          calc_fnc: ALL
          item:
            host: 'BA - MIB - Aruba OS'
            key: cpu.usage
    - uuid: 4c4d6eca42594740977ac9df1727d1bd
      name: 'ICMP Statistics'
      graph_items:
        - color: 1A7C11
          calc_fnc: ALL
          item:
            host: 'BA - Generic - ICMP'
            key: 'icmppingsec[{HOST.HOST}]'
        - sortorder: '1'
          color: F63100
          yaxisside: RIGHT
          calc_fnc: ALL
          item:
            host: 'BA - Generic - ICMP'
            key: 'icmppingloss[{HOST.HOST},10,50,1000,500]'
    - uuid: 20263e09ac454893b1c06d8167076df2
      name: 'Memory Usage'
      graph_items:
        - drawtype: GRADIENT_LINE
          color: 00FFFF
          calc_fnc: ALL
          item:
            host: 'BA - MIB - Aruba OS'
            key: memory.usage
        - sortorder: '1'
          color: FF8000
          yaxisside: RIGHT
          calc_fnc: ALL
          item:
            host: 'BA - MIB - Aruba OS'
            key: memory.used
    - uuid: 2fa77c4a8298408babdd9161a6e49609
      name: 'UPS Input'
      graph_items:
        - color: 199C0D
          calc_fnc: ALL
          item:
            host: 'BA - MIB - APC'
            key: snmp.apc.ups.inputfreq
        - sortorder: '1'
          color: F63100
          yaxisside: RIGHT
          calc_fnc: ALL
          item:
            host: 'BA - MIB - APC'
            key: snmp.apc.ups.inputvoltage
    - uuid: ef6e9c90d3c94313ba1856fdfdbf0944
      name: 'UPS Input'
      graph_items:
        - color: 199C0D
          calc_fnc: ALL
          item:
            host: 'BA - MIB - Cyber Power'
            key: snmp.cps.ups.inputfreq
        - sortorder: '1'
          color: F63100
          yaxisside: RIGHT
          calc_fnc: ALL
          item:
            host: 'BA - MIB - Cyber Power'
            key: snmp.cps.ups.inputvoltage
    - uuid: a2d389b4e1844b0aa6ce408286637096
      name: 'UPS Input'
      graph_items:
        - color: 199C0D
          calc_fnc: ALL
          item:
            host: 'BA - MIB - UPS'
            key: snmp.ups.ups.inputfreq
        - sortorder: '1'
          color: F63100
          yaxisside: RIGHT
          calc_fnc: ALL
          item:
            host: 'BA - MIB - UPS'
            key: snmp.ups.ups.inputvoltage
